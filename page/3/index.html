<!DOCTYPE HTML>
<html lang="english">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,AlanDecode,Galileo,blog" />
    <meta name="generator" content="Maverick 1.2.1" />
    <meta name="template" content="Prism" />
    <link rel="alternate" type="application/rss+xml" title="walker's code blog &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="walker's code blog &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-b9d78ff38a.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-182e5a8869.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/ba498fe42f95911578b4ebfec092709c.json"
        }

    </script>
    
<title>walker's code blog</title>
<meta name="author" content="AlanDecode" />
<meta name="description" content="coder, reader" />
<meta property="og:title" content="walker's code blog" />
<meta property="og:description" content="coder, reader" />
<meta property="og:site_name" content="walker's code blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/page/3/" />
<meta property="og:image" content="walker's code blog" />
<meta name="twitter:title" content="walker's code blog" />
<meta name="twitter:description" content="coder, reader" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/android-chrome-512x512.png" />


    
</head>

<body>
    <div class="container prism-container">
        <header class="prism-header" id="prism__header">
            <h1 class="text-uppercase brand"><a class="no-link" href="/" target="_self">walker's code blog</a></h1>
            <p>coder, reader</p>
            <nav class="prism-nav"><ul><li><a class="no-link text-uppercase " href="/" target="_self">Home</a></li><li><a class="no-link text-uppercase " href="/archives/" target="_self">Archives</a></li><li><a class="no-link text-uppercase " href="/about/" target="_self">About</a></li><li><a href="#" target="_self" class="search-form-input no-link text-uppercase">Search</a></li></ul></nav>
        </header>
        <div class="prism-wrapper" id="prism__wrapper">
            
<main>    
    

<section id="prism__post-list" class="prism-section row">
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/cs193p_2021%E7%AC%94%E8%AE%B0%5B4%5D_Color_Image_Gesture/" target="_self">cs193p_2021ç¬”è®°[4]_Color_Image_Gesture</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/cs193p_2021%E7%AC%94%E8%AE%B0%5B4%5D_Color_Image_Gesture/" target="_self">
                <time class="text-uppercase">
                    October 24 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><p><a href="https://www.jianshu.com/p/998b0ef4a2cd">cs193p_2021_ç¬”è®°_1</a>
<a href="https://www.jianshu.com/p/af0ad1bead34">cs193p_2021_ç¬”è®°_2</a>
<a href="https://www.jianshu.com/p/d103f8d12052">cs193p_2021_ç¬”è®°_3_Animation_Transition</a>
cs193p_2021_ç¬”è®°_4_Color_Image_Gesture
<a href="https://www.jianshu.com/p/e3c2ee1628c6">cs193p_2021_ç¬”è®°_5_Property Wrapper</a>
<a href="https://www.jianshu.com/p/a315274a4fd2">cs193p_2021_ç¬”è®°_6_Persistence</a>
<a href="https://www.jianshu.com/p/f4ae879eef9c">cs193p_2021_ç¬”è®°_7_Document Architecture</a>
<a href="https://www.jianshu.com/p/2136bdc2c6f6">cs193p_2021_ç¬”è®°_8</a></p><p>--</p><h1>Color, UIColor &amp; CGColor</h1>
<p>Color:</p><ul>
<li>Is a color-specifier, e.g., <code>.foregroundColor(Color.green)</code>.</li>
<li>Can also act like a <code>ShapeStyle</code>, e.g., <code>.fill(Color.blue)</code>.</li>
<li>Can also act like a <code>View</code>, e.g., Color.white can appear <code>wherever</code> a View can appear.ï¼ˆå¯ä»¥å½“ä½œviewï¼‰</li>
</ul>
<p>UIColor:</p><ul>
<li>Is used to <code>manipulate</code> colors.ï¼ˆä¸»æ‰“æ“æ§ï¼‰</li>
<li>Also has many <code>more</code> built-in <code>colors</code> than <code>Color</code>, including â€œsystem-relatedâ€ colors.(é¢œè‰²æ›´å¤š)</li>
<li>Can be interrogated and can convert between color spaces.</li>
</ul>
<p>For example, you can get the RGBA values from a UIColor.
Once you have desired UIColor, employ <code>Color(uiColor:)</code> to use it in one of the roles above.</p><p>CGColor:</p><ul>
<li>The fundamental color representation in the Core Graphics drawing system</li>
<li><code>color.cgColor</code></li>
</ul>
<h1>Image V.S. UIImage</h1>
<p>Image:</p><ul>
<li>Primarily serves as a View.(ä¸»è¦åŠŸèƒ½æ˜¯View)</li>
<li>Is <code>not</code> a type for vars that <code>hold an image</code> (i.e. a jpeg or gif or some such). Thatâ€™s UIImage.</li>
<li>Access images in your Assets.xcassets (in Xcode) by name using <code>Image(_ name: String)</code>.</li>
<li>Also, many, many system images available via <code>Image(systemName:)</code>.</li>
<li>You can control the size of system images with <code>.imageScale()</code> View modifier.</li>
<li>System images also are affected by the .font modifier.</li>
<li>System images are also very useful <code>as masks</code> (for gradients, for example).</li>
</ul>
<p>UIImage</p><ul>
<li>Is the type for actually <code>creating/manipulating</code> images and <code>storing</code> in vars.</li>
<li>Very powerful representation of an image.</li>
<li>Multiple file formats, transformation primitives, animated images, etc.</li>
<li>Once you have the UIImage you want, use Image(uiImage:) to display it.</li>
</ul>
<h1>Multithreading</h1>
<ul>
<li>å¤šçº¿ç¨‹å…¶å®å¹¶ä¸æ˜¯åŒæ—¶è¿è¡Œï¼Œè€Œæ˜¯å‰åå°éå¸¸å¿«é€Ÿåœ°åˆ‡æ¢</li>
<li><code>Queue</code>åªæ˜¯æœ‰é¡ºåºæ‰§è¡Œçš„ä»£ç ï¼Œå°è£…äº†<code>threading</code>çš„åº”ç”¨</li>
<li>è¿™äº›â€œä»£ç â€ç”¨<code>closure</code>æ¥ä¼ é€’</li>
<li><strong>main queue</strong>å”¯ä¸€èƒ½æ“ä½œUIçš„çº¿ç¨‹<ul>
<li>ä¸»çº¿ç¨‹æ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥ä¸èƒ½æ‰§è¡Œå¼‚æ­¥ä»£ç </li>
</ul>
</li>
<li><strong>background queues</strong>æ‰§è¡Œä»»æ„ï¼š<em>long-lived, non-UI</em> tasks<ul>
<li>å¯ä»¥å¹¶è¡Œè¿è¡Œ(running in parallel) -&gt; even with main UI queue</li>
<li>å¯ä»¥æ‰‹åŠ¨è®¾ç½®ä¼˜å…ˆçº§ï¼ŒæœåŠ¡è´¨é‡(<code>QoS</code>)ç­‰</li>
<li>ä¼˜å…ˆçº§æ°¸è¿œä¸å¯èƒ½è¶…è¿‡main queue</li>
</ul>
</li>
<li>base API: GCD (<code>Grand Central Dispatch</code>)<ol>
<li>getting access to a queue</li>
<li>plopping a block of code on a queue</li>
</ol>
</li>
</ul>
<p>A: Creating a Queue</p><p>There are numerous ways to create a queue, but weâ€™re only going to look at two ...</p><div class="highlight"><pre><span></span><span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span> <span class="c1">// the queue where all UI code must be posted</span>
<span class="n">DispatchQueue</span><span class="p">.</span><span class="n">global</span><span class="p">(</span><span class="n">qos</span><span class="p">:</span> <span class="n">QoS</span><span class="p">)</span> <span class="c1">// a non-UI queue with a certain quality of service qos (quality of service) is one of the following ...</span>
    <span class="p">.</span><span class="n">userInteractive</span>    <span class="c1">// do this fast, the UI depends on it!</span>
    <span class="p">.</span><span class="n">userInitiated</span>  <span class="c1">// the user just asked to do this, so do it now</span>
    <span class="p">.</span><span class="n">utility</span>    <span class="c1">// this needs to happen, but the user didnâ€™t just ask for it</span>
    <span class="p">.</span><span class="n">background</span> <span class="c1">// maintenance tasks (cleanups, etc.)</span>
</pre></div>
<p>B: Plopping a Closure onto a Queue</p><p>There are two basic ways to add a closure to a queue ...</p><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nv">queue</span> <span class="p">=</span> <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span> <span class="c1">//or</span>
<span class="kd">let</span> <span class="nv">queue</span> <span class="p">=</span> <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">global</span><span class="p">(</span><span class="n">qos</span><span class="p">:)</span> 
<span class="n">queue</span><span class="p">.</span><span class="k">async</span> <span class="p">{</span> <span class="cm">/* code to execute on queue */</span> <span class="p">}</span>
<span class="n">queue</span><span class="p">.</span><span class="n">sync</span> <span class="p">{</span> <span class="cm">/* code to execute on queue */</span> <span class="p">}</span>
</pre></div>
<p>ä¸»çº¿ç¨‹é‡Œæ°¸è¿œä¸è¦<code>.sync</code>, é‚£æ ·ä¼šé˜»å¡UI</p><div class="highlight"><pre><span></span><span class="n">DispatchQueue</span><span class="p">(</span><span class="n">global</span><span class="p">:</span> <span class="p">.</span><span class="n">userInitiated</span><span class="p">).</span><span class="k">async</span> <span class="p">{</span>
    <span class="c1">// è€—æ—¶ä»£ç </span>
    <span class="c1">// ä¸é˜»å¡UIï¼Œä¹Ÿä¸èƒ½æ›´æ–°UI</span>
    <span class="c1">// åˆ°ä¸»çº¿ç¨‹å»æ›´æ–°UI</span>
    <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="k">async</span> <span class="p">{</span>
        <span class="c1">// UI code can go here! weâ€™re on the main queue! </span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h1>Gestures</h1>
<p>æ‰‹åŠ¿æ˜¯iOSé‡Œçš„ä¸€ç­‰å…¬æ°‘</p><div class="highlight"><pre><span></span><span class="c1">// recognize</span>
<span class="n">myView</span><span class="p">.</span><span class="n">gesture</span><span class="p">(</span><span class="n">theGesture</span><span class="p">)</span> <span class="c1">// theGesture must implement the Gesture protocol</span>

<span class="c1">// create</span>
<span class="kd">var</span> <span class="nv">theGesture</span><span class="p">:</span> <span class="n">some</span> <span class="n">Gesture</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">TapGesture</span><span class="p">(</span><span class="bp">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1">// double tap</span>
<span class="p">}</span>

<span class="c1">// discrete gestures</span>
<span class="kd">var</span> <span class="nv">theGesture</span><span class="p">:</span> <span class="n">some</span> <span class="n">Gesture</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">TapGesture</span><span class="p">(</span><span class="bp">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">.</span><span class="n">onEnded</span> <span class="p">{</span> <span class="cm">/* do something */</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// å…¶å®å°±æ˜¯ï¼š</span>
<span class="kd">func</span> <span class="nf">theGesture</span><span class="p">()</span> <span class="p">-&gt;</span> <span class="n">some</span> <span class="n">Gesture</span> <span class="p">{</span>
    <span class="n">tapGesture</span><span class="p">(</span><span class="bp">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// â€œconvenience versionsâ€</span>
<span class="n">myView</span><span class="p">.</span><span class="n">onTapGesture</span><span class="p">(</span><span class="bp">count</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* do something */</span> <span class="p">}</span> 
<span class="n">myView</span><span class="p">.</span><span class="n">onLongPressGesture</span><span class="p">(...)</span> <span class="p">{</span> <span class="cm">/* do something */</span> <span class="p">}</span>

<span class="c1">// non-discrete gestures</span>

<span class="kd">var</span> <span class="nv">theGesture</span><span class="p">:</span> <span class="n">some</span> <span class="n">Gesture</span> <span class="p">{</span>
      <span class="n">DragGesture</span><span class="p">(...)</span>
<span class="p">.</span><span class="n">onEnded</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span> <span class="cm">/* do something */</span> <span class="p">}</span>
</pre></div>
<p>non-discreteæ‰‹åŠ¿é‡Œä¼ é€’çš„<code>value</code>æ˜¯ä¸€ä¸ªstate:</p><ul>
<li>For a <code>DragGesture</code>, itâ€™s a struct with things like the <code>start and end location</code> of the fingers.</li>
<li>For a <code>MagnificationGesture</code> itâ€™s the <code>scale</code> of the magnification (how far the fingers spread out).</li>
<li>For a <code>RotationGesture</code> itâ€™s the <code>Angle</code> of the rotation (like the fingers were turning a dial).</li>
<li>è¿˜å¯ä»¥è·Ÿè¸ªä¸€ä¸ªstate: <code>@GestureState var myGestureState: MyGestureStateType = &lt;starting value&gt;</code></li>
</ul>
<p>å”¯ä¸€å¯ä»¥æ›´æ–°è¿™ä¸ª<code>myGestureState</code>çš„æœºä¼šï¼š</p><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">theGesture</span><span class="p">:</span> <span class="n">some</span> <span class="n">Gesture</span> <span class="p">{</span>
     <span class="n">DragGesture</span><span class="p">(...)</span>
        <span class="p">.</span><span class="n">updating</span><span class="p">(</span><span class="err">$</span><span class="n">myGestureState</span><span class="p">)</span> <span class="p">{</span> <span class="n">value</span><span class="p">,</span> <span class="n">myGestureState</span><span class="p">,</span> <span class="n">transaction</span> <span class="k">in</span> 
            <span class="n">myGestureState</span> <span class="p">=</span> <span class="cm">/* usually something related to value */</span>
        <span class="p">}</span>
        <span class="p">.</span><span class="n">onEnded</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span> <span class="cm">/* do something */</span> <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
<p>æ³¨æ„<code>$</code>çš„ç”¨æ³•</p><p>å¦‚æœä¸éœ€è¦å»è®¡ç®—ä¸€ä¸ª<code>gestureState</code>ä¼ å‡ºå»çš„è¯ï¼Œæœ‰ä¸ª<code>updating</code>ç”¨ç®€ç‰ˆï¼š</p><div class="highlight"><pre><span></span><span class="p">.</span><span class="n">onChanged</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span>
<span class="cm">/* do something with value (which is the state of the fingers) */</span>
<span class="p">}</span>
</pre></div>
<p>äº‹å®ä¸Šï¼Œç›®å‰æ¥çœ‹<code>gestureState</code>åªåšäº†ä¸¤ä»¶äº‹ï¼š</p><ol>
<li>æŠŠå®æ—¶æ‰‹åŠ¿å¯¹åº”çš„å€¼ä¿å­˜èµ·æ¥</li>
<li>åœ¨æ‰‹åŠ¿ç»“æŸæ—¶å¤åŸï¼ˆå¯¹äºç¼©æ”¾ï¼Œå˜ä¸º1ï¼Œå¯¹äºç§»åŠ¨ï¼Œå˜ä¸º0ï¼‰</li>
<li>åŒæ—¶ï¼Œå®ƒæ˜¯åªè¯»çš„ï¼Œåªåœ¨<code>.updating</code>æ–¹æ³•é‡Œæœ‰æ›´æ–°çš„æœºä¼š</li>
</ol>
<p>æ‰€ä»¥ï¼Œå¦‚æœä½ çš„UIå’ŒåŠ¨ç”»é€»è¾‘ï¼Œç”¨åˆ°äº†æ‰‹åŠ¿ç»“æŸæ—¶çš„å€¼ï¼ˆå³éœ€è¦å®ƒå¤åŸï¼‰ï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨<code>.onEnded</code>æ–¹æ³•é‡Œæ‰‹åŠ¨æŠŠå®ƒè®¾å›å»ï¼Œç­‰åŒäºä½ ä¹Ÿå®ç°äº†ä½ çš„<code>gestureState</code>ï¼Œå¹¶ä¸”æ²¡æœ‰å®ƒé‚£äº›é™åˆ¶ã€‚</p><h2>Drag and Drop</h2>
<h3>Item Provider</h3>
<ul>
<li>The heart of drag nad drop is the <code>NSItemProvider</code> class.</li>
<li>It facilitates the transfer of data between processes (via drag and drop, for example)</li>
<li>It facilitates the transfer of a number of data types in iOS, for example:<ul>
<li>NSAttributedString and NSString</li>
<li>NSURL</li>
<li>UIImage and UIColor</li>
</ul>
</li>
<li>pre-Swiftï¼Œæ‰€ä»¥éœ€è¦bridgingï¼Œæ¯”å¦‚ï¼š<code>String as NSString</code></li>
</ul>
<p>ç»“åˆå‡ ä¸ªè¦ç‚¹ï¼Œä¸€å¥è¯å°±èƒ½è®©ä½ çš„å…ƒç´ èƒ½è¢«æ‹–åŠ¨(drag)ï¼š</p><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="n">emoji</span><span class="p">).</span><span class="n">onDrag</span><span class="p">{</span> <span class="bp">NSItemProvider</span><span class="p">(</span><span class="n">object</span><span class="p">:</span> <span class="n">emoji</span> <span class="k">as</span> <span class="bp">NSString</span><span class="p">)}</span>
</pre></div>
<p>è€Œæ¥æ”¶(drop)åˆ™è¦å¤æ‚å¾ˆå¤šï¼š</p><div class="highlight"><pre><span></span><span class="n">otherView</span><span class="p">.</span><span class="n">onDrop</span><span class="p">(</span><span class="n">of</span><span class="p">:</span> <span class="p">[.</span><span class="n">plainText</span><span class="p">],</span> <span class="n">isTarget</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span><span class="n">providers</span><span class="p">,</span> <span class="n">location</span> <span class="k">in</span> <span class="k">return</span> <span class="kc">false</span> <span class="p">}</span>
</pre></div>
<ul>
<li>å‚æ¥æ”¶çš„ç±»å‹ç”±<code>of</code>å‚æ•°æŒ‡å®šï¼Œè¿™é‡Œå‡å®šæ˜¯æ–‡æœ¬</li>
<li>æ–¹æ³•é‡Œæœ€ç»ˆè¦è¿”å›ä¸€ä¸ªboolå€¼ï¼Œè¡¨ç¤ºæˆåŠŸæ¥æ”¶ä¸å¦ï¼Œæˆ‘è¿”äº†ä¸ªfalseï¼Œæ„æ€æ˜¯ä½ èƒ½è®©ç‰©ä½“æ‹–åŠ¨ï¼Œä½†æ˜¯ä¸€æ¾å¼€æ‰‹æŒ‡å°±å¤åŸäº†</li>
</ul>
<p>ä»<code>itemprovider</code>é‡ŒåŠ è½½å¯¹è±¡æœ‰æ¨¡æ¿ä»£ç ï¼š</p><div class="highlight"><pre><span></span><span class="kd">extension</span> <span class="nc">Array</span> <span class="k">where</span> <span class="n">Element</span> <span class="p">==</span> <span class="bp">NSItemProvider</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">loadObjects</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="n">ofType</span> <span class="n">theType</span><span class="p">:</span> <span class="n">T</span><span class="p">.</span><span class="kr">Type</span><span class="p">,</span> <span class="n">firstOnly</span><span class="p">:</span> <span class="nb">Bool</span> <span class="p">=</span> <span class="kc">false</span><span class="p">,</span> <span class="n">using</span> <span class="n">load</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Void</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="k">where</span> <span class="n">T</span><span class="p">:</span> <span class="bp">NSItemProviderReading</span> <span class="p">{</span>
    <span class="k">if</span> <span class="kd">let</span> <span class="nv">provider</span> <span class="p">=</span> <span class="bp">first</span><span class="p">(</span><span class="k">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">canLoadObject</span><span class="p">(</span><span class="n">ofClass</span><span class="p">:</span> <span class="n">theType</span><span class="p">)})</span> <span class="p">{</span>
      <span class="n">provider</span><span class="p">.</span><span class="n">loadObject</span><span class="p">(</span><span class="n">ofClass</span><span class="p">:</span> <span class="n">theType</span><span class="p">)</span> <span class="p">{</span> <span class="n">object</span><span class="p">,</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">if</span> <span class="kd">let</span> <span class="nv">value</span> <span class="p">=</span> <span class="n">object</span> <span class="k">as</span><span class="p">?</span> <span class="n">T</span> <span class="p">{</span>
          <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="k">async</span> <span class="p">{</span>
              <span class="n">load</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">false</span>
  <span class="p">}</span>

<span class="c1">// and</span>
<span class="c1">// where T: _ObjectiveCBridgeable, T._ObjectiveCType: NSItemProviderReading</span>
</pre></div>
<ol>
<li>æä¾›äº†ä¸¤æ®µä»£ç ï¼Œå¯ä»¥çœ‹åˆ°å…¶å®å°±æ˜¯å¯¹è¦åŠ è½½çš„å¯¹è±¡çš„çº¦æŸä¸åŒï¼Œæä¾›äº†å¯¹OCçš„å…¼å®¹</li>
<li>æ¨¡æ¿ä»£ç æ¼”ç¤ºäº†</li>
</ol>
<p>ç¨³å¥åœ°ä»æ‹–æ‹½å¯¹è±¡åŠ è½½å†…å®¹ï¼ˆcanload -&gt; load)
3. çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘å…¶å®å°±æ˜¯ä¸ºæ‹–è¿›æ¥çš„è¿™ä¸ªviewé€‰æ‹©ä¸€ä¸ªä½ç½®å­˜æ”¾ï¼ˆæˆ–è¯»å–å®ƒæºå¸¦çš„æ•°æ®ï¼‰
4. <code>T.Type</code>ä¼ çš„æ˜¯ç±»åˆ«çš„<code>.self</code>ï¼Œæ¯”å¦‚<code>String.self</code></p></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/cs193p_2021%E7%AC%94%E8%AE%B0%5B4%5D_Color_Image_Gesture/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/cs193p_2021%E7%AC%94%E8%AE%B0%5B3%5D_Animation_Transition/" target="_self">cs193p_2021ç¬”è®°[3]_Animation_Transition</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/cs193p_2021%E7%AC%94%E8%AE%B0%5B3%5D_Animation_Transition/" target="_self">
                <time class="text-uppercase">
                    October 24 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><p><a href="https://www.jianshu.com/p/998b0ef4a2cd">cs193p_2021_ç¬”è®°_1</a>
<a href="https://www.jianshu.com/p/af0ad1bead34">cs193p_2021_ç¬”è®°_2</a>
cs193p_2021_ç¬”è®°_3_Animation_Transition
<a href="https://www.jianshu.com/p/41e7309c7f55">cs193p_2021_ç¬”è®°_4_Color_Image_Gesture</a>
<a href="https://www.jianshu.com/p/e3c2ee1628c6">cs193p_2021_ç¬”è®°_5_Property Wrapper</a>
<a href="https://www.jianshu.com/p/a315274a4fd2">cs193p_2021_ç¬”è®°_6_Persistence</a>
<a href="https://www.jianshu.com/p/f4ae879eef9c">cs193p_2021_ç¬”è®°_7_Document Architecture</a>
<a href="https://www.jianshu.com/p/2136bdc2c6f6">cs193p_2021_ç¬”è®°_8</a></p><hr />
<h1>Animation</h1>
<ul>
<li>One way to do animation is by animating a Shape.</li>
<li>The other way to do animation is to animate Views via their <code>ViewModifiers</code>.</li>
<li>Only <code>changes</code> can be animated<ul>
<li>ViewModifier arguments (not all, i.e. fonts)</li>
<li>Shapes</li>
<li>the <em>existance</em> of a View in the UI<ul>
<li>æ¯”å¦‚if-elseå’ŒForEach</li>
</ul>
</li>
</ul>
</li>
<li>You can only animate changes to Views in <em>containers that are already on screen</em> (<code>CTAAOS</code>).</li>
</ul>
<p>ä¸¤ä¸ªgolden rule:</p><ol>
<li>è¦æœ‰view modifierçš„å±æ€§å˜åŒ–</li>
<li>è¦åœ¨å±å¹•ä¸Š</li>
</ol>
<p>æ‰ä¼šè§¦å‘åŠ¨ç”»ï¼ˆå…¶å®å°±æ˜¯ä¸Šé¢çš„æœ€åä¸¤æ¡ï¼‰</p><ul>
<li>è¯¾ç¨‹çš„åŠ¨ç”»ä¾‹å­é‡Œï¼Œç”¨äº†if-elseæ¥ç”Ÿæˆviewï¼Œè¿™æ ·å¯¼è‡´äº†æ–°ç”Ÿæˆçš„viewä¸ä¼šè§¦å‘åŠ¨ç”»</li>
<li>æ¯”å¦‚ç‚¹å¼€ä¸¤å¼ ç‰Œï¼Œæ–°ç‚¹å¼€çš„é‚£å¼ ç‰Œç”±äºä¹‹å‰ç‰Œçš„å†…å®¹å¹¶æ²¡æœ‰å‡ºç°åœ¨å±å¹•ä¸Šï¼Œå¯¼è‡´åŠ¨ç”»æ²¡æœ‰è§¦å‘</li>
<li>æ‰€ä»¥æŠŠviewçš„ç»“æ„ç”±if-elseçš„ç”Ÿæˆå’Œé”€æ¯æœºåˆ¶ï¼Œå˜æˆäº†é€æ˜åº¦åˆ‡æ¢æœºåˆ¶<ul>
<li>å³æ­£é¢å’Œåé¢éƒ½åœ¨å±å¹•ä¸Šï¼Œåªä¸è¿‡é€æ˜åº¦ç›¸åï¼Œä»¥åœ¨è§†è§‰ä¸Šè¦ä¹ˆæ˜¯æ­£é¢è¦ä¹ˆæ˜¯åé¢</li>
<li>æœ¬ä»¥ä¸ºé€æ˜åº¦ä¸º0å°±ä¼šé”€æ¯è§†å›¾(UIKitï¼Ÿ)ï¼Œçœ‹æ ·å­å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œå¤§èƒ†ç”¨opacityå°±å¥½äº†</li>
</ul>
</li>
</ul>
<h2>éšå¼è°ƒç”¨</h2>
<div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="err">â€œğŸ‘»</span> <span class="err">â€</span><span class="p">)</span>
    <span class="p">.</span><span class="n">opacity</span><span class="p">(</span><span class="n">scary</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">)</span>                             <span class="c1">// æ™®é€šmodifier, å³å¦‚æœæ²¡æœ‰åŠ¨ç”»ï¼Œä¹Ÿéœ€è¦çš„çŠ¶æ€ï¼ˆå³ä»£ç ä¹Ÿä¸ä¼šåˆ ï¼‰</span>
    <span class="p">.</span><span class="n">rotationEffect</span><span class="p">(</span><span class="n">Angle</span><span class="p">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">upsideDown</span> <span class="p">?</span> <span class="mi">180</span> <span class="p">:</span> <span class="mi">0</span><span class="p">))</span>    <span class="c1">// åŠ¨ç”»modifierï¼Œå³å®šåˆ¶çš„åŠ¨ç”»æ•ˆæœï¼Œä¸éœ€è¦åŠ¨ç”»çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦è¿™ä¸€è¡Œ</span>
    <span class="p">.</span><span class="n">animation</span><span class="p">(</span><span class="n">Animation</span><span class="p">.</span><span class="n">easeInOut</span><span class="p">)</span>                         <span class="c1">// è§¦å‘</span>
</pre></div>
<ul>
<li>ä¸Šè¿°æ‰€æœ‰<code>ViewModifier</code>éƒ½ä¼šè¢«åŠ¨ç”»<ul>
<li><code>scary, upsideDown</code>ç­‰å€¼æ”¹å˜æ—¶ä¹Ÿä¼šè§¦å‘åŠ¨ç”»</li>
</ul>
</li>
<li>éšå¼è°ƒç”¨ä¼šå†’æ³¡ï¼ˆæ‰€ä»¥ä¸è¦å¯¹ä¸€ä¸ªcontainer viewåš<code>.animation</code>ï¼Œè¿˜æœ‰å®šä½çš„é—®é¢˜)</li>
<li>animationçš„å‚æ•°å°±æ˜¯ä¸€ä¸ªstructï¼š duration, delay, repeat, curve...</li>
</ul>
<p>å¯¹äºä¸èƒ½åŠ¨ç”»çš„modifierï¼Œçœ‹ä¸€ä¸‹è¿™ä¸ªå®ä¾‹ï¼ˆä¸Šä¸ºä¿®æ”¹å‰ï¼Œä¸‹ä¸ºä¿®æ”¹åï¼‰
<figure  style="flex: 51.452991452991455" ><img width="1204" height="1170" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/4804373fb223c0a4333d720331093521.png" alt=""/></figure></p><ol>
<li>æŠŠfontè®¾ä¸ºå¸¸é‡ï¼ŒæŠŠç¼©æ”¾å˜æˆä¸€ä¸ªgeometric effect</li>
<li>åŒæ—¶ä¹Ÿè¯´æ˜<code>.animation()</code>ä¸æ­¢ä½œç”¨äºå®ƒå‰é¢çš„</li>
</ol>
<h2>æ˜¾å¼è°ƒç”¨</h2>
<div class="highlight"><pre><span></span><span class="n">withAnimation</span><span class="p">(.</span><span class="n">linear</span><span class="p">(</span><span class="n">duration</span><span class="p">:</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// do something that will cause ViewModifier/Shape arguments to </span>
<span class="n">change</span> <span class="n">somewhere</span> <span class="p">}</span>
</pre></div>
<ul>
<li>It will appear in closures like <code>.onTapGesture</code>.</li>
<li>æ˜¾å¼åŠ¨ç”»ä¸ä¼šè¦†ç›–æ‰éšå¼åŠ¨ç”»</li>
<li>å¾ˆå°‘æœ‰å¤„ç†ç”¨æˆ·æ‰‹åŠ¿è€Œä¸åŒ…<code>.withAnimation</code>çš„</li>
</ul>
<h1>Transition</h1>
<ul>
<li>è½¬åœºï¼Œä¸»è¦ç”¨äºviewçš„å‡ºç°å’Œæ¶ˆå¤±</li>
<li>ä¸€å¯¹<code>ViewModifier</code>ï¼Œä¸€ä¸ª<code>before</code>, ä¸€ä¸ª<code>after</code></li>
</ul>
<div class="highlight"><pre><span></span><span class="n">ZStack</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">isFaceUp</span> <span class="p">{</span>
        <span class="n">RoundedRectangle</span><span class="p">()</span> <span class="c1">// default .transition is .opacity </span>
        <span class="n">Text</span><span class="p">(</span><span class="err">â€œğŸ‘»</span> <span class="err">â€</span><span class="p">).</span><span class="n">transition</span><span class="p">(.</span><span class="n">scale</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">RoundedRectangle</span><span class="p">(</span><span class="n">cornerRadius</span><span class="p">:</span> <span class="mi">10</span><span class="p">).</span><span class="n">transition</span><span class="p">(.</span><span class="n">identity</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>Unlike .animation(), .transition() does not get redistributed to a containerâ€™s content Views. So putting .transition() on the ZStack above only works if the entire ZStack came/went.</p><p>(Group and ForEach do distribute .transition() to their content Views, however.)</p><p>æ„æ€æ˜¯<code>.transition</code>å¹¶ä¸ä¼šå‘ä¸‹ä¼ é€’ï¼Œå¦‚æœå¯¹<code>ZStack</code>åšè½¬åœºï¼Œåªä¼šæŠŠæ•´ä¸ªå®¹å™¨è¿›è¡Œè½¬åœºè€Œä¸æ˜¯é‡Œé¢çš„viewï¼ˆè§å®ä¾‹äºŒï¼‰</p><ul>
<li>è½¬åœºåªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œå¹¶æ²¡æœ‰è§¦å‘åŠ¨ç”»ï¼ˆå…¶å®å°±æ˜¯è®¾ç½®äº†<code>ViewModifier</code>ï¼‰</li>
<li>æ‰€ä»¥è½¬åœºæ²¡æœ‰éšå¼è°ƒç”¨</li>
<li>åªå¯¹CTAAOSæœ‰ç”¨</li>
</ul>
<p><code>.onAppear</code>æˆ–<code>.onDisappear</code>æ—¶ï¼Œcontainerå¿…ç„¶æ˜¯åœ¨å±å¹•ä¸Šçš„ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå†™<code>.transition</code>çš„å¥½åœ°æ–¹ï¼ˆè®°å¾—è¦<code>withAnimation</code>)</p><p>built-in transitions:</p><ul>
<li>AnyTransition.opacity: é€šè¿‡<code>.opacity</code> modifieræ¥å®ç°æ·¡å…¥æ·¡å‡º</li>
<li>AnyTransition.scale: é€šè¿‡<code>.frame</code> modifieræ¥å®ç°ç¼©æ”¾</li>
<li>AnyTransition.offset(CGSize): é€šè¿‡<code>.offset</code>æ¥å®ç°ç§»åŠ¨</li>
<li>AnyTransition.modifier(active:identity:): ä½ æä¾›ä¸¤ä¸ª<code>ViewModifier</code></li>
</ul>
<p>é€šè¿‡<code>AnyTransition.animation</code>(Animation`)æ¥å®šåˆ¶åŠ¨ç”»ç»†èŠ‚ï¼š</p><div class="highlight"><pre><span></span><span class="p">.</span><span class="n">transition</span><span class="p">(.</span><span class="n">opacity</span><span class="p">.</span><span class="n">animation</span><span class="p">(.</span><span class="n">linear</span><span class="p">(</span><span class="n">duration</span><span class="p">:</span> <span class="mi">20</span><span class="p">)))</span>
</pre></div>
<h1>åŠ¨ç”»æœºåˆ¶</h1>
<p>å…¶å®å°±æ˜¯ç»™å‡ºä¸€ç³»åˆ—çš„æ•°æ®ç‚¹ï¼Œç³»ç»Ÿä¼šæ ¹æ®è¿™äº›æ•°æ®ç‚¹æŠŠæ—¶é—´åˆ‡åˆ†ï¼Œä½ ç»™çš„æ•°æ®ç‚¹è¶Šå¤šï¼Œåˆ‡çš„æ—¶é—´å—ä¹Ÿå°±è¶Šå¤šï¼Œè€Œä¸”ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„çº¿æ€§å‡½æ•°æ¥å†³å®šæ˜¯å¹³å‡è¿˜æ˜¯æ€æ ·å»åˆ‡åˆ†è¿™äº›æ—¶é—´å—ï¼š</p><ul>
<li>the animation system divides the animation duration up into little pieces.</li>
<li>The animation system then tells the Shape/ViewModifier the current piece it should show.</li>
<li>And the Shape/ViewModifier makes sure that its code always reflects that.</li>
</ul>
<p>ç³»ç»Ÿé€šçŸ¥å˜é‡å½“å‰çš„å€¼ï¼ŒUIæ ¹æ®è¿™ä¸ªå€¼å®æ—¶ç»˜åˆ¶å½“å‰çš„Viewï¼Œä¸æ–­é”€æ¯é‡å»ºï¼Œå°±æ˜¯åŠ¨ç”»çš„è¿‡ç¨‹ã€‚</p><p>ç³»ç»Ÿæ˜¯ç”¨ä¸€ä¸ªå˜é‡æ¥é€šçŸ¥è¿™ä¸ªè¿›åº¦çš„ï¼š<code>Animatable</code> protocolçš„å”¯ä¸€æˆå‘˜å˜é‡ï¼š<code>animatableData</code>:</p><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">animatableData</span><span class="p">:</span> <span class="kr">Type</span>
</pre></div>
<ul>
<li>Typeåªéœ€è¦æ»¡è¶³<code>VectorArithmetic</code>åè®®ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå¯ä»¥è¢«ç»†åˆ†çš„å€¼ï¼ŒåŸºæœ¬ä¸Šæ˜¯Float, Double, CGFloatï¼Œä»¥åŠ<code>AnimatablePair</code>(å…¶å®å°±æ˜¯ä¸¤ä¸ª<code>VectorArithmetic</code>)</li>
<li>æƒ³è¦æ”¯æŒåŠ¨ç”»çš„<code>Shape</code>, <code>ViewModifier</code>ï¼Œåªéœ€è¦å®ç°<code>Animatable</code>åè®®å³å¯ï¼ˆå³æä¾›ä¸€ä¸ª<code>animatableData</code>å±æ€§ï¼‰</li>
</ul>
<p>Because itâ€™s communicating both ways, this animatableData is a <code>read-write</code> var.</p><ul>
<li>The <code>setting</code> of this var is the animation system telling the Shape/VM which piece to draw.</li>
<li>The <code>getting</code> of this var is the animation system getting the <code>start/end</code> points of an animation.</li>
</ul>
<p><strong>å®ä¾‹ä¸€</strong></p><figure  style="flex: 73.625" ><img width="1178" height="800" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/10d0bb779b10383a36d23d581f2fadb9.png" alt=""/></figure><ul>
<li>view modifieré‡Œé¢æœ‰ä¸€ä¸ªå˜é‡<code>rotation</code>ï¼ˆZStack, content, rotation3DEffect)</li>
<li>é‚£ä¹ˆå¤–å±‚åœ¨<code>withAnimation{}</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯æœŸæœ›rotationçš„å€¼èƒ½åŠ¨èµ·æ¥çš„<ul>
<li>å†…ç½®çš„viewmodifierå½“ç„¶ä¼šè‡ªå·±åŠ¨ï¼Œå¦‚<code>opacity</code>ç­‰</li>
</ul>
</li>
<li>é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå°±è¦è®©<code>Cardify</code> conform to <code>Animatable</code>ï¼ˆä¾‹å­ä¸­çš„AnimatableModifer = Animatable + ViewModifer)</li>
<li>ç„¶åæˆ‘ä»¬å°±è¦å®ç°<code>animatableData</code>, å› ä¸ºç³»ç»Ÿäº‹å®ä¸Šå°±æ˜¯ä¸æ–­å»æ›´æ–°è¿™ä¸ªdataå€¼</li>
<li>æ•™æé‡ŒæŠŠå®ƒè¿›è¡Œäº†å°è£…ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å®ƒï¼‰ï¼Œè¿™åªæ˜¯æ€ç»´æ–¹å¼ä¸Šçš„åŒºåˆ«</li>
<li><code>animatedData</code>ä¼šéšæ—¶é—´å˜åŒ–ï¼Œè‡ªç„¶ä¼šä¸æ–­invalidate viewï¼Œç„¶årebuild viewï¼ŒåŠ¨ç”»å°±äº§ç”Ÿäº†ã€‚</li>
</ul>
<p><strong>å®ä¾‹äºŒ</strong></p><p>è¯¾ç¨‹é‡Œæœ‰è¿™ä¹ˆä¸ªéœ€æ±‚ï¼šå¡ç‰‡ç”±<code>LazyVGrid</code>æä¾›å¸ƒå±€ï¼Œä¸”å¡ç‰‡å‡ºç°å’Œæ¶ˆå¤±çš„æ—¶å€™éƒ½è¦æœ‰åŠ¨ç”»ã€‚</p><p>å‡ºç°å’Œæ¶ˆå¤±ï¼Ÿé‚£å½“ç„¶å°±æ˜¯<code>Transition</code>çš„äº‹äº†:</p><div class="highlight"><pre><span></span><span class="n">Card</span><span class="p">()</span>
  <span class="p">.</span><span class="n">transition</span><span class="p">(</span><span class="n">AnyTransition</span><span class="p">.</span><span class="n">asymmetric</span><span class="p">(</span><span class="n">insertion</span><span class="p">:</span> <span class="p">.</span><span class="n">scale</span><span class="p">,</span> 
                                         <span class="n">removal</span><span class="p">:</span> <span class="p">.</span><span class="n">opacity</span><span class="p">)))</span>
</pre></div>
<p>è¿è¡Œæ—¶å‘ç°æ¶ˆå¤±çš„æ—¶å€™æœ‰åŠ¨ç”»ï¼Œå‡ºç°çš„åŠ¨ç”»å´æ²¡æœ‰ã€‚åŸå› æ˜¯<code>transition</code>åªä¼šåœ¨<em>å‡ºç°å’Œæ¶ˆå¤±</em>æ—¶è§¦å‘ï¼Œè€Œæˆ‘ä»¬çš„å¡ç‰‡æ˜¯åŒ…åœ¨gridå®¹å™¨é‡Œçš„ï¼Œæ‰€ä»¥gridå‡ºç°åœ¨å±å¹•ä¸Šçš„æ—¶å€™ï¼Œå°±å¸¦ç€å¡ç‰‡ä¸€èµ·å‡ºç°äº†ï¼Œtransitionå¹¶ä¸ä¼šå‘ä¸‹ä¼ é€’ï¼ˆå‰æ–‡ä¹Ÿå·²ç»è¯´è¿‡äº†ï¼Œè¿™é‡Œåˆšå¥½å°è¯ï¼‰ã€‚</p><ol>
<li>æ‰€ä»¥è§£å†³æ–¹æ³•å½“ç„¶å¯ä»¥â€œå»¶è¿Ÿâ€å‘ˆç°è¿™äº›å¡ç‰‡</li>
<li>è¯¾ç¨‹é‡Œç”¨äº†å¦ä¸€ç§æ–¹æ³•ï¼Œæœºåˆ¶å½“ç„¶ä¹Ÿæ˜¯å»¶è¿Ÿï¼Œä½†ä¸æ˜¯é‚£ä¹ˆåœ°ç›´ç™½ï¼š</li>
</ol>
<figure  style="flex: 82.95774647887323" ><img width="1178" height="710" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/e7e3ef2ac16296fabf73162c1fc678fa.png" alt=""/></figure><ul>
<li>å°±æ˜¯åˆ©ç”¨äº†<code>.onAppear</code>æ¥é˜»æ–­å®¹å™¨å’Œå¡ç‰‡çš„è¿ç»­ç”Ÿæˆï¼Œè€Œæ”¹ç”¨å®¹å™¨å‘ˆç°åï¼Œå†é€ä¸ªâ€œæ·»åŠ â€çš„æ–¹å¼ï¼Œè®©æ¯ä¸€å¼ å¡ç‰‡éƒ½æœ‰ä¸€ä¸ªå•ç‹¬å‡ºç°çš„æœºä¼š</li>
<li>åŒæ—¶ä¹Ÿå¿…é¡»åˆ©ç”¨<code>@State</code>, è®©æ¯æ·»åŠ ä¸€å¼ å¡ç‰‡éƒ½ä¼šinvalidate viewä¸€æ¬¡</li>
<li>ä¹Ÿèƒ½çœ‹å‡ºï¼Œanimateèƒ½animateçš„å°±æ˜¯å±æ€§å’Œtransition</li>
</ul>
<blockquote>
<p>å½“ç„¶ï¼Œè¯¾ç¨‹æœ€åæ”¹æˆäº†â€œå‘ç‰Œâ€çš„æœºåˆ¶ï¼Œæ‰‹åŠ¨æ·»åŠ å¡ç‰‡ï¼Œå½»åº•é˜»æ–­äº†å¡ç‰‡å’Œå®¹å™¨ä¸€èµ·å‡ºç°çš„åœºæ™¯ã€‚</p></blockquote>
<p>è¿™å°±å¸¦æˆ‘ä»¬æ¥åˆ°äº†å®ä¾‹ä¸‰ï¼ŒåŒä¸€ä¸ªviewåœ¨ä¸åŒå®¹å™¨é—´çš„åŠ¨ç”»ï¼Œæ€ä¹ˆè®¡ç®—å„è‡ªå°ºåº¦ä¸‹åŒä¸€ä¸ªviewçš„ä½ç½®ï¼š<code>matchedGeometryEffect</code></p><p><strong>å®ä¾‹ä¸‰</strong></p><figure  style="flex: 73.45679012345678" ><img width="1190" height="810" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/08935bf9006d072875c203895aff17b7.png" alt=""/></figure><ul>
<li>æƒ³è¦æœ‰ç‰Œä¸€å¼ å¼ å‘å‡ºå»çš„æ•ˆæœï¼Œè‡ªç„¶ä¼šæƒ³åˆ°æ·»åŠ å»¶æ—¶</li>
<li>å®ç°æˆäº†åŒæ—¶åšåŠ¨ç”»ï¼Œåªä¸è¿‡è¶Šåˆ°åé¢çš„ç‰Œï¼Œå»¶æ—¶è¶Šé•¿ï¼ˆåŠ¨ä½œè¶Šæ…¢ï¼‰ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æƒ³è±¡çš„å…ˆåè§¦å‘</li>
</ul>
<p>ä¸ºäº†è®©ä¸åŒçš„ç‰Œå‘å‡ºå»æ—¶æœ‰ç«‹ä½“æ•ˆæœï¼Œè¿˜ä»¥indexä¸ºä¾æ®è®¾ç½®äº†<code>zIndex</code>ï¼Œæœ€ç»ˆæ•ˆæœï¼š</p><figure class="vertical-figure" style="flex: 35.714285714285715" ><img width="220" height="308" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/72b4116eb1e49a3b1eaa9097a2890b60.jpg" alt=""/></figure></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/cs193p_2021%E7%AC%94%E8%AE%B0%5B3%5D_Animation_Transition/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/cs193p_2021_%E7%AC%94%E8%AE%B0%5B2%5D/" target="_self">cs193p_2021_ç¬”è®°[2]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/cs193p_2021_%E7%AC%94%E8%AE%B0%5B2%5D/" target="_self">
                <time class="text-uppercase">
                    October 24 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><p><a href="https://www.jianshu.com/p/998b0ef4a2cd">cs193p_2021_ç¬”è®°_1</a>
cs193p_2021_ç¬”è®°_2
<a href="https://www.jianshu.com/p/d103f8d12052">cs193p_2021_ç¬”è®°_3_Animation_Transition</a>
<a href="https://www.jianshu.com/p/41e7309c7f55">cs193p_2021_ç¬”è®°_4_Color_Image_Gesture</a>
<a href="https://www.jianshu.com/p/e3c2ee1628c6">cs193p_2021_ç¬”è®°_5_Property Wrapper</a>
<a href="https://www.jianshu.com/p/a315274a4fd2">cs193p_2021_ç¬”è®°_6_Persistence</a>
<a href="https://www.jianshu.com/p/f4ae879eef9c">cs193p_2021_ç¬”è®°_7_Document Architecture</a>
<a href="https://www.jianshu.com/p/2136bdc2c6f6">cs193p_2021_ç¬”è®°_8</a></p><p>æœ¬æ–‡æ¶‰åŠå†…å®¹ï¼š<code>ViewModifier, Property Observers, Layout</code></p><hr />
<h1>ViewModifier</h1>
<p><code>.aspectRatio(2/3)</code> is likely something like <code>.modifier(AspectModifier(2/3))</code> AspectModifier can be <code>anything</code> that conforms to the <code>ViewModifier</code> protocol ...</p><p>å®ƒåªæœ‰ä¸€ä¸ªbodyæ–¹æ³•ï¼š</p><div class="highlight"><pre><span></span><span class="kd">protocol</span> <span class="nc">ViewModifier</span> <span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="n">Content</span> <span class="c1">// this is a protocolâ€™s version of aâ€œdonâ€™t careâ€ </span>
    <span class="kd">func</span> <span class="nf">body</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="n">Content</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">some</span> <span class="n">View</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">some</span> <span class="n">View</span> <span class="n">that</span> <span class="n">represents</span> <span class="n">a</span> <span class="n">modification</span> <span class="n">of</span> <span class="n">content</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<ul>
<li>å¯¹ä¸€ä¸ªviewè°ƒç”¨<code>.modifier</code>å°±æ˜¯æŠŠè¿™ä¸ªviewä¼ æˆäº†ä¸Šè¿°bodyæ–¹æ³•çš„content</li>
<li>è€Œä»<code>.modifer</code>å˜æˆ<code>.cardify</code>ï¼Œä¸è¿‡æ˜¯ç”¨äº†<code>extension</code>ï¼š</li>
</ul>
<div class="highlight"><pre><span></span><span class="kd">extension</span> <span class="nc">View</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">cardify</span><span class="p">(</span><span class="n">isFaceUp</span><span class="p">:</span> <span class="nb">Bool</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">some</span> <span class="n">View</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">self</span><span class="p">.</span><span class="n">modifier</span><span class="p">(</span><span class="n">Cardify</span><span class="p">(</span><span class="n">isFaceUp</span><span class="p">:</span> <span class="n">isFaceUp</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h1>Property Observers</h1>
<ul>
<li>è¯­æ³•é•¿å¾—åƒ<code>computed var</code>, ä½†å®Œå…¨ä¸æ˜¯ä¸€å›äº‹ ï¼ˆget, setä¹‹äºwillSet, didSetï¼‰</li>
<li>willSet, didSetï¼Œå¯¹åº”newValue, oldValue</li>
</ul>
<h2>@State</h2>
<p>your view is <strong>Read Only</strong>,</p><p>ä¸ºä»€ä¹ˆï¼Ÿ</p><blockquote>
<p>å› ä¸ºviewçš„ç”Ÿå‘½å‘¨æœŸè¶³å¤ŸçŸ­ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸æ–­åœ°ç”Ÿæˆå’Œé”€æ¯ï¼Œæ ¹æœ¬ä¸éœ€è¦â€è¢«æ”¹å˜â€œ</p></blockquote>
<ul>
<li>æ‰€ä»¥æ°¸è¿œç”¨<code>let</code></li>
<li>æ‰€ä»¥æ˜¯<code>stateles</code>çš„</li>
</ul>
<p>è¿™æ ·çš„ç»“æ„å¾ˆç®€å•ï¼Œä»»ä½•viewçš„å˜åŒ–å…¶å®å°±æ˜¯é‡ç»˜ã€‚</p><p>ä»ç„¶æœ‰äº›æ—¶å€™éœ€è¦çŠ¶æ€ï¼š</p><ul>
<li>ç¼–è¾‘è¡¨å•</li>
<li>æ¨¡æ€çª—å£æˆ–é€šçŸ¥çª—å£ç­‰ä¸´æ—¶çª—å£</li>
<li>åŠ¨ç”»éœ€è¦è¿½è¸ªåŠ¨ç”»è¿›åº¦</li>
</ul>
<p>å£°æ˜ï¼š</p><div class="highlight"><pre><span></span><span class="p">@</span><span class="n">State</span> <span class="kd">private</span> <span class="kd">var</span> <span class="nv">somethingTemporary</span><span class="p">:</span> <span class="n">SomeType</span> <span class="c1">// this can be of any type</span>
</pre></div>
<ul>
<li>private è¡¨ç¤ºåˆ«äººè®¿é—®ä¸åˆ°</li>
<li>@Stateçš„çš„å˜åŒ–ä¼šåœ¨<strong>å¿…è¦æ—¶</strong>å¼•èµ·é‡ç»˜ ï¼ˆç›¸å½“äºä¸€ä¸ª<code>@ObservedObject</code>ï¼‰</li>
<li>viewä¼šä¸æ–­é”€æ¯å’Œé‡å»º -&gt; æŒ‡é’ˆä¼šæ°¸è¿œæŒ‡å‘æ–°çš„å†…å­˜åœ°å€</li>
<li>è€Œstateæ˜¯åœ¨å †ä¸Šåˆ†é…çš„ç©ºé—´</li>
<li>æ‰€ä»¥é”€æ¯å’Œé‡å»ºviewå¹¶ä¸ä¼šä¸¢å¤±state</li>
<li>åæ–‡<code>property wrapper</code>è¯¦è¿°</li>
</ul>
<h1>Layout</h1>
<ol>
<li><code>Container</code>æä¾›ç©ºé—´</li>
<li><code>Views</code>ç¡®å®šè‡ªèº«çš„å¤§å°</li>
<li><code>Container</code>æä¾›<code>View</code>çš„ä½ç½®</li>
<li><code>Container</code>ç¡®å®šè‡ªèº«å¤§å°ï¼ˆç­‰åŒäº#2)</li>
</ol>
<h2>HStack and VStack</h2>
<p>æ¨ª/çºµå‘æ’åˆ—å…ƒç´ (View)ï¼Œå¹¶æä¾›â€œå°½å¯èƒ½å°â€çš„ç©ºé—´ï¼Œæ ¹æ®å…ƒç´ æ€§è´¨ï¼Œæœ‰ä¸‰ç§åœºæ™¯ï¼š</p><ol>
<li><code>inflexble</code> view: <code>Image</code>ï¼Œfixed size</li>
<li>slightly more flexible view: <code>Text</code>ï¼Œé€‚åº”æ–‡å­—çš„åˆé€‚å¤§å°</li>
<li>very flexible view: <code>RoundedRectangle</code>: å æ»¡ç©ºé—´ -&gt; åŸºæœ¬ä¸Š<code>Shape</code>éƒ½ä¼šæœ‰å¤šå°‘ç©ºé—´å å¤šå°‘</li>
</ol>
<ul>
<li>ä¸€æ—¦å…ƒç´ ç¡®å®šäº†sizeï¼Œå¤šä½™çš„ç©ºé—´å°±ä¼šç»™ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œæœ€å<code>very flexible view</code>å¹³å‡åˆ†é…å‰©ä¸‹çš„ç©ºé—´</li>
<li>æ‰€æœ‰å…ƒç´ å¤§å°ç¡®å®šï¼Œå®¹å™¨å¤§å°ä¹Ÿå°±ç¡®å®šäº†ï¼Œå¦‚æœæœ‰<code>very flexible</code>çš„ï¼Œé‚£ä¹ˆå®¹æ˜“æœ¬èº«ä¹Ÿæ˜¯<code>very flexible</code>çš„</li>
</ul>
<p>remarkï¼š</p><ul>
<li><code>Spacer(minLength: CGFloat)</code> ç©ºæ ¼, draw nothing, å å°½å¯èƒ½å¤šçš„ç©ºé—´</li>
<li><code>Divider()</code> ç”»æ¡åˆ†éš”çº¿ï¼Œå å°½å¯èƒ½å°çš„ç©ºé—´</li>
<li><code>.layoutPriority(100)</code> ç”¨ä¼˜å…ˆçº§æ¥è¡¨ç¤ºåˆ†é…ç©ºé—´çš„é¡ºåºï¼Œé»˜è®¤å€¼ä¸º0ã€‚ååˆ†é…è€…å¦‚æœæ²¡æœ‰ç©ºé—´äº†ä¼šç”¨çœç•¥å·è¡¨ç¤º</li>
<li><code>HStack(alignment: .leading)</code>ç”¨æ¥æ§åˆ¶å…ƒç´ çš„å¯¹é½</li>
</ul>
<blockquote>
<p>List, Form, OutlineGroup å…¶å®å°±æ˜¯ <code>really smart VStacks</code>ï¼Œå³æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªçºµå‘æ’åˆ—çš„å¸ƒå±€ã€‚</p></blockquote>
<h2>LazyHStack and LazyVStack</h2>
<ul>
<li><em>Lazy</em>çš„æ„æ€æ˜¯å¦‚æœå…ƒç´ å¯¹åº”çš„ä½ç½®æ²¡æœ‰å‡ºç°åœ¨å±å¹•ä¸Šï¼Œå°±ä¸ä¼šæ„å»ºView.</li>
<li>they also size themselves to fit their views</li>
<li>å‰ä¸¤æ¡åŠ ä¸€èµ·ï¼Œå¾—å‡ºè¿™ä¸ªå®¹å™¨ä¸ä¼šå°½å¯èƒ½å¤šçš„å ç”¨ç©ºé—´ï¼Œå³ä½¿å«æœ‰very flexibleçš„view -&gt; å°½å¯èƒ½å°çš„ç©ºé—´</li>
<li>æ˜¾ç„¶ï¼Œå®ƒæœ€å¤šå‡ºç°åœ¨<code>ScrollView</code>é‡Œï¼ˆåªæœ‰åœ¨æœ‰é™çª—å£é‡Œæ»šåŠ¨ï¼Œæ‰æœ‰å¯è§ä¸å¯è§çš„å·®åˆ«ï¼‰</li>
</ul>
<h2>Scrollview</h2>
<ul>
<li>ç»™å¤šå°‘ç©ºé—´å å¤šå°‘ç©ºé—´</li>
</ul>
<h2>LazyHGrid and LazyVGrid</h2>
<ul>
<li>ä¸€ä¸ªæ–¹å‘viewæ•°é‡å›ºå®šï¼Œå¦ä¸€ä¸ªæ–¹å‘åŠ¨æ€å¢å‡ï¼ˆscrollï¼‰çš„H/V stackï¼Œä»¥ç«–å‘çš„<code>LazyVGrid</code>ä¸ºä¾‹ï¼š</li>
<li>ç¡®å®šæ¯è¡Œå…ƒç´ ä¸ªæ•°ï¼Œå¤šå°‘è¡Œç”±å…ƒç´ æ€»æ•°å†³å®š</li>
<li>æˆ–è€…ç¡®å®šå…ƒç´ å¤§å°ï¼Œåœ¨è¡Œæ–¹å‘é“ºæ»¡åï¼Œå†å¾€ä¸‹ä¸€è¡Œé“º</li>
<li>HGridæ–¹å‘åˆ™æ˜¯å…ˆçºµå‘é“ºæ»¡ï¼Œå†æ°´å¹³é“º</li>
</ul>
<h2>ZStack</h2>
<ul>
<li>sizes itself to fit its children</li>
<li>can be very flexible (if one children is)</li>
</ul>
<p>ä¸¤ä¸ªmodifierå…¶å®ä¹Ÿæ˜¯ç”¨çš„ZStack:</p><ul>
<li><code>.background</code>ï¼Œæ’å…¥ä¸€ä¸ªviewåœ¨åº•å±‚ï¼Œstackèµ·æ¥: <code>Text(&quot;hello&quot;).background(Rectangle().foregroundColor(.red))</code></li>
<li><code>.overlay</code>ï¼Œè¦†ç›–åˆ°è¡¨å±‚çš„zstack: <code>Circle().overlay(Text(&quot;hello&quot;), alignment:.center)</code></li>
</ul>
<p>Moreï¼š</p><ul>
<li>ä¸€ä¸ªviewæ˜¯å¯ä»¥é€‰æ‹©ä»»æ„sizeçš„ï¼Œå“ªæ€•æ¯”ç»™å®ƒçš„ç©ºé—´æ›´å¤§(äº§ç”Ÿè£å‰ª)</li>
<li><code>.aspectRatio(2/3, contentMode: .fit)</code>å¦‚æœæ˜¯åœ¨HStacké‡Œï¼Œ<ul>
<li>åˆ™æ˜¯æŠŠå…ƒç´ æ¨ªå‘æ’åˆ—åå¾—åˆ°å®½åº¦ï¼Œæ ¹æ®å®½åº¦è®¡ç®—å‡ºé«˜åº¦ï¼Œå¾—åˆ°å…ƒç´ å¤§å°</li>
<li><code>.fit</code>è¡¨ç¤ºå®Œæ•´æ˜¾ç¤ºå›¾ç‰‡ï¼ˆå°±é•¿è¾¹ï¼‰ï¼ŒçŸ­è¾¹éƒ¨åˆ†è¡¥æˆé»‘è‰²ï¼Œ<code>.fill</code>åº”è¯¥æ˜¯å°±çŸ­è¾¹ï¼Œé•¿è¾¹éƒ¨åˆ†å°±è£å‰ªäº†</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">HStack</span> <span class="p">{</span>
    <span class="n">ForEach</span><span class="p">(</span><span class="n">cards</span><span class="p">)</span> <span class="p">{</span> <span class="n">card</span> <span class="k">in</span>
        <span class="n">CardView</span><span class="p">(</span><span class="n">card</span><span class="p">).</span><span class="n">aspectRatio</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">contentMode</span><span class="p">:</span> <span class="p">.</span><span class="n">fit</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
    <span class="p">.</span><span class="n">foregroundColor</span><span class="p">(.</span><span class="n">orange</span><span class="p">)</span>
    <span class="p">.</span><span class="n">padding</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
<ol>
<li>åœ¨èƒ½å¤Ÿåˆ†é…çš„ç©ºé—´é‡Œï¼Œå››è¾¹å„å‡10 -&gt; padding(10)</li>
<li>å‡10åçš„ç©ºé—´é‡Œï¼Œæ ¹æ®aspectRationç¡®å®šä¸€ä¸ªsize</li>
<li>è¿™ä¸ªsizeåº”ç”¨ç»™CardView</li>
<li>ç»„åˆæˆHStackçš„size</li>
</ol>
<p>æ€»å¤§å°å°±æ˜¯HStackçš„sizeå››è¾¹å„åŠ 10</p><p>è€ŒViewä»¬å¦‚ä½•çŸ¥é“èƒ½å å¤šå°‘ç©ºé—´ï¼Ÿ-&gt; <code>GeometryReader</code></p><h2>GeometryReader</h2>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">View</span> <span class="p">{</span>
    <span class="n">GeometryReader</span> <span class="p">{</span> <span class="n">geometry</span> <span class="k">in</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>å‚æ•°<code>geometry</code>æ˜¯ä¸€ä¸ª<code>GeometryProxy</code>:</p><div class="highlight"><pre><span></span><span class="kd">struct</span> <span class="nc">GeometryProxy</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">size</span><span class="p">:</span> <span class="n">CGSize</span>
    <span class="kd">var</span> <span class="nv">safeAreaInsets</span><span class="err">ï¼š</span> <span class="n">EdgeInsets</span>
    <span class="kd">func</span> <span class="nf">frame</span><span class="p">(</span><span class="k">in</span><span class="p">:</span> <span class="n">CoordinateSpace</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">CGRect</span>
<span class="p">}</span>
</pre></div>
<ul>
<li><code>size</code>è¡¨ç¤ºè¢«æä¾›äº†å¤šå°‘çš„ç©ºé—´ï¼ˆby its container)</li>
<li>å¹¶ä¸”ä¸åŒ…å«safe areaï¼ˆå¦‚åˆ˜æµ·ï¼‰</li>
<li>å¦‚æœéœ€è¦ç»˜åˆ¶åˆ°safe areaé‡Œå»: <code>ZStack{...}.edgesIgnoringSafeArea([.top])</code></li>
</ul>
<figure  style="flex: 127.6086956521739" ><img width="1174" height="460" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/aa2a99b80008d002cfc2521af182c43d.png" alt=""/></figure><p>å›¾ä¸­æ¼”ç¤ºçš„æ˜¯è®¾ç½®å¡ç‰‡å­—ä½“çš„å¤§å°ï¼Œå¸Œæœ›å°½å¯èƒ½åœ°å¡«å……å¡ç‰‡ï¼Œ<code>geometry.size</code>èƒ½ç»™å‡ºè¿è¡Œæ—¶æ•°æ®ï¼Œè€Œæ— éœ€ç¡¬ç¼–ç ã€‚</p></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/cs193p_2021_%E7%AC%94%E8%AE%B0%5B2%5D/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/cs193p_2021_%E7%AC%94%E8%AE%B0%5B1%5D/" target="_self">cs193p_2021_ç¬”è®°[1]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/cs193p_2021_%E7%AC%94%E8%AE%B0%5B1%5D/" target="_self">
                <time class="text-uppercase">
                    October 24 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><p>2020å¹´çœ‹äº†ä¸€éï¼Œåæ¥å­¦æ·±åº¦å­¦ä¹ å»äº†ï¼Œç„¶åå‘ç°2021ä¹Ÿå‡ºæ¥äº†ï¼Œä»ç„¶æ˜¯è§†é¢‘æˆè¯¾ï¼ˆå¯¹æˆ‘ä»¬æ²¡åŒºåˆ«ï¼‰ï¼Œçœ‹å®Œåæ•´ç†äº†ä¸¤å¹´è¯¾ç¨‹çš„ç¬”è®°ã€‚</p><p>æœ¬æ–‡æ¶‰åŠå†…å®¹ï¼š<code>struct, enum, optional, protocol, viewbuilder, shape</code></p><p><a href="https://www.jianshu.com/p/af0ad1bead34">cs193p_2021_ç¬”è®°_2</a>
<a href="https://www.jianshu.com/p/d103f8d12052">cs193p_2021_ç¬”è®°_3_Animation_Transition</a>
<a href="https://www.jianshu.com/p/41e7309c7f55">cs193p_2021_ç¬”è®°_4_Color_Image_Gesture</a>
<a href="https://www.jianshu.com/p/e3c2ee1628c6">cs193p_2021_ç¬”è®°_5_Property Wrapper</a>
<a href="https://www.jianshu.com/p/a315274a4fd2">cs193p_2021_ç¬”è®°_6_Persistence</a>
<a href="https://www.jianshu.com/p/f4ae879eef9c">cs193p_2021_ç¬”è®°_7_Document Architecture</a>
<a href="https://www.jianshu.com/p/2136bdc2c6f6">cs193p_2021_ç¬”è®°_8</a></p><hr />
<h1>struct and class</h1>
<p>æ‹¥æœ‰å·®ä¸å¤šçš„ç»“æ„</p><ul>
<li>stored vars</li>
<li>computed vars</li>
<li>constant lets</li>
<li>functions</li>
<li>initializers</li>
</ul>
<p>differents:
struct | class
-------|------
Value type | Reference type
Copied when passed or assigned | Passed around via pointers 
Copy on write | Automatically reference counted 
Functional programming | Object-oriented programming 
No inheritance | Inheritance (single) 
â€œFreeâ€ï¼ˆç¼ºçœï¼‰ init initializes ALL vars | â€œFreeâ€ init initializes NO vars 
Mutability must be explicitly stated | Always mutable (å³ä½¿ç”¨let, åªè¡¨ç¤ºä¸ä¼šæ”¹å˜æŒ‡é’ˆ)
Your â€œgo toâ€ data structure | Used in specific circumstances
Everything youâ€™ve seen so far is a struct (except View which is a protocol) | The ViewModel in MVVM is always a class (also, UIKit (old style iOS) is class-based)</p><h1>æ³›å‹ï¼Œå‡½æ•°ç±»å‹,é—­åŒ…</h1>
<ul>
<li>å…è®¸æœªçŸ¥ç±»å‹ï¼Œä½†swiftæ˜¯å¼ºç±»å‹ï¼Œæ‰€ä»¥ç”¨ç±»å‹å ä½ç¬¦ï¼Œç”¨ä½œå‚æ•°æ—¶å‚è€ƒ.netçš„æ³›å‹</li>
<li>å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§ç±»å‹ï¼Œå¯ä»¥å½“ä½œå˜é‡ï¼Œå‚æ•°ï¼Œå‡ºç°åœ¨å˜é‡ï¼Œå‚æ•°çš„ä½ç½®</li>
<li>in-lineé£æ ¼çš„å‡½æ•°å«<code>closure</code>(é—­åŒ…)</li>
</ul>
<h1>enum</h1>
<ul>
<li>æšä¸¾æ˜¯å€¼ç±»å‹</li>
<li>æšä¸¾çš„æ¯ä¸ªstateéƒ½å¯ä»¥æœ‰<code>associated data</code>ï¼ˆç­‰äºæ˜¯æŠŠæ¯ä¸ªstateçœ‹æˆä¸€ä¸ªclass/structï¼Œassociated dataå°±å¯ä»¥ç†è§£ä¸º<strong>å±æ€§</strong>)</li>
</ul>
<div class="highlight"><pre><span></span><span class="kd">enum</span> <span class="nc">FastFoodMenuItem</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">hamburger</span><span class="p">(</span><span class="n">numberOfPatties</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span>
    <span class="k">case</span> <span class="n">fries</span><span class="p">(</span><span class="n">size</span><span class="p">:</span> <span class="n">FryOrderSize</span><span class="p">)</span>
    <span class="k">case</span> <span class="n">drink</span><span class="p">(</span><span class="nb">String</span><span class="p">,</span> <span class="n">ounces</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="c1">// the unnamed String is the brand, e.g. â€œCokeâ€</span>
    <span class="k">case</span> <span class="n">cookie</span> <span class="p">}</span>

<span class="kd">enum</span> <span class="nc">FryOrderSize</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">large</span>
    <span class="k">case</span> <span class="n">small</span> <span class="p">}</span>

<span class="kd">let</span> <span class="nv">menuItem</span><span class="p">:</span> <span class="n">FastFoodMenuItem</span> <span class="p">=</span> <span class="n">FastFoodMenuItem</span><span class="p">.</span><span class="n">hamburger</span><span class="p">(</span><span class="n">patties</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
<span class="kd">var</span> <span class="nv">otherItem</span><span class="p">:</span> <span class="n">FastFoodMenuItem</span> <span class="p">=</span> <span class="n">FastFoodMenuItem</span><span class="p">.</span><span class="n">cookie</span>
<span class="kd">var</span> <span class="nv">yetAnotherItem</span> <span class="p">=</span> <span class="p">.</span><span class="n">cookie</span> <span class="c1">// Swift canâ€™t figure this out</span>
</pre></div>
<ol>
<li>FryOrderSizeåŒæ—¶åˆæ˜¯ä¸€ä¸ªæšä¸¾</li>
<li>çŠ¶æ€drinkæ‹¥æœ‰ä¸¤ä¸ªâ€œå±æ€§â€ï¼Œè€Œä¸”å…¶ä¸­ä¸€ä¸ªè¿˜<strong>æœªå‘½å</strong></li>
</ol>
<h2>break and fall through/defaults</h2>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">menuItem</span> <span class="p">=</span> <span class="n">FastFoodMenuItem</span><span class="p">.</span><span class="n">cookie</span>
<span class="k">switch</span> <span class="n">menuItem</span> <span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">hamburger</span><span class="p">:</span> <span class="k">break</span>  <span class="c1">// break</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">fries</span><span class="p">:</span> <span class="bp">print</span><span class="p">(</span><span class="err">â€œ</span><span class="n">fries</span><span class="err">â€</span><span class="p">)</span>
    <span class="k">default</span><span class="p">:</span> <span class="bp">print</span><span class="p">(</span><span class="err">â€œ</span><span class="n">other</span><span class="err">â€</span><span class="p">)</span> <span class="c1">// default</span>
<span class="p">}</span>
</pre></div>
<ol>
<li>å¦‚æœæŠŠdrinkå†™ä¸Šï¼Œä½†æ²¡æœ‰æ–¹æ³•ä½“ï¼Œåˆ™å«<code>fall through</code>ï¼Œåªä¼šå¾€åé¢ä¸€ä¸ªstate fall through</li>
<li>å¦‚æœæ¼å†™äº†drinkï¼Œåˆ™ä¼šåŒ¹é…åˆ°defaulté¡¹ï¼ˆcookieåŒç†ï¼‰</li>
</ol>
<h2>with associated data</h2>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">menuItem</span> <span class="p">=</span> <span class="n">FastFoodMenuItem</span><span class="p">.</span><span class="n">drink</span><span class="p">(</span><span class="err">â€œ</span><span class="n">Coke</span><span class="err">â€</span><span class="p">,</span> <span class="n">ounces</span><span class="p">:</span> <span class="mi">32</span><span class="p">)</span>
  <span class="k">switch</span> <span class="n">menuItem</span> <span class="p">{</span>
      <span class="k">case</span> <span class="p">.</span><span class="n">hamburger</span><span class="p">(</span><span class="kd">let</span> <span class="nv">pattyCount</span><span class="p">):</span> <span class="bp">print</span><span class="p">(</span><span class="err">â€œ</span><span class="n">a</span> <span class="n">burger</span> <span class="n">with</span> <span class="err">\</span><span class="p">(</span><span class="n">pattyCount</span><span class="p">)</span> <span class="n">patties</span><span class="p">!</span><span class="err">â€</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">.</span><span class="n">fries</span><span class="p">(</span><span class="kd">let</span> <span class="nv">size</span><span class="p">):</span> <span class="bp">print</span><span class="p">(</span><span class="err">â€œ</span><span class="n">a</span> <span class="err">\</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="n">order</span> <span class="n">of</span> <span class="n">fries</span><span class="p">!</span><span class="err">â€</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">.</span><span class="n">drink</span><span class="p">(</span><span class="kd">let</span> <span class="nv">brand</span><span class="p">,</span> <span class="kd">let</span> <span class="nv">ounces</span><span class="p">):</span> <span class="bp">print</span><span class="p">(</span><span class="err">â€œ</span><span class="n">a</span> <span class="err">\</span><span class="p">(</span><span class="n">ounces</span><span class="p">)</span><span class="n">oz</span> <span class="err">\</span><span class="p">(</span><span class="n">brand</span><span class="p">)</span><span class="err">â€</span><span class="p">)</span>
      <span class="k">case</span> <span class="p">.</span><span class="n">cookie</span><span class="p">:</span> <span class="bp">print</span><span class="p">(</span><span class="err">â€œ</span><span class="n">a</span> <span class="n">cookie</span><span class="p">!</span><span class="err">â€</span><span class="p">)</span>
 <span class="p">}</span>
</pre></div>
<h2>å¯ä»¥æ‹¥æœ‰æ–¹æ³•</h2>
<p>è¿™å°±å¯ä»¥æ‰©å±•å‡ºcomputed vars</p><div class="highlight"><pre><span></span><span class="kd">enum</span> <span class="nc">FastFoodMenuItem</span> <span class="p">{</span> <span class="p">...</span>
      <span class="kd">func</span> <span class="nf">isIncludedInSpecialOrder</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="nb">Int</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span>
          <span class="k">switch</span> <span class="kc">self</span> <span class="p">{</span>
            <span class="k">case</span> <span class="p">.</span><span class="n">hamburger</span><span class="p">(</span><span class="kd">let</span> <span class="nv">pattyCount</span><span class="p">):</span> <span class="k">return</span> <span class="n">pattyCount</span> <span class="p">==</span> <span class="n">number</span>
            <span class="k">case</span> <span class="p">.</span><span class="n">fries</span><span class="p">,</span> <span class="p">.</span><span class="n">cookie</span><span class="p">:</span> <span class="k">return</span> <span class="kc">true</span> <span class="c1">// a drink and cookie in every special order </span>
            <span class="k">case</span> <span class="p">.</span><span class="n">drink</span><span class="p">(</span><span class="kc">_</span><span class="p">,</span> <span class="kd">let</span> <span class="nv">ounces</span><span class="p">):</span> <span class="k">return</span> <span class="n">ounces</span> <span class="p">==</span> <span class="mi">16</span> <span class="c1">// &amp; 16oz drink of any kind</span>
 <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2>Iterable</h2>
<p>conform <code>CaseIterable</code>åè®®å°±èƒ½è¢«éå†ï¼Œå› ä¸ºå¢åŠ äº†ä¸€ä¸ª<code>allCases</code>çš„é™æ€å˜é‡ï¼š</p><div class="highlight"><pre><span></span><span class="kd">enum</span> <span class="nc">TeslaModel</span><span class="p">:</span> <span class="n">CaseIterable</span> <span class="p">{</span>
      <span class="k">case</span> <span class="n">X</span>
      <span class="k">case</span> <span class="n">S</span>
      <span class="k">case</span> <span class="n">Three</span>
      <span class="k">case</span> <span class="n">Y</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">model</span> <span class="k">in</span> <span class="n">TeslaModel</span><span class="p">.</span><span class="n">allCases</span> <span class="p">{</span>
    <span class="n">reportSalesNumbers</span><span class="p">(</span><span class="k">for</span><span class="p">:</span> <span class="n">model</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nf">reportSalesNumbers</span><span class="p">(</span><span class="k">for</span> <span class="n">model</span><span class="p">:</span> <span class="n">TeslaModel</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="n">model</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>SwiftUIå®ä¾‹ï¼Œ <code>LazyVGrid</code>ä¸­ï¼š</p><div class="highlight"><pre><span></span><span class="kd">struct</span> <span class="nc">GridItem</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="kd">enum</span> <span class="nc">Size</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">adaptive</span><span class="p">(</span><span class="n">minimum</span><span class="p">:</span> <span class="n">CGFloat</span><span class="p">,</span> <span class="n">maximum</span><span class="p">:</span> <span class="n">CGFloat</span> <span class="p">=</span> <span class="p">.</span><span class="n">infinity</span><span class="p">)</span>
        <span class="k">case</span> <span class="n">fixed</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span>
        <span class="k">case</span> <span class="n">flexible</span><span class="p">(</span><span class="n">minimum</span><span class="p">:</span> <span class="n">CGFloat</span> <span class="p">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">maximum</span><span class="p">:</span> <span class="n">CGFloat</span> <span class="p">=</span> <span class="p">.</span><span class="n">infinity</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<ol>
<li><code>associated data</code>è¿˜èƒ½å¸¦é»˜è®¤å€¼</li>
<li>æ ¸å¿ƒä½œç”¨æ˜¯å‘Šè¯‰ç³»ç»Ÿgriditemçš„sizeæ˜¯é‡‡ç”¨å“ªç§æ–¹æ¡ˆï¼ˆæšä¸¾ï¼‰ï¼Œé¡ºä¾¿è®¾ç½®äº†è¿™ç§æ–¹æ¡ˆä¸‹çš„å‚æ•°ã€‚æ‰€ä»¥è¿™ç§åœºæ™¯åœ¨swiftä¸‹å®Œå…¨å¯ä»¥ç”¨æšä¸¾åšåˆ°</li>
</ol>
<h1>Optionals</h1>
<p>å¯é ç±»å‹å…¶å®å°±æ˜¯ä¸€ä¸ª<code>Enum</code></p><div class="highlight"><pre><span></span><span class="kd">enum</span> <span class="nc">Optional</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="p">{</span> <span class="c1">// a generic type, like Array&lt;Element&gt; or MemoryGame&lt;CardContent&gt; </span>
    <span class="k">case</span> <span class="kr">none</span>
    <span class="k">case</span> <span class="n">some</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1">// the some case has associated value of type T }</span>
</pre></div>
<p>å®ƒåªæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼Œè¦ä¹ˆæ˜¯noneï¼Œè¦ä¹ˆå°±æ˜¯is setçš„çŠ¶æ€ï¼Œå…·ä½“çš„å€¼å…¶å®æ˜¯ç»‘å®šåˆ°äº†<code>associate data</code>é‡Œå»äº†</p><p>æ‰€ä»¥ä½ ç°åœ¨çŸ¥é“äº†æœ‰ä¸€ç§å–æ³•å…¶å®å°±æ˜¯ä»<code>some</code>é‡Œé¢æ¥å–äº†ã€‚</p><h2>è¯­æ³•ç³–</h2>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span>
<span class="kd">var</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span> <span class="p">=</span> <span class="err">â€œ</span><span class="n">hello</span><span class="err">â€</span>
<span class="kd">var</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>
<span class="c1">// å…¶å®æ˜¯ï¼š</span>
<span class="kd">var</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">Optional</span><span class="p">&lt;</span><span class="nb">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="p">.</span><span class="kr">none</span>
<span class="kd">var</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">Optional</span><span class="p">&lt;</span><span class="nb">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="err">â€œ</span><span class="n">hello</span><span class="err">â€</span><span class="p">)</span>
<span class="kd">var</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">Optional</span><span class="p">&lt;</span><span class="nb">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="p">.</span><span class="kr">none</span>
</pre></div>
<p>ä½¿ç”¨ï¼š</p><div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nv">hello</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span> <span class="p">=</span> <span class="p">...</span>
<span class="bp">print</span><span class="p">(</span><span class="n">hello</span><span class="p">!)</span> 
<span class="c1">// å…¶å®æ˜¯ï¼š</span>
<span class="k">switch</span> <span class="n">hello</span> <span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="kr">none</span><span class="p">:</span> <span class="c1">// raise an exception (crash) </span>
    <span class="k">case</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="kd">let</span> <span class="nv">data</span><span class="p">):</span> <span class="bp">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">if</span> <span class="kd">let</span> <span class="nv">safehello</span> <span class="p">=</span> <span class="n">hello</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">safehello</span><span class="p">)</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// do something else</span>
<span class="p">}</span>
<span class="c1">// å…¶å®æ˜¯ï¼š</span>
<span class="k">switch</span> <span class="n">hello</span> <span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="kr">none</span><span class="p">:</span> <span class="p">{</span> <span class="c1">// do something else } </span>
    <span class="k">case</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="kd">let</span> <span class="nv">data</span><span class="p">):</span> <span class="bp">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// è¿˜æœ‰ä¸€ç§ï¼š</span>

<span class="kd">let</span> <span class="nv">x</span><span class="p">:</span> <span class="nb">String</span><span class="p">?</span> <span class="p">=</span> <span class="p">...</span>
<span class="kd">let</span> <span class="nv">y</span> <span class="p">=</span> <span class="n">x</span> <span class="p">??</span> <span class="err">â€œ</span><span class="n">foo</span><span class="err">â€</span>
<span class="c1">// å…¶å®æ˜¯ï¼š</span>
<span class="k">switch</span> <span class="n">x</span> <span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="kr">none</span><span class="p">:</span> <span class="n">y</span> <span class="p">=</span> <span class="err">â€œ</span><span class="n">foo</span><span class="err">â€</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="kd">let</span> <span class="nv">data</span><span class="p">):</span> <span class="n">y</span> <span class="p">=</span> <span class="n">data</span>
<span class="p">}</span>
</pre></div>
<ol>
<li>æ‰€ä»¥ç”¨<code>!</code>æ¥è§£åŒ…æ˜¯ä¼šæŠ¥é”™çš„åŸç†åœ¨æ­¤</li>
<li><code>guard</code>çš„åŸç†åŒæ ·æ˜¯<code>switch</code></li>
<li>é»˜è®¤å€¼çš„åŸç†ä½ åº”è¯¥ä¹Ÿèƒ½çŒœåˆ°äº†</li>
<li>ä¸‰ä¸ªè¯­æ³•ç³–ï¼Œå¯¹åº”çš„åº•å±‚å°±æ˜¯ä¸€å¥switchï¼Œå…¶å®å°±æ˜¯<code>.none</code>æ—¶çš„ä¸‰ç§å¤„ç†æ–¹æ¡ˆ</li>
</ol>
<p>å½“ç„¶ï¼Œè¿˜å¯ä»¥<code>chain</code>èµ·æ¥
let x: String? = ...
let y = x?foo()?bar?.z</p><p>// å°è¯•è¿˜åŸä¸€ä¸‹ï¼š</p><div class="highlight"><pre><span></span><span class="k">switch</span> <span class="n">x</span> <span class="p">{</span>
    <span class="k">case</span> <span class="p">.</span><span class="kr">none</span><span class="p">:</span> <span class="n">y</span> <span class="p">=</span> <span class="kc">nil</span>
    <span class="k">case</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="kd">let</span> <span class="nv">xval</span><span class="p">)::</span>
        <span class="k">switch</span> <span class="n">xval</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">case</span> <span class="p">.</span><span class="kr">none</span><span class="p">:</span> <span class="n">y</span> <span class="p">=</span> <span class="kc">nil</span>
            <span class="k">case</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="kd">let</span> <span class="nv">xfooval</span><span class="p">):</span>
                <span class="k">switch</span> <span class="n">xfooval</span><span class="p">.</span><span class="n">bar</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="p">.</span><span class="kr">none</span><span class="p">:</span> <span class="n">y</span> <span class="p">=</span> <span class="kc">nil</span>
                    <span class="k">case</span> <span class="p">.</span><span class="n">some</span><span class="p">(</span><span class="kd">let</span> <span class="nv">xfbarval</span><span class="p">):</span>
                        <span class="n">y</span> <span class="p">=</span> <span class="n">xfbarval</span><span class="p">.</span><span class="n">z</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>è®°ä½æ¯ä¸€ä¸ªå¥å·å¯¹åº”ä¸€ä¸ªswitchï¼Œç„¶ååœ¨<code>.none</code>çš„çŠ¶æ€ä¸‹å®‰å…¨é€€å‡ºå°±æ˜¯<code>?</code>çš„ç”¨æ³•äº†ã€‚</p><h1>@ViewBuilder</h1>
<ol>
<li>ä»»æ„<code>func</code>æˆ–<code>åªè¯»çš„è®¡ç®—å±æ€§</code>éƒ½å¯ä»¥æ ‡è¯†ä¸º<code>@ViewBuilder</code>ï¼Œä¸€æ—¦æ ‡è¯†ï¼Œå®ƒé‡Œé¢çš„å†…å®¹å°†ä¼šè¢«è§£æä¸º<code>a list of Views</code>ï¼ˆä¹Ÿä»…ä»…æ˜¯è¿™ä¸ªï¼Œæœ€å¤šå†åŠ ä¸Šif-elseæ¥é€‰æ‹©æ˜¯â€œå“ªäº›viewâ€ï¼Œä¸èƒ½å†å®šä¹‰å˜é‡å’Œå†™å…¶å®ƒä»£ç äº†ï¼‰<ul>
<li>ä¸€ä¸ªå…¸å‹ä¾‹å­å°±æ˜¯Viewé‡Œé¢æ‰£å‡ºæ¥çš„ä»£ç (æ¯”å¦‚å­view)åšæˆæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯éœ€è¦åŠ ä¸Š@ViewBuilderçš„</li>
<li>æˆ–è€…æ”¹è¯­æ³•</li>
<li>æˆ–è€…åªæœ‰ä¸€ä¸ªViewï¼Œå°±ä¸ä¼šäº§ç”Ÿè¯­æ³•æ­§ä¹‰ï¼Œä¹Ÿæ˜¯å¯ä»¥ä¸åŠ @ViewBuilderçš„</li>
</ul>
</li>
<li>æ‰€ä»¥ä¸éœ€è¦returnï¼Œè€Œå¦‚æœä½ ä¸æ‰“æ ‡ï¼Œä¹Ÿæ˜¯å¯ä»¥é€šè¿‡returnæ¥æ„å»ºviewçš„<ul>
<li>ä½†æ˜¯å°±ä¸æ”¯æŒé»˜è®¤è¿”å›listæˆ–é€šè¿‡if-elseè¿”view listçš„è¯­æ³•äº†</li>
</ul>
</li>
<li><code>@ViewBuilder</code>ä¹Ÿå¯ä»¥æ ‡è¯†ä¸ºæ–¹æ³•çš„å‚æ•°ï¼Œè¡¨ç¤ºéœ€è¦æ¥å—ä¸€ä¸ªè¿”å›viewsçš„å‡½æ•°</li>
</ol>
<div class="highlight"><pre><span></span><span class="kd">init</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="p">[</span><span class="n">Item</span><span class="p">],</span> <span class="p">@</span><span class="n">ViewBuilder</span> <span class="n">content</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="p">(</span><span class="n">Item</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">ItemView</span><span class="p">)</span> <span class="p">{...}</span>
</pre></div>
<p>åŒæ—¶ä¹Ÿæ³¨æ„ä¸€ä¸‹<code>@escaping</code>ï¼Œå‡¡æ˜¯å‡½æ•°è¿”å›åæ‰å¯èƒ½è¢«è°ƒç”¨çš„é—­åŒ…ï¼ˆé€ƒé€¸é—­åŒ…ï¼‰å°±éœ€è¦ï¼Œè€Œæˆ‘ä»¬çš„viewæ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åˆ›å»ºï¼Œæˆ–åå¤ç§»é™¤å¹¶é‡å»ºï¼ˆé‡ç»˜ï¼‰çš„ï¼Œæ˜¾ç„¶ç¬¦åˆé€ƒé€¸é—­åŒ…çš„ç‰¹å¾ã€‚</p><blockquote>
<p>viewbuilderæ”¯æŒçš„æ§åˆ¶æµç¨‹ä»£ç æŒ‡çš„æ˜¯<code>if-else</code>å’Œ<code>ForEach</code>, æ‰€ä»¥<code>for...in...</code>æ˜¯ä¸è¡Œçš„ã€‚</p></blockquote>
<h1>Protocol</h1>
<p>æ¥å£ï¼Œåè®®ï¼Œçº¦æŸ... ä½¿ç”¨åœºæ™¯ï¼š</p><ul>
<li>ç”¨ä½œç±»å‹(Type):<ul>
<li>func travelAround(using moveable: Moveable)</li>
<li>let foo = [Moveable]</li>
</ul>
</li>
<li>ç”¨ä½œæ¥å£:<ul>
<li>struct cardView: View</li>
<li>class myGame: ObservableObject</li>
<li>behaviors: Identifiable, Hashable, ... Animatable</li>
</ul>
</li>
<li>ç”¨ä½œçº¦æŸï¼š
  struct Game<Content> <code>where</code> Content: Equtable   // ç±»
  extension Array <code>where</code> Element: Hashable {...}  // æ‰©å±•
  init(data: Data) <code>where</code> Data: Collection, Data.Element: Identifiable // æ–¹æ³•</li>
<li>OCé‡Œçš„delegate</li>
<li>code sharing (by <code>extension</code>)<ul>
<li><code>extension</code> to a protocol</li>
<li>this is how Views get forecolor, font and all their other modifiers</li>
<li>also `firstIndex(where:) get implemented</li>
<li>an <code>extension</code> can add <em>default implementation</em> for a func or a var<ul>
<li>that's how <code>objectWillChange</code> comes from</li>
</ul>
</li>
<li><code>extension</code>å¯ä»¥ä½œç”¨åˆ°æ‰€æœ‰æœä»åŒä¸€åè®®çš„å¯¹è±¡<ul>
<li>func filter(_ isIncluded: (Element) -&gt; Bool) -&gt; Array<Element></li>
<li>åªä¸º<code>Sequence</code> protocolå†™äº†ä¸€ä»½filterçš„æ‰©å±•ä»£ç ï¼Œä½†èƒ½ä½œç”¨äºArray, Range, String, Dictionary</li>
<li>ç­‰ä¸€åˆ‡conform to the <code>Sequence</code> protocolçš„ç±»</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>SwiftUIçš„<code>View</code> protocoléå¸¸ç®€å•ï¼Œconform ä¸€ä¸ªè¿”å›<code>some view</code>çš„<code>body</code>æ–¹æ³•å°±è¡Œäº†ï¼Œä½†æ˜¯åˆä¸ºå®ƒå†™äº†æ— æ•°<code>extension</code>ï¼Œæ¯”å¦‚<code>foregroundColor</code>, <code>padding</code>, etc. ç¤ºæ„å›¾ï¼š</p><figure  style="flex: 146.20253164556962" ><img width="924" height="316" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/9bfb49031e316c1d1d1bc4a5d6b57427.png" alt=""/></figure><h2>Generics(æ³›å‹)</h2>
<p>ä¸¾ä¾‹ï¼š</p><div class="highlight"><pre><span></span><span class="kd">protocol</span> <span class="nc">Identifiable</span> <span class="p">{</span>
    <span class="kd">associatedtype</span> <span class="n">ID</span><span class="p">:</span> <span class="nb">Hashable</span>
    <span class="kd">var</span> <span class="nv">id</span><span class="p">:</span> <span class="n">ID</span> <span class="p">{</span> <span class="kr">get</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<ol>
<li>ä¸åƒstructï¼Œprotocolå¹¶ä¸æ˜¯ç”¨<code>Identifiable&lt;ID&gt;</code>æ¥è¡¨ç¤ºæ³›å‹ï¼Œè€Œæ˜¯åœ¨ä½œç”¨åŸŸå†…å®šä¹‰</li>
<li>ä¸Šä¾‹ä¸­ï¼ŒIDæ—¢å®šä¹‰äº†ç±»åˆ«åˆ«åï¼Œè¿˜è§„èŒƒäº†çº¦æŸ</li>
</ol>
<ul>
<li>æ‰€ä»¥ä½ Identifiableçš„ç±», æ˜¯éœ€è¦æœ‰ä¸€ä¸ªHashableçš„IDçš„</li>
<li>è€ŒHashableçš„å¯¹è±¡ï¼Œåˆæ˜¯éœ€è¦Equatableçš„(å› ä¸ºhashä¼šç¢°æ’å‡ºç›¸åŒçš„ç»“æœï¼Œéœ€è¦æä¾›æ£€æŸ¥ç›¸ç­‰çš„æ–¹æ³•)</li>
<li>-&gt; <code>protocol inheritancee</code></li>
</ul>
<h1>Shape</h1>
<ul>
<li>Shape is a <code>protocol</code> that inherits from <code>View</code>.</li>
<li>In other words, all Shapes are also Views.</li>
<li>Examples of Shapes already in SwiftUI: RoundedRectangle, Circle, Capsule, etc.</li>
<li>by default, Shapes draw themselfs by <code>filling</code> with the current foreground color.</li>
</ul>
<div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nf">fill</span><span class="p">&lt;</span><span class="n">S</span><span class="p">&gt;(</span><span class="kc">_</span> <span class="n">whatToFillWith</span><span class="p">:</span> <span class="n">S</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">some</span> <span class="n">view</span> <span class="k">where</span> <span class="n">S</span><span class="p">:</span> <span class="n">ShapeStyle</span>
</pre></div>
<p><code>ShapeStyle</code> protocol turns a <code>Shape</code> into a <code>View</code>: Color, ImagePaint, AngularGradinet, LinearGradient</p><p>è‡ªå®šä¹‰shapeæœ€å¥½ç”¨path(ç³»ç»Ÿçš„å·²ç»é€šè¿‡extensionå®ç°å¥½äº†viewçš„body)ï¼š</p><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nf">path</span><span class="p">(</span><span class="k">in</span> <span class="n">rect</span><span class="p">:</span> <span class="n">CGRect</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Path</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">a</span> <span class="n">Path</span> 
<span class="p">}</span>
</pre></div>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/cs193p_2021_%E7%AC%94%E8%AE%B0%5B1%5D/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/%E4%B8%80%E5%BC%A0%E5%9B%BE%E8%AF%B4%E6%B8%85%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95%EF%BC%88Hungarian-Algorithm%EF%BC%89/" target="_self">ä¸€å¼ å›¾è¯´æ¸…åŒˆç‰™åˆ©ç®—æ³•ï¼ˆHungarian-Algorithmï¼‰</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/%E4%B8%80%E5%BC%A0%E5%9B%BE%E8%AF%B4%E6%B8%85%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95%EF%BC%88Hungarian-Algorithm%EF%BC%89/" target="_self">
                <time class="text-uppercase">
                    October 23 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><p>åšå¤šç›®æ ‡è·Ÿè¸ªçš„æ—¶å€™ä¼šç¢°åˆ°è¿™ä¸ªç®—æ³•ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„è¯´æ³•è®²æ¸…æ¥šè¿™ä¸ªç®—æ³•æ˜¯å¹²ä»€ä¹ˆçš„ï¼Ÿæˆ‘çš„è€å¸ˆå°±è·Ÿæˆ‘è¯´è¿‡æ˜¯ä»€ä¹ˆç»™å·¥äººåˆ†é…æ´»å¹²ï¼ˆå³ç†è§£ä¸º<code>æŒ‡æ´¾é—®é¢˜</code>ï¼‰ï¼Œç½‘ä¸Šè¿˜çœ‹åˆ°æœ‰è¯´çº¢å¨˜å°½å¯èƒ½åŒ¹é…å¤šçš„æƒ…ä¾£ç­‰ï¼Œé€è¿‡è¿™äº›æ„Ÿæ€§ç†è§£ï¼ŒåŸºæœ¬ä¸Šå°±èƒ½ç†è§£å¤§æ¦‚æ˜¯æœ€å¤§åŒ¹é…çš„é—®é¢˜äº†ã€‚</p><p>ç„¶ååŠ äº†é™åˆ¶ï¼šåæ¥è€…ä¼˜å…ˆã€‚å³ååŒ¹é…çš„<strong>èƒ½</strong>æŠ¢æ‰å‰äººå·²åŒ¹é…çš„å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯æœ‰æ•°å­¦ä¾æ®è¿˜æ˜¯åªæ˜¯ä¸€ç§å®ç°æ€è·¯æˆ‘å°±æ²¡æ·±ç©¶äº†ã€‚</p><p>æˆ‘çš„ç†è§£ä¸ä¼šæ¯”åˆ«äººæ›´é«˜çº§ï¼Œä¹‹æ‰€ä»¥èƒ½ç”¨ä¸€å¼ å›¾è¯´æ¸…æ¥šï¼Œåªä¸è¿‡æ˜¯æˆ‘ä½œå›¾çš„æ—¶å€™å‘ç°å¯ä»¥æŠŠè¿‡ç¨‹ç”»åœ¨ä¸€å¼ å›¾é‡Œï¼Œåªéœ€è¦æŠŠå›¾ç¤ºæ ‡æ¸…æ¥šå°±å¥½äº†ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯ä¸€æ­¥ç”»ä¸€å¼ å›¾äº†ï¼Œä¸€æ—¦ç†è§£äº†ï¼Œå“ªæ€•å¿˜äº†ï¼Œä¸€ç…è¿™å¼ å›¾ä¹Ÿèƒ½ç«‹åˆ»å›å¿†èµ·æ¥ã€‚</p><p>å…ˆä¸Šæ•°æ®ï¼š</p><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">relationship_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
<p>ä½ å¯ä»¥ç†è§£ä¸º6ä¸ªå·¥äººï¼Œ7ä¸ªå·¥ä½œï¼Œ6ä¸ªç”·å­©ï¼Œ7ä¸ªå¥³å­©ç­‰ï¼Œå½“ç„¶ï¼Œ6è¡Œ7åˆ—ï¼Œè¿™ä¹ˆç›´è§‚ç†è§£ä¹Ÿæ˜¯ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰çš„ã€‚</p><p>ç®—æ³•åŒ¹é…è¿‡ç¨‹å¦‚ä¸‹ï¼š
<figure class="vertical-figure" style="flex: 38.028169014084504" ><img width="648" height="852" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/cf127d2b3fa84eb6c94999802507f38f.png" alt=""/></figure></p><ul>
<li>ç°è“çº¿å°±æ˜¯è¢«æŠ¢æ‰çš„</li>
<li>ç»¿çº¿å°±æ˜¯æŠ¢å¤ºå¤±è´¥çš„</li>
<li><code>ç´«çº¿</code>æ˜¯è¢«æŠ¢äº†åæ‰¾å€™é€‰æˆåŠŸçš„</li>
<li><code>çº¢çº¿</code>æ˜¯ä¸€æ¬¡æ€§æˆåŠŸçš„</li>
</ul>
<p>å…¶ä¸­è¢«æŠ¢çš„å’ŒæŠ¢å¤ºå¤±è´¥çš„è¿˜åŠ äº†åˆ é™¤çº¿ï¼Œè¿™æ˜¯ä¸ºäº†å¼ºè°ƒã€‚åŒ¹é…æˆåŠŸçš„å°±æ˜¯<code>çº¢çº¿</code>å’Œ<code>ç´«çº¿</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åŒ¹é…å‡ºæ¥çš„æ˜¯ï¼š</p><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
<p>ç”šè‡³å¯ä»¥è¿™ä¹ˆè¡¨ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<pre><code>x0,y0
x1,y1
x2,y0 -&gt; x0,y1 -&gt; x1-&gt;y4 (x2æŠ¢x0çš„,x0æŠ¢x1çš„)
x3,y2
x4,y3
x5,y3 -&gt; x4åŒ¹é…ä¸åˆ°æ–°çš„ï¼ŒæŠ¢å¤ºå¤±è´¥ï¼Œ-&gt; x5,null
</code></pre>
<p>æœ‰æ²¡æœ‰è¯´æ¸…æ¥šï¼Ÿå°±ä¸¤æ­¥ï¼š</p><ol>
<li>æ ¹æ®å…³è”è¡¨ç›´æ¥å»ºç«‹å…³ç³»</li>
<li>å¦‚æœå½“å‰<code>C</code>åŒ¹é…çš„å¯¹è±¡å·²ç»è¢«<code>B</code>åŒ¹é…è¿‡äº†ï¼Œé‚£ä¹ˆå°è¯•æŠŠå®ƒæŠ¢è¿‡æ¥ï¼š</li>
</ol>
<ul>
<li><code>B</code>å»æ‰¾åˆ«çš„åŒ¹é…<ul>
<li>æ‰¾åˆ°äº†(<code>A</code>)å°±å»ºç«‹æ–°çš„åŒ¹é…<ul>
<li>å¦‚æœæ–°çš„åŒ¹é…(<code>A</code>)ä¹Ÿå·²ç»è¢«åˆ«äºº(<code>D</code>)åŒ¹é…äº†ï¼Œé‚£ä¹ˆé‚£ä¸ªâ€œåˆ«äºº(<code>D</code>)â€ä¹Ÿæ”¾å¼ƒå½“å‰åŒ¹é…å»æ‰¾åˆ«çš„ï¼ˆ<em>é€’å½’è­¦å‘Š</em>ï¼‰</li>
</ul>
</li>
<li>å¦‚æœæ‰¾ä¸åˆ°æ–°çš„åŒ¹é…ï¼Œé‚£ä¹ˆ<code>C</code>æŠ¢å¤ºå¤±è´¥ï¼Œé€’å½’ä¸­çš„<code>D</code>ä¹ŸåŒç†ï¼Œå¤±è´¥å‘ä¸Šå†’æ³¡</li>
</ul>
</li>
</ul>
<p>æ³¨æ„é€’å½’æ€ä¹ˆå†™ä»£ç å°±èƒ½å†™å‡ºæ¥äº†ï¼š</p><div class="highlight"><pre><span></span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">relationship_matrix</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># 6ä¸ªxï¼Œ7ä¸ªy</span>

<span class="c1"># å¦‚æœx0ä¸y0å…³è”ï¼Œx3ä¹Ÿä¸y0å…³è”ï¼Œé‚£ä¹ˆx0å»æ‰¾æ–°çš„åŒ¹é…æ—¶ï¼Œéœ€è¦æŠŠy0è¿‡æ»¤æ‰</span>
<span class="c1"># åŒç†x0å¦‚æœæ‰¾åˆ°ä¸‹ä¸€ä¸ªy2ï¼Œy2å·²è¢«x2å…³è”ï¼Œé‚£ä¹ˆx2æ‰¾æ–°çš„åŒ¹é…æ—¶[y0, y2]éƒ½éœ€è¦è¿‡æ»¤æ‰</span>
<span class="c1"># æˆ‘ä»¬æŠŠè¿™ä¸ªæ•°ç»„å­˜ä¸ºy_used</span>
<span class="n">y_used</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># å­˜yæ˜¯å¦è¿æ¥ä¸Š</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">ny</span><span class="p">,),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># å­˜xè¿æ¥çš„å¯¹è±¡ï¼Œæ²¡æœ‰ä¸º-1</span>

<span class="k">def</span> <span class="nf">find_other_path_and_used</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">relationship_matrix</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">y_used</span><span class="p">[</span><span class="n">y</span><span class="p">]:</span>
            <span class="n">y_used</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>        <span class="c1"># å¤„äºäº‰å¤ºä¸­çš„yï¼Œéœ€è¦æ‰“æ ‡ï¼Œåœ¨åç»­çš„é€’å½’æ—¶è¦è¿‡æ»¤æ‰</span>
            <span class="k">if</span> <span class="n">path</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">find_other_path_and_used</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="n">y</span><span class="p">]):</span>
                <span class="n">path</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>         <span class="c1"># ç›´æ¥è¿æ¥ å’Œ æŠ¢å¤ºæˆåŠŸ</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>                    <span class="c1"># æŠ¢å¤ºå¤±è´¥ å’Œ é»˜è®¤å¤±è´¥</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
    <span class="n">y_used</span><span class="p">[:]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># empty</span>
    <span class="n">find_other_path_and_used</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
<p>çœŸçš„å†™ä»£ç å®ç°çš„æ—¶å€™ï¼Œéš¾ç‚¹åè€Œæ˜¯<code>y_used</code>è¿™ä¸ªï¼Œç¬¬ä¸€éä»£ç æ²¡è€ƒè™‘è¿™ä¸€ç‚¹ï¼Œå¯¼è‡´é€’å½’çš„æ—¶å€™æ¯æ¬¡éƒ½ä»$y_0$å¼€å§‹è€Œå‡ºç°æ­»å¾ªç¯ï¼Œæ„è¯†åˆ°åæŠŠå¤„äºäº‰æŠ¢çŠ¶æ€ä¸­çš„<code>y</code>æ‰“ä¸ªæ ‡å°±å¥½äº†ã€‚</p><p>scipyä¸­æœ‰ä¸€ä¸ªç®—æ³•å®ç°äº†Hungarian algorithmï¼š</p><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">linear_sum_assignment</span>

<span class="c1"># relationship_matrixæ˜¯ä»£ä»·çŸ©é˜µ</span>
<span class="c1"># æ‰€ä»¥æˆ‘ä»¬è¦ä»£ä»·è¶Šå°è¶Šå¥½ï¼Œå°±ç”¨1æ¥å‡</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">linear_sum_assignment</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">relationship_matrix</span><span class="p">)</span> 
<span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
</pre></div>

<pre><code>[(0, 0), (1, 1), (2, 6), (3, 2), (4, 3), (5, 4)]
</code></pre>
<p>ä¸ºä»€ä¹ˆä¸ä¸Šé¢ä¸ä¸€æ ·å‘¢ï¼Ÿ</p><ol>
<li>ï¼ˆ0ï¼Œ0ï¼‰ï¼Œï¼ˆ1ï¼Œ1ï¼‰çš„åŒ¹é…æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬å®ç°çš„åæ¥è€…ä¼˜å…ˆ</li>
<li>ä»–æŠŠè¡Œçœ‹æˆæ˜¯å·¥äººï¼Œåˆ—çœ‹æˆæ˜¯ä»»åŠ¡ï¼Œæ¯ä¸ªå·¥äººæ€»è¦åˆ†é…ä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥(5,4)è¿™ç§ä»£ä»·çŸ©é˜µé‡Œæ²¡æœ‰çš„å…³è”å®ƒä¹Ÿåšå‡ºæ¥äº†ï¼Œç›®çš„åªæ˜¯è®©â€œæ€»ä»£ä»·â€æœ€å°</li>
</ol>

<pre><code>(1-relationship_matrix)[rows, cols]  # æ€»ä»£ä»·ä¸º1
</code></pre>

<pre><code>array([0, 0, 0, 0, 0, 1])
</code></pre>
<p>ä»å®ƒçš„åå­—ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œå®ƒæ˜¯ç†è§£ä¸º<code>æŒ‡æ´¾é—®é¢˜</code>çš„(<code>assignment</code>)</p></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/%E4%B8%80%E5%BC%A0%E5%9B%BE%E8%AF%B4%E6%B8%85%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95%EF%BC%88Hungarian-Algorithm%EF%BC%89/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-4/" target="_self">æå®æ¯…MACHINE LEARNING 2021 SPRINGç¬”è®°[4]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-4/" target="_self">
                <time class="text-uppercase">
                    October 14 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><h1>Adversarial Attack</h1>
<p>ç»™ä½ ä¸€å¼ çŒ«çš„å›¾ç‰‡ï¼Œé‡Œé¢åŠ å…¥å°‘è®¸å™ªéŸ³ï¼Œä»¥ä¿è¯è‚‰çœ¼çœ‹ä¸å‡ºæ¥æœ‰å™ªéŸ³çš„å­˜åœ¨ï¼š</p><ol>
<li>æœŸæœ›åˆ†ç±»å™¨è®¤ä¸ºå®ƒä¸æ˜¯çŒ«</li>
<li>æœŸæœ›åˆ†ç±»å™¨è®¤ä¸ºå®ƒæ˜¯ä¸€æ¡é±¼ï¼Œä¸€ä¸ªé”®ç›˜...</li>
</ol>
<p>æ¯”å¦‚ä½ æƒ³è¦æ¬ºéª—åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨</p><ul>
<li>æ‰¾åˆ°ä¸€ä¸ªä¸$x^0$éå¸¸è¿‘çš„å‘é‡x</li>
<li>ç½‘ç»œæ­£å¸¸è¾“å‡ºy</li>
<li>çœŸå€¼ä¸º$\hat y$</li>
<li>$L(x) = -e(y, \hat y)$</li>
<li>$x^* = arg\underset{d(x^0, x) \leq \epsilon}{\rm min}\ L(x)$ å³è¦æ‰¾åˆ°ä»¤æŸå¤±æœ€å¤§çš„x<ol>
<li>è¿™é‡ŒL(x)æˆ‘ä»¬å–äº†å</li>
<li>$\epsilon$è¶Šå°è¶Šå¥½ï¼ŒæŒ‡çš„æ˜¯$x^0$è¦ä¸xè¶Šæ¥è¿‘è¶Šå¥½ï¼ˆæ¬ºéª—äººçœ¼ï¼‰</li>
</ol>
</li>
<li>å¦‚æœè¿˜æœŸæœ›å®ƒè®¤æˆæ˜¯$y^{target}$ï¼Œé‚£å°±å†åŠ ä¸Šä¸å…¶çš„çš„æŸå¤±</li>
<li>$L(x) = -e(y, \hat y) + e(y, y^{target})$</li>
<li>æ³¨æ„ä¸¤ä¸ªerroræ˜¯åçš„ï¼Œä¸€ä¸ªè¦æ±‚è¶Šè¿œè¶Šå¥½(çœŸå€¼ï¼‰ï¼Œä¸€ä¸ªè¦æ±‚è¶Šè¿‘è¶Šå¥½ï¼ˆtarget)</li>
</ul>
<p>æ€ä¹ˆè®¡ç®—$d(x^0, x) \leq \epsilon$å‘¢ï¼Ÿ</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/52ea0aa0520c35787d94019e0efc61a7.png" alt=""/></figure><p>å›¾ä¸Šå¯çŸ¥ï¼Œå¦‚æœéƒ½æ”¹å˜ä¸€ç‚¹ç‚¹ï¼Œå’ŒæŸä¸€ä¸ªåŒºåŸŸæ”¹åŠ¨ç›¸å½“å¤§ï¼Œå¯èƒ½åœ¨L2-normçš„æ–¹å¼è®¡ç®—å‡ºæ¥æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åœ¨L-infinityçœ‹æ¥æ˜¯ä¸ä¸€æ ·çš„ï¼ˆå®ƒåªå…³å¿ƒæœ€å¤§çš„å˜åŠ¨ï¼‰ã€‚</p><p>æ˜¾ç„¶L-infinityæ›´é€‚åˆäººçœ¼çš„é€»è¾‘ï¼Œå…¨éƒ¨ä¸€èµ·å¾®è°ƒäººçœ¼ä¸èƒ½å¯Ÿè§‰ï¼Œå•å•æŸä¸€å—å¤§è°ƒï¼Œäººçœ¼æ˜¯è‚¯å®šå¯ä»¥çœ‹å‡ºæ¥çš„ã€‚</p><p>è€Œå¦‚æœæ˜¯è¯­éŸ³çš„è¯ï¼Œå¯èƒ½è€³æœµå¯¹çªç„¶æŸä¸ªå£°éŸ³çš„å˜åŒ–åè€Œä¸æ•æ„Ÿï¼Œæ•´ä½“è¯­éŸ³é£æ ¼å˜äº†å´èƒ½ç«‹åˆ»è®¤å‡ºè¯´è¯çš„äººå£°éŸ³å˜äº†ï¼Œè¿™å°±è¦æ”¹å˜æ–¹æ¡ˆäº†ã€‚</p><h2>Attack Approach</h2>
<p>å¦‚ä½•å¾—åˆ°è¿™ä¸ªxå‘¢ï¼Ÿå…¶å®å°±æ˜¯ä¸Šé¢çš„æŸå¤±å‡½æ•°ã€‚ä»¥å‰æˆ‘ä»¬æ˜¯ä¸ºäº†trainæƒé‡ï¼Œç°åœ¨trainçš„å°±æ˜¯xæœ¬èº«äº†ã€‚</p><ol>
<li>æŸå¤±è¾¾åˆ°æˆ‘ä»¬çš„è¦æ±‚ ï¼ˆæœ‰å¯èƒ½è¿™æ—¶å€™ä¸åŸxç›¸å…³å¾ˆè¿œï¼‰</li>
<li>ä¸åŸxçš„è·ç¦»è¾¾åˆ°æˆ‘ä»¬çš„è¦æ±‚, æ€ä¹ˆåšï¼Ÿ<ul>
<li>å…¶å®å°±æ˜¯ä»¥$x^0$ä¸ºä¸­å¿ƒï¼Œè¾¹é•¿ä¸º$2\epsilon$çš„çŸ©å½¢æ‰æ˜¯æœŸæœ›åŒºåŸŸ</li>
<li>å¦‚æœupdateåï¼Œ$x^t$ä»ç„¶è½åœ¨çŸ©å½¢å¤–ï¼Œé‚£ä¹ˆå°±åœ¨çŸ©å½¢é‡Œæ‰¾ä¸€ä¸ªç¦»å®ƒæœ€è¿‘çš„ç‚¹ï¼Œå½“ä½œæœ¬è½®æ›´æ–°åçš„$x^t$ï¼Œè¿›å…¥ä¸‹ä¸€è½®è¿­ä»£</li>
</ul>
</li>
</ol>
<p>Fast Gradient Sign Method(FGSM): <a href="https://arxiv.org/abs/1412.6572">https://arxiv.org/abs/1412.6572</a></p><ul>
<li>ç›¸æ¯”ä¸Šé¢çš„è¿­ä»£æ–¹æ³•ï¼ŒFGSMåªåšä¸€æ¬¡æ›´æ–°</li>
<li>å°±æ˜¯æ ¹æ®æ¢¯åº¦ï¼Œåˆ¤æ–­æ˜¯æ­£è¿˜æ˜¯è´Ÿï¼Œç„¶åæŠŠåŸxè¿›è¡Œä¸€æ¬¡åŠ å‡$\epsilon$çš„æ“ä½œï¼ˆå…¶å®ç­‰äºæ˜¯è½åœ¨äº†çŸ©å½¢çš„å››ä¸ªç‚¹ä¸Šï¼‰</li>
<li>ä¹Ÿå°±æ˜¯è¯´å®ƒç›´æ¥å–äº†å››ä¸ªç‚¹ä¹‹ä¸€ä½œä¸º$x^0$</li>
</ul>
<h2>White Box v.s. Black Box</h2>
<p>è®²ä¸Šè¿°æ–¹æ³•çš„æ—¶å€™è‚¯å®šéƒ½åœ¨ç–‘æƒ‘ï¼Œåˆ†ç±»å™¨æ˜¯åˆ«äººçš„ï¼Œæˆ‘æ€ä¹ˆå¯èƒ½æ‹¿åˆ°åˆ«äººçš„æ¨¡å‹æ¥è®­ç»ƒæˆ‘çš„æ”»å‡»å™¨ï¼Ÿ -&gt; <strong>White Box Attack</strong></p><p>é‚£ä¹ˆ<code>Black Box Attack</code>æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p><ol>
<li>å¦‚æœæˆ‘ä»¬çŸ¥é“å¯¹æ–¹çš„æ¨¡å‹æ˜¯ç”¨ä»€ä¹ˆæ•°æ®è®­ç»ƒçš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®­ç»ƒä¸€ä¸ªç±»ä¼¼çš„(proxy network)<ul>
<li>å¾ˆå¤§æ¦‚ç‡éƒ½æ˜¯ç”¨å…¬å¼€æ•°æ®é›†è®­ç»ƒçš„</li>
</ul>
</li>
<li>å¦‚æœä¸çŸ¥é“çš„è¯å‘¢ï¼Ÿå°±åªèƒ½å°è¯•åœ°ä¸¢ä¸€äº›æ•°æ®è¿›å»ï¼Œè§‚å¯Ÿï¼ˆè®°å½•ï¼‰å®ƒçš„è¾“å‡ºï¼Œç„¶åå†ç”¨è¿™äº›æµ‹è¯•çš„è¾“å…¥è¾“å‡ºæ¥è®­ç»ƒè‡ªå·±çš„proxy networkäº†ã€‚</li>
</ol>
<ul>
<li>one pixel attack<ul>
<li><a href="https://arxiv.org/abs/1710.08864">https://arxiv.org/abs/1710.08864</a></li>
<li><a href="https://youtu.be/tfpKIZIWidA">https://youtu.be/tfpKIZIWidA</a></li>
</ul>
</li>
<li>universal adversarial attack<ul>
<li>ä¸‡èƒ½noise</li>
<li><a href="https://arxiv.org/abs/1610.08401">https://arxiv.org/abs/1610.08401</a></li>
</ul>
</li>
<li>å£°éŸ³</li>
<li>æ–‡æœ¬</li>
<li>ç‰©ç†ä¸–ç•Œ<ul>
<li>æ¯”å¦‚æ¬ºéª—äººè„¸è¯†åˆ«ç³»ç»Ÿï¼Œå»è®¤æˆå¦ä¸€ä¸ªäºº</li>
<li>åˆæ¯”å¦‚é“è·¯ç¯å¢ƒï¼Œè½¦ç‰Œè¯†åˆ«ç­‰ï¼Œä¹Ÿå¯ä»¥è¢«æ”»å‡»</li>
<li>è¦è€ƒè™‘æ‘„åƒå¤´èƒ½è¯†åˆ«çš„åˆ†è¾¨ç‡</li>
<li>è¦è€ƒè™‘è®­ç»ƒæ—¶å€™ç”¨çš„å›¾ç‰‡é¢œè‰²ä¸çœŸå®ä¸–ç•Œé¢œè‰²ä¸ä¸€è‡´çš„é—®é¢˜</li>
</ul>
</li>
<li>Adversarial Reprogramming</li>
<li>Backdoor in Model<ul>
<li>attack happens at the training phase</li>
<li><a href="https://arxiv.org/abs/1804.00792">https://arxiv.org/abs/1804.00792</a></li>
<li>be careful of unknown dataset...</li>
</ul>
</li>
</ul>
<h2>Defence</h2>
<h3>Passive Defenseï¼ˆè¢«åŠ¨é˜²å¾¡ï¼‰</h3>
<p>è¿›å…¥networkå‰åŠ ä¸€å±‚filter</p><ul>
<li>ç¨å¾®æ¨¡ç³ŠåŒ–ä¸€ç‚¹ï¼Œå°±å»é™¤æ‰ç²¾å¿ƒè®¾è®¡çš„noiseäº†<ul>
<li>ä½†æ˜¯åŒæ—¶ä¹Ÿå½±å“äº†æ­£å¸¸çš„å›¾åƒ</li>
</ul>
</li>
<li>å¯¹åŸå›¾è¿›è¡Œå‹ç¼©</li>
<li>æŠŠè¾“å…¥ç”¨Generatoré‡æ–°ç”Ÿæˆä¸€é</li>
</ul>
<p>å¦‚æœæ”»å‡»éƒ½çŸ¥é“ä½ æ€ä¹ˆåšäº†ï¼Œå…¶å®å¾ˆå¥½ç ´è§£ï¼Œå°±æŠŠä½ çš„filterå½“ä½œnetworkçš„ä¸€éƒ¨åˆ†é‡æ–°å¼€å§‹è®¾è®¡noiseï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©åŠ å…¥éšæœºé€‰æ‹©çš„ä¸€äº›é¢„å¤„ç†(è®©æ”»å‡»è€…ä¸å¯èƒ½é’ˆå¯¹æ€§åœ°è®­ç»ƒ)ï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/c5baa988904325835254f3ac7a7ee4e1.png" alt=""/></figure><h3>Proactive Defenseï¼ˆä¸»åŠ¨é˜²å¾¡ï¼‰</h3>
<p>è®­ç»ƒçš„æ—¶å€™å°±è®­ç»ƒæ¯”è¾ƒä¸å®¹æ˜“è¢«æ”»ç ´çš„æ¨¡å‹ã€‚æ¯”å¦‚è®­ç»ƒè¿‡ç¨‹ä¸­åŠ å…¥noiseï¼ŒæŠŠç”Ÿæˆçš„ç»“æœé‡æ–°æ ‡æ³¨å›çœŸå€¼ã€‚</p><ul>
<li>training model</li>
<li>find the problem</li>
<li>fix it</li>
</ul>
<p>æœ‰ç‚¹ç±»ä¼¼äº<code>Data Augmentation</code></p><p>ä»ç„¶é˜»æŒ¡ä¸äº†æ–°çš„æ”»å‡»ç®—æ³•ï¼Œå³ä½ å¯¹æ•°æ®è¿›è¡Œaugmentä¹‹å¤–çš„èŒƒå›´ã€‚</p><h1>Explainable Machine Learning(å¯è§£é‡Šæ€§)</h1>
<ul>
<li>correct answers $\neq$ intelligent</li>
<li>å¾ˆå¤šè¡Œä¸šä¼šè¦æ±‚ç»“æœå¿…é¡»å¯è§£é‡Š<ul>
<li>é“¶è¡Œï¼ŒåŒ»è¯ï¼Œæ³•å¾‹ï¼Œé©¾é©¶....</li>
</ul>
</li>
</ul>
<p><strong>Local Explanation</strong></p><p>Why do you thing <strong>this image</strong> is a cat?</p><p><strong>Global Explanation</strong></p><p>What does a &quot;<strong>cat</strong>&quot; look like?</p><ol>
<li>é®æŒ¡æˆ–æ”¹å˜è¾“å…¥çš„æŸäº›éƒ¨åˆ†ï¼Œè§‚å¯Ÿå¯¹å·²çŸ¥è¾“å‡ºçš„å½±å“<ul>
<li>ï¼ˆæ¯”å¦‚æ‹¦åˆ°æŸäº›éƒ¨åˆ†ç¡®å®è®¤ä¸å‡ºå›¾åƒæ˜¯ä¸€æ¡ç‹—äº†ï¼‰</li>
</ul>
</li>
<li>é®æŒ¡æˆ–æ”¹å˜è¾“å…¥çš„æŸäº›éƒ¨åˆ†ï¼ŒæŠŠä¸¤ç§è¾“å‡ºåšlossï¼Œå¯¹æ¯”è¾“å…¥å˜åŒ–ä¸losså˜åŒ–ï¼š<ul>
<li>$|\frac{\varDelta e}{\varDelta x}| \rightarrow \frac{\partial e}{\partial x_n}$</li>
</ul>
</li>
</ol>
<p>æŠŠä¸Šè¿°ï¼ˆä»»ä¸€ç§ï¼‰æ¯ä¸ªéƒ¨åˆ†ï¼ˆåƒç´ ï¼Œå•è¯ï¼‰çš„å½±å“ç»“æœè¾“å‡ºï¼Œå°±æ˜¯ï¼š<code>Saliency Map</code></p><h2>Saliency Map</h2>
<figure  style="flex: 271.9298245614035" ><img width="1240" height="228" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/fdcce76fc7337b0ee787724913f998f0.png" alt=""/></figure><p>å›¾1ï¼Œ2å°±æ˜¯ä¸ºäº†åˆ†è¾¨å®å¯æ¢¦å’Œæ•°ç å®è´ï¼Œäººç±»ä¸€èˆ¬å¾ˆéš¾åŒºåˆ†å‡ºæ¥ï¼Œä½†æœºå™¨å±…ç„¶è½»æ¾è¾¾åˆ°äº†98%çš„å‡†ç¡®ç‡ï¼Œç»è¿‡ç»˜åˆ¶<code>Saliency Map</code>ï¼Œå‘ç°å±…ç„¶å°±æ˜¯å›¾ç‰‡ç´ æï¼ˆæ ¼å¼ï¼‰çš„åŸå› ï¼Œä¸€ä¸ªæ˜¯pngï¼Œä¸€ä¸ªæ˜¯jpgï¼Œé€ æˆèƒŒæ™¯ä¸€ä¸ªæ˜¯é€æ˜ä¸€ä¸ªæ˜¯ä¸é€æ˜çš„ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œèƒ½å‘ç°æœºå™¨åˆ¤æ–­çš„ä¾æ®ä¸æ˜¯æˆ‘ä»¬å…³æ³¨çš„æœ¬ä½“ï¼ˆé«˜äº®éƒ¨åˆ†å°±æ˜¯å½±å“æœ€å¤§çš„éƒ¨åˆ†ï¼ŒæœŸæœ›æ˜¯åœ¨åŠ¨ç‰©èº«ä¸Šï¼‰</p><p>ç¬¬ä¸‰å¼ å›¾æ›´å¯ç¬‘ï¼Œæœºå™¨æ˜¯å¦‚ä½•åˆ¤æ–­è¿™æ˜¯ä¸€åªé©¬çš„ï¼Ÿå±…ç„¶ä¹Ÿä¸æ˜¯é©¬çš„æœ¬ä½“ï¼Œè€Œæ˜¯å·¦ä¸‹è§’ï¼Œæ ‡è¯†å›¾ç‰‡å‡ºå¤„çš„æ–‡å­—ï¼Œå¯èƒ½æ˜¯è®­ç»ƒè¿‡ç¨‹ä¸­åŒæ ·çš„logoè¿‡å¤šï¼Œé€ æˆäº†è¿™ä¸ªâ€œäººä¸ºç‰¹å¾â€ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><h3>Smooth Gradient</h3>
<p>éšæœºç»™è¾“å…¥å›¾ç‰‡åŠ å…¥å™ªç‚¹ï¼Œå¾—åˆ°saliency mapï¼ˆä»¬ï¼‰ï¼Œç„¶åå–å¹³å‡</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/e672962530cdb4c88d616b3fa82f73f8.png" alt=""/></figure><h3>Integrated gradient(IG)</h3>
<p>ä¸€ä¸ªç‰¹å¾åœ¨ä»æ— åˆ°æœ‰çš„é˜¶æ®µï¼Œæ¢¯åº¦è¿˜æ˜¯æ˜æ˜¾çš„ï¼Œä½†æ˜¯åˆ°äº†ä¸€å®šç¨‹åº¦ï¼Œç‰¹å¾å†å¢å¼ºï¼Œå¯¹gradientå½±å“ä¹Ÿä¸å¤§äº†ï¼Œæ¯”å¦‚ä»ç‰‡å­æ¥åˆ¤æ–­å¤§è±¡ï¼Œåˆ°äº†ä¸€å®šé•¿åº¦ï¼Œä¸€å¼ å›¾ä¹Ÿä¸ä¼šâ€œæ›´åƒå¤§è±¡â€</p><p>ä¸€ç§æ€è·¯ï¼š<a href="https://arxiv.org/abs/1611.02639">https://arxiv.org/abs/1611.02639</a></p><h2>global explaination</h2>
<p><strong>What does a filter detect?</strong></p><p>å¦‚æœç»è¿‡æŸå±‚ï¼ˆè®­ç»ƒå¥½çš„ï¼‰filterï¼Œå¾—åˆ°çš„feature mapä¸€äº›ä½ç½®çš„å€¼ç‰¹åˆ«å¤§ï¼Œé‚£è¯´æ˜è¿™ä¸ªfilteræå–çš„å°±æ˜¯è¿™ç±»ç‰¹å¾/pattenã€‚</p><p>æˆ‘ä»¬å»&quot;åˆ›é€ &quot;ä¸€å¼ åŒ…å«äº†è¿™ç§pattençš„å›¾ç‰‡ï¼š$X^* = arg\ \underset{X}{\rm max}\sum_i\sum_j a_{ij}$ï¼Œå³è¿™ä¸ªå›¾ç‰‡æ˜¯â€œè®­ç»ƒ/learnâ€œå‡ºæ¥çš„ï¼Œé€šè¿‡æ‰¾è®©Xçš„æ¯ä¸ªå…ƒç´ ($a_{ij}$)åœ¨è¢«filterä¹˜åŠ åç»“æœæœ€å¤§çš„æ–¹å¼ã€‚ -&gt; <code>gradient ascent</code></p><p>ç„¶åå†å»è§‚å¯Ÿ$X^*$æœ‰ä»€ä¹ˆç‰¹å¾ï¼Œå°±åŸºæœ¬ä¸Šå¯ä»¥è®¤å®šè¿™ä¸ªï¼ˆè®­ç»ƒå¥½çš„ï¼‰filteræå–çš„æ˜¯ä»€ä¹ˆæ ·çš„pattenäº†ã€‚
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/33b78193d5c74e4d146b9efab631c932.png" alt=""/></figure></p><blockquote>
<p><code>adversarial attack</code> ç±»ä¼¼çš„åŸç†ï¼Œä½†è¿™æ˜¯å¯¹å•filterè€Œè¨€ã€‚å¦‚æœä½ æƒ³ç”¨åŒæ ·çš„æ€è·¯å»è®©è¾“å‡ºyè¶Šå¤§è¶Šå¥½ï¼Œå¾—åˆ°Xï¼Œçœ‹Xæ˜¯ä»€ä¹ˆï¼Œå¾—åˆ°çš„Xå¤§æ¦‚ç‡éƒ½æ˜¯ä¸€å †å™ªéŸ³ã€‚å¦‚æœèƒ½ç”Ÿæˆå›¾åƒï¼Œé‚£æ˜¯<code>GAN</code>çš„èŒƒç•´äº†ã€‚</p></blockquote>
<p>äºæ˜¯ï¼Œå°è¯•å†åŠ ä¸€ä¸ªé™åˆ¶ï¼Œå³ä¸ä½†è¦è®©yæœ€å¤§ï¼Œè¿˜è¦è®©Xçœ‹èµ·æ¥æœ€æœ‰å¯èƒ½åƒä¸€ä¸ªæ•°å­—ï¼š</p><ul>
<li>$R(X)$: how likely X is a digit</li>
<li>$X^* = arg\ \underset{X}{\rm max}y_i + \color{red}{R(X)}$</li>
<li>$R(X) = -\sum_{i,j}|X_{i,j}|$ æ¯”å¦‚è¿™ä¸ªè§„åˆ™ï¼ŒæœŸæœ›æ¯ä¸ªåƒç´ è¶Šé»‘è¶Šå¥½</li>
</ul>
<h1>Domain Adaptation</h1>
<p><code>Transfer Learning</code>çš„ä¸€ç§ï¼Œåœ¨è®­ç»ƒæ•°æ®é›†å’Œå®é™…ä½¿ç”¨çš„æ•°æ®é›†ä¸ä¸€æ ·çš„æ—¶å€™ã€‚ <a href="https://youtu.be/qD6iD4TFsdQ">https://youtu.be/qD6iD4TFsdQ</a></p><p>éœ€è¦ä½ å¯¹<code>target domain</code>çš„æ•°æ®é›†æœ‰ä¸€å®šçš„äº†è§£ã€‚</p><p>æœ‰ä¸€ç§æ¯”è¾ƒå¥½çš„æƒ…å†µå°±æ˜¯ï¼Œtarget domainæ—¢æœ‰æ•°æ®ï¼Œè¿˜æœ‰æ ‡æ³¨ï¼ˆä½†ä¸æ˜¯å¤ªå¤šï¼Œå¦‚æœå¤ªå¤šçš„è¯å°±ä¸éœ€è¦<code>source domain</code>äº†ï¼Œç›´æ¥ç”¨targetæ¥è®­ç»ƒå°±å¥½äº†ï¼‰ï¼Œé‚£å°±åƒbertä¸€æ ·ï¼Œå»<code>fine tune</code>ç»“æœï¼Œè¦æ³¨æ„çš„æ˜¯æ ‡æœ¬é‡è¿‡å°ï¼Œå¯èƒ½å¾ˆå®¹æ˜“<code>overfitting</code>.</p><p>å¦‚æœtarget doaminæœ‰<strong>å¤§é‡</strong>èµ„æ–™ï¼Œä½†æ˜¯æ²¡æœ‰æ ‡æ³¨å‘¢ï¼Ÿ</p><h2>Domain Adversarial Training</h2>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/7b419953f55daf61a0a4d3f2e77b156d.png" alt=""/></figure><ul>
<li>æŠŠsource domainçš„networkåˆ†ä¸ºç‰¹å¾æå–å™¨ï¼ˆå–å¤šå°‘å±‚cnnå¯ä»¥è§†ä¸ºè¶…å‚ï¼Œå¹¶ä¸ä¸€å®šè¦å–æ‰€æœ‰å±‚cnnï¼‰å’Œåˆ†ç±»å™¨</li>
<li>ç„¶ååœ¨ç‰¹å¾å–å±‚ä¹‹åè·Ÿå¦ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œç”¨æ¥åˆ¤æ–­å›¾åƒæ¥è‡ªäºsourceè¿˜æ˜¯targetï¼ˆæœ‰ç‚¹åƒ<code>Discriminator</code></li>
<li>ä¸çœŸå€¼æœ‰ä¸€ä¸ªlossï¼Œsource, targetä¹‹é—´ä¹Ÿæœ‰ä¸€ä¸ªlossï¼Œè¦æ±‚æ‰¾åˆ°è¿™æ ·çš„å‚æ•°ç»„åˆ†åˆ«è®©ä¸¤ä¸ªlossæœ€å°</li>
<li>looså’Œä¹Ÿåº”è¯¥æœ€å°ï¼ˆå›¾ä¸­ç”¨çš„æ˜¯å‡ï¼Œä½†å…¶å®$L_d$çš„æœŸæœ›æ˜¯è¶‹è¿‘äº0ï¼Œä¸ç®¡æ˜¯æ­£è¿˜æ˜¯è´Ÿéƒ½æ˜¯æœŸæœ›è¶Šå°è¶Šå¥½ï¼‰ï¼ˆä¸å¦‚åŠ ä¸ªç»å¯¹å€¼ï¼Ÿï¼‰</li>
<li>æ¯ä¸€å°å—éƒ½æœ‰ä¸€ç»„å‚æ•°ï¼Œæ˜¯ä¸€èµ·è®­ç»ƒçš„</li>
<li>ç›®çš„å°±æ˜¯æ—¢è¦é€¼è¿‘è®­ç»ƒé›†çš„çœŸå€¼ï¼Œè¿˜è¦è®­ç»ƒå‡ºä¸€ä¸ªç½‘ç»œèƒ½æ¨¡ç³Šæ‰sourceå’Œtargetæ•°æ®é›†çš„å·®åˆ«</li>
</ul>
<h3>Limit</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/1c785d92413a44f14ca579564bd3a107.png" alt=""/></figure><p>å¦‚æœtargetæ•°æ®é›†å¦‚ä¸Šå›¾å·¦ï¼Œæ˜¾ç„¶ç»“æœæ˜¯ä¼šæ¯”ä¸Šå›¾å³è¦å·®ä¸€ç‚¹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å°½é‡è¦ä¿æŒåŒåˆ†å¸ƒã€‚åœ¨è¿™é‡Œç”¨äº†å¦ä¸€ä¸ªè§’åº¦ï¼Œå°±æ˜¯è®©æ•°æ®<strong>ç¦»boundaryè¶Šè¿œè¶Šå¥½</strong></p><ul>
<li>Decision-boundary Iterative Refinement Training with a Teacher(<code>DIRT-T</code>)<ul>
<li><a href="https://arxiv.org/abs/1802.08735">https://arxiv.org/abs/1802.08735</a></li>
</ul>
</li>
<li>Maximum Classifier Discrepancy <a href="https://arxiv.org/abs/1712.02560">https://arxiv.org/abs/1712.02560</a></li>
</ul>
<h2>More</h2>
<ul>
<li>å¦‚æœsource å’Œ target é‡Œçš„ç±»åˆ«ä¸å®Œå…¨ä¸€æ ·å‘¢ï¼Ÿ<ul>
<li>Universal domain adaptation</li>
</ul>
</li>
<li>å¦‚æœtargetæ—¢æ²¡æœ‰labelï¼Œæ•°æ®é‡ä¹Ÿéå¸¸å°‘ï¼ˆæ¯”å¦‚å°±ä¸€å¼ ï¼‰å‘¢ï¼Ÿ<ul>
<li>Test Time Training(TTT) <a href="https://arxiv.org/abs/1909.13231">https://arxiv.org/abs/1909.13231</a></li>
</ul>
</li>
</ul>
<p><strong>Domain Generalization</strong>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/029818e3d225d57c9b9a866b569983b5.png" alt=""/></figure></p><h1>Deep Reinforcement Learning (RL)</h1>
<ul>
<li><strong>Environment</strong> ç»™ä½  <code>Observation</code></li>
<li><strong>Actor</strong> æ¥æ”¶å…¥ <code>Observation</code>, è¾“å‡º <code>Action</code></li>
<li><code>Action</code> åé¦ˆç»™ <strong>Environment</strong>, è®¡ç®—å‡º <code>Reward</code> åé¦ˆç»™ <strong>Actor</strong></li>
<li>è¦æ±‚ <code>Reward</code> æœ€å¤§</li>
</ul>
<p>ä¸ GAN çš„ä¸åŒä¹‹å¤„ï¼Œä¸ç®¡æ˜¯ç”Ÿæˆå™¨è¿˜æ˜¯åˆ¤åˆ«å™¨ï¼Œéƒ½æ˜¯ä¸€ä¸ªnetworkï¼Œè€ŒRLé‡Œé¢ï¼ŒActorå’ŒRewardéƒ½æ˜¯é»‘ç›’å­ï¼Œä½ åªèƒ½çœ‹åˆ°ç»“æœã€‚</p><h2>Policy Gradient</h2>
<p><a href="https://youtu.be/W8XF3ME8G2I">https://youtu.be/W8XF3ME8G2I</a></p><ol>
<li>å…ˆæ˜¯ç”¨å¾ˆç±»ä¼¼ç›‘ç£å­¦ä¹ çš„æ€è·¯ï¼Œç»™æ¯ä¸€æ­¥çš„æœ€ä¼˜ï¼ˆæˆ–æœ€å·®ï¼‰æ–¹æ¡ˆä¸€ä¸ªlabelï¼Œæœ‰labelå°±èƒ½åšlossã€‚å…ˆæŠŠå®ƒå˜æˆä¸€ä¸ªäºŒåˆ†ç±»çš„é—®é¢˜ã€‚</li>
<li>æ‰“åˆ†è¿˜å¯ä»¥ä¸ä»…ä»…æ˜¯â€œå¥½â€æˆ–â€œä¸å¥½â€ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªç¨‹åº¦ï¼Œæ¯”å¦‚1.5æ¯”0.5çš„â€œæ”¯æŒâ€åŠ›åº¦è¦å¤§ä¸€äº›ï¼Œè€Œ-10æ˜¾ç„¶æ„å‘³ç€ä½ åƒä¸‡ä¸è¦è¿™ä¹ˆåšï¼Œéå¸¸æ‹’ç»ã€‚</li>
<li>æ¯”å¦‚æŸä¸€æ­¥ï¼Œå¯ä»¥æœ‰ä¸‰ç§èµ°æ³•ï¼Œå¯ä»¥ç”¨onehotæ¥è¡¨ç¤ºï¼Œå…¶ä¸­ä¸€ç§èµ°æ³•å¯ä»¥æ˜¯[1,0,0]$^T$ï¼Œè¡¨ç¤ºæœŸæœ›çš„èµ°æ³•æ˜¯ç¬¬ä¸€ç§ã€‚</li>
<li>ä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯[-1,0,0]$^T$ï¼Œæ ‡è¯†è¿™ç§èµ°æ³•æ˜¯ä¸å»ºè®®çš„</li>
<li>ä¹Ÿå¯ä»¥æ˜¯[3.5,0,0]$^T$ç­‰</li>
<li>åé¢ä¼šç”¨<code>1, -1, 10, 3.5</code>è¿™æ ·çš„scalaræ¥è¡¨ç¤ºï¼Œä½†è¦è®°ä½å…¶å®å®ƒä»¬æ˜¯ont-hotä¸­çš„é‚£ä¸ªéé›¶æ•°ã€‚</li>
</ol>
<p>ç°å®ä¸–ç•Œä¸­å¾ˆå¤šåœºæ™¯ä¸å¯èƒ½æ‰§è¡Œå®Œä¸€æ­¥åå°±è·å¾—rewardï¼Œæˆ–è€…æ˜¯å…¨å±€æœ€ä½³çš„rewardï¼ˆæ¯”å¦‚ä¸‹å›´æ£‹ï¼‰ã€‚</p><p><strong>v1</strong></p><p>ä¸€ç§æ€è·¯æ˜¯ï¼Œæ¯ä¸€æ­¥ä¹‹åï¼ŒæŠŠæ¸¸æˆ/æ£‹å±€è¿›è¡Œå®Œï¼ŒæŠŠå½“å‰rewardå’Œåç»­æ‰€æœ‰æ­¥éª¤çš„rewardåŠ ä¸€èµ·åšreward -&gt; <code>cumulated reward</code> $\rightarrow G_t = \sum_{n=t}^Nr_n$</p><p><strong>v2</strong></p><p>è¿™ç§æ€è·¯ä»ç„¶æœ‰é—®é¢˜ï¼Œæ¸¸æˆæ­¥éª¤è¶Šé•¿ï¼Œå½“å‰æ­¥å¯¹æœ€ç»ˆæ­¥çš„å½±å“è¶Šå°ã€‚å› æ­¤å¼•å…¥ä¸€ä¸ªå°äº1çš„æƒé‡$\gamma &lt; 1$: $G_1' = r_1 + \gamma r_2 + \gamma^2r_3 + \cdots$</p><p>è¿™æ ·è¶Šè¿œçš„æƒé‡è¶Šå°ï¼š $G_t' = \sum_{n=t}^N \color{red}{\gamma^{n-t}} r_n$</p><blockquote>
<p>æ³¨æ„ï¼Œç›®å‰å¾—åˆ°çš„<code>G</code>å°±æ˜¯ä¸ºäº†ç»™æ¯ä¸€æ¬¡å¯¹observationè¿›è¡Œçš„actionåšlossçš„å¯¹è±¡ã€‚</p></blockquote>
<p><strong>v3</strong></p><p>æ ‡å‡†åŒ–rewardã€‚ä½ æœ‰10åˆ†ï¼Œæ˜¯é«˜æ˜¯ä½ï¼Ÿå¦‚æœæ‰€æœ‰äººéƒ½æ˜¯20åˆ†ï¼Œé‚£å°±æ˜¯ä½åˆ†ï¼Œæ‰€ä»¥ä¸Gåšå¯¹æ¯”çš„æ—¶å€™ï¼Œé€šå¸¸è¦å‡å»ä¸€ä¸ªåˆé€‚çš„å€¼<code>b</code>ï¼Œè®©å¾—åˆ†çš„åˆ†å¸ƒæœ‰æ­£æœ‰è´Ÿã€‚</p><p><strong>Policy Gradient</strong></p><p>æ™®é€šçš„gradient descentæ˜¯æœé›†ä¸€éæ•°æ®ï¼Œå°±å¯ä»¥è·‘forå¾ªç¯äº†ï¼Œè€ŒPGä¸è¡Œï¼Œä½ æ¯æ¬¡å¾—åˆ°æ¢¯åº¦åï¼Œè¦é‡é‡‡ä¸€éæ ·ï¼Œå…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œä½ ä¸‹äº†æŸä¸€æ­¥ï¼Œç»è¿‡åç»­50æ­¥åï¼Œè¾“äº†ï¼Œä½ çš„ä¸‹ä¸€è½®æµ‹è¯•åº”è¯¥æ˜¯ä¸‹ä¸€ç›˜éšæœºçš„æ£‹ï¼Œè€Œä¸æ˜¯æŠŠæ›´æ–°å¥½çš„å‚æ•°å†ç”¨åˆ°åŒä¸€ç›˜æ£‹å»ã€‚</p><p>è¿˜æ˜¯ä¸æ€ä¹ˆå¥½ç†è§£ï¼Œè‡³å°‘è¦çŸ¥é“ï¼Œæˆ‘åšå‚æ•°æ˜¯ä¸ä¸ºäº†è®­ç»ƒå‡ºè¿™ä¸€ç›˜æ£‹æ˜¯æ€ä¹ˆä¸‹å‡ºæ¥çš„ï¼Œè€Œæ˜¯æ ¹æ®è¿™ä¸ªï¼ˆå¤§å¤šæ˜¯è¾“äº†çš„ï¼‰ç»“æœï¼Œä»¥åŠå­¦åˆ°çš„æ¢¯åº¦ï¼Œå»ä¸‹ä¸€ç›˜æ–°çš„æ£‹è¯•è¯•ã€‚</p><h2>Actor Critic</h2>
<p><strong>Critic</strong>:</p><ul>
<li>Given <code>actor</code> $\theta$, how good it is when <code>observing</code> s (and taking action a)</li>
</ul>
<p><strong>Value function</strong> $V^\theta(s)$:</p><ul>
<li>ä½¿ç”¨actor $\theta$çš„æ—¶å€™ï¼Œé¢„æµ‹ä¼šå¾—åˆ°å¤šå°‘çš„<code>cumulated reward</code></li>
<li>åˆ†é«˜åˆ†ä½å…¶å®è¿˜æ˜¯å–å†³äºactorï¼ŒåŒæ ·çš„å±€é¢ï¼Œä¸åŒçš„actorè‚¯å®šæ‹¿çš„åˆ†ä¸åŒã€‚</li>
</ul>
<h3>Monte-Carlo based approach (MC)</h3>
<p>è’™ç‰¹å¡æ´›æœç´¢ï¼Œæ­£å¸¸æŠŠæ¸¸æˆç©å®Œï¼Œå¾—åˆ°ç›¸åº”çš„G.</p><h3>Temporal-difference approach (TD)</h3>
<p>ä¸ç”¨ç©å®Œæ•´ä¸ªæ¸¸æˆï¼Œå°±ç”¨å‰åæ—¶é—´æ®µçš„æ•°æ®æ¥å¾—åˆ°è¾“å‡ºã€‚
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/de79fef0ebceeda7cd5011e38ab28c46.png" alt=""/></figure></p><p>å…³é”®è¯ï¼š</p><ul>
<li>æˆ‘ä»¬æ—¢ä¸çŸ¥é“v(t+1)ï¼Œä¹Ÿä¸çŸ¥é“v(t)ï¼Œä½†ç¡®å®èƒ½çŸ¥é“<code>v(t+1)-v(t)</code>.</li>
</ul>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/1fbf32aed94a0b3f47d9b124a466874c.png" alt=""/></figure><p>è¿™ä¸ªä¾‹å­æ²¡çœ‹æ‡‚ï¼Œåé¢ä¸ƒæ¬¡æ¸¸æˆä¸ºä»€ä¹ˆæ²¡æœ‰saäº†ï¼Ÿ</p><p><strong>v3.5</strong></p><p>ä¸Šæ–‡æåˆ°çš„Vå¯ä»¥ç”¨æ¥ä½œæ›´æ—©æåˆ°çš„b:</p><ul>
<li>${S_t, a_t}\ A_t = G_t' - V^\theta(S_t)$</li>
<li>å›é¡¾ä¸€ä¸‹ï¼Œ$V^\theta(S_t)$æ˜¯çœ‹åˆ°æŸä¸ªæ¸¸æˆç”»é¢æ—¶ç®—å‡ºæ¥çš„reward</li>
<li>å®ƒåŒ…å«$S_t$çŠ¶æ€ä¸‹ï¼Œåç»­å„ç§æ­¥éª¤çš„rewardçš„å¹³å‡å€¼</li>
<li>è€Œ$G_t'$åˆ™æ˜¯è¿™ä¸€æ­¥ä¸‹çš„rewared</li>
<li>ä¸¤ä¸ªæ•°ç›¸å‡å…¶å®å°±æ˜¯çœ‹ä½ çš„è¿™ä¸€æ­¥æ˜¯æ¯”å¹³å‡æ°´å¹³å¥½è¿˜æ˜¯å·®</li>
<li>æ¯”å¦‚ä½ å¾—åˆ°äº†ä¸ªè´Ÿå€¼ï¼Œä»£è¡¨åœ¨å½“å‰åœºæ™¯ä¸‹ï¼Œè¿™ä¸ªactoræ‰§è¡Œçš„æ­¥éª¤æ˜¯ä½äºå¹³å‡èƒœç‡çš„ï¼Œéœ€è¦æ¢ä¸€ç§èµ°æ³•ã€‚</li>
</ul>
<p><strong>v4</strong></p><p>3.5ç‰ˆä¸‹ï¼ŒGåªæœ‰ä¸€ä¸ªæ ·æœ¬ï¼ˆä¸€æ¬¡æ¸¸æˆï¼‰çš„ç»“æœï¼Œè¿™ä¸ªç‰ˆæœ¬é‡Œï¼ŒæŠŠstå†èµ°ä¸€æ­¥ï¼Œè¯•éš¾$S_{t+1}$çš„å„ç§èµ°æ³•ä¸‹rewardçš„å¹³å‡å€¼ï¼Œç”¨å®ƒæ¥æ›¿æ¢G'ï¼Œè€Œå®ƒçš„å€¼ï¼Œå°±æ˜¯å½“å‰çš„rewardåŠ ä¸Št+1æ—¶åˆ»çš„V:</p><ul>
<li>$r_t + V^\theta(S_{t+1}) - V^\theta(S_t)$</li>
</ul>
<p>è¿™å°±æ˜¯ï¼š</p><h3>Advantage Actor-Critic</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/a038f8d6237e4d33a943099bdbfdefc3.png" alt=""/></figure><p>å°±çœ‹å›¾è€Œè¨€ï¼Œæ„Ÿè§‰å°±æ˜¯åšæŒè¿™ä¸€æ­¥èµ°å®Œï¼Œåç»­æ‰€æœ‰å¯èƒ½çš„rewawrdï¼Œ å‡å»ï¼Œ ä»è¿™ä¸€æ­¥å¼€å§‹å°±è¯•éªŒæ‰€æœ‰èµ°æ³•çš„reward</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/82541f55c2db06d3b1e8339d6e63d140.png" alt=""/></figure><p>More:</p><p>Deep Q Network (DQN)</p><ul>
<li><a href="https://arxiv.org/abs/1710.02298">https://arxiv.org/abs/1710.02298</a></li>
<li><a href="https://youtu.be/o_g9JUMw1Oc">https://youtu.be/o_g9JUMw1Oc</a></li>
<li><a href="https://youtu.be/2-zGCx4iv_k">https://youtu.be/2-zGCx4iv_k</a></li>
</ul>
<h2>Reward Shaping</h2>
<p>å‰é¢è¯´è¿‡å¾ˆå¤šåœºæ™¯è¦å¾—åˆ°rewardéå¸¸å›°éš¾ï¼ˆæ—¶é—´é•¿ï¼Œæ­¥éª¤é•¿ï¼Œæˆ–æ ¹æœ¬ä¸ä¼šç»“æŸï¼‰ï¼Œè¿™æ ·çš„æƒ…å†µå«<code>sparse reward</code>ï¼Œäººç±»å¯ä»¥åˆ©ç”¨ä¸€äº›å·²çŸ¥çŸ¥è¯†å»äººä¸ºè®¾ç½®ä¸€äº›rewardä»¥å¢å¼ºæˆ–å‰Šå¼±æœºå™¨çš„æŸäº›è¡Œä¸ºã€‚</p><p>æ¯”å¦‚æ¸¸æˆï¼š</p><ol>
<li>åŸåœ°ä¸åŠ¨ä¸€ç›´æ…¢æ…¢å‡åˆ†</li>
<li>æ¯å¤šæ´»ä¸€ç§’ä¹Ÿæ…¢æ…¢å‡åˆ†ï¼ˆè¿«ä½¿ä½ å»è·å¾—æ›´é«˜çš„reward, é¿å…å­¦åˆ°æ ¹æœ¬å°±ä¸å»æˆ˜æ–—çš„æ–¹å¼ï¼‰</li>
<li>æ¯æ‰ä¸€æ¬¡è¡€ä¹Ÿå‡åˆ†</li>
<li>æ¯æ€ä¸€ä¸ªæ•Œäººå°±åŠ åˆ†</li>
<li>ä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·å°±ä¸è‡³äºè¦ç­‰åˆ°ä¸€åœºæ¯”èµ›ç»“æŸæ‰æœ‰â€œä¸€ä¸ªâ€reward</li>
</ol>
<p>åˆæ¯”å¦‚è®­ç»ƒæœºæ¢°æ‰‹æŠŠä¸€å—æœ‰æ´çš„æœ¨æ¿å¥—åˆ°ä¸€æ ¹æ£å­ä¸Šï¼š</p><ol>
<li>ç¦»æ£å­è¶Šè¿‘ï¼Œå°±æœ‰ä¸€å®šçš„åŠ åˆ†</li>
<li>å…¶å®ƒæœ‰åŠ©äºå¥—è¿›å»çš„è§„åˆ™</li>
</ol>
<p>è¿˜å¯ä»¥ç»™æœºå™¨åŠ ä¸Š<strong>å¥½å¥‡å¿ƒ</strong>ï¼Œè®©æœºå™¨çœ‹åˆ°æœ‰ç”¨çš„â€œæ–°çš„ä¸œè¥¿â€ä¹ŸåŠ åˆ†ã€‚</p><h2>No Reward, learn from demostration</h2>
<p>åªæœ‰æ¸¸æˆåœºæ™¯æ‰ä¼šæœ‰æ˜ç¡®çš„rewardï¼Œå¤§å¤šæ•°ç°å®åœºæ™¯éƒ½æ˜¯æ²¡æœ‰rewardçš„ï¼Œæ¯”å¦‚è®­ç»ƒè‡ªåŠ¨é©¾é©¶çš„è½¦ï¼Œæˆ–è€…å¤ªè¿‡æ­»æ¿çš„rewardæ—¢ä¸èƒ½é€‚åº”å˜åŒ–ï¼Œä¹Ÿå®¹æ˜“è¢«æ‰“å‡ºæ¼æ´ï¼Œæ¯”å¦‚æœºå™¨äººä¸‰å®šå¾‹é‡Œï¼Œæœºå™¨äººä¸èƒ½ä¼¤å®³äººç±»ï¼Œå´æ²¡æœ‰ç¦æ­¢å›šç¦äººç±»ï¼Œåˆæ¯”å¦‚æ‘†æ”¾ç›˜å­ï¼Œå´æ²¡æœ‰ç»™å‡ºåŠ›åº¦ï¼Œç­‰ç›˜å­æ‘”ç¢äº†ï¼Œå†å»è¡¥ä¸€æ¡ğ¢±¨ç¢ç›˜å­å°±è´Ÿrewardçš„è§„åˆ™ï¼Œä¹Ÿæ™šäº†ï¼Œç”±æ­¤å¼•å…¥æ¨¡ä»¿å­¦ä¹ ï¼š</p><h3>Imitation Learning</h3>
<p>ç•¥</p><h1>Life-Long Learning</h1>
<p>æŒç»­å­¦ä¹ ï¼Œæœºå™¨å­¦ä¹ åˆ°ä¸€ä¸ªæ¨¡å‹åï¼Œç»§ç»­å­¦ä¸‹ä¸€ä¸ªæ¨¡å‹ï¼ˆä»»åŠ¡ï¼‰ã€‚</p><ol>
<li>ä¸ºä»€ä¹ˆä¸ä¸€ä¸ªä»»åŠ¡å­¦ä¸€ä¸ªæ¨¡å‹<ul>
<li>ä¸å¯èƒ½å»å­˜å‚¨æ‰€æœ‰çš„æ¨¡å‹</li>
<li>ä¸€ä¸ªä»»åŠ¡çš„çŸ¥è¯†ä¸èƒ½è½¬ç§»åˆ°å¦ä¸€ä¸ªä»»åŠ¡</li>
</ul>
</li>
<li>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨è¿ç§»å­¦ä¹ ï¼ˆè¿ç§»å­¦ä¹ åªå…³æ³¨è¿ç§»åçš„æ–°ä»»åŠ¡ï¼‰</li>
</ol>
<h2>Research Directions</h2>
<h3>Selective Synaptic Plasticity</h3>
<p>é€‰æ‹©æ€§çš„ç¥ç»çªè§¦çš„å¯å¡‘æ€§ï¼Ÿï¼ˆRegularization-based Approachï¼‰</p><p><strong>Catastrophic Forgetting</strong> ç¾éš¾æ€§çš„é—å¿˜
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/207da40b7ff67f6534e5fc5de208cce9.png" alt=""/></figure></p><p>åœ¨ä»»åŠ¡1ä¸Šå­¦åˆ°çš„å‚æ•°ï¼Œåˆ°ä»»åŠ¡2é‡Œæ¥ç€è®­ç»ƒï¼Œé¡ºç€æ¢¯åº¦åˆ°äº†ä»»åŠ¡2çš„æœ€ä¼˜å‚æ•°ï¼Œæ˜¾ç„¶ä¸å†æ˜¯ä»»åŠ¡1çš„åšä»¥å‚ï¼Œè¿™å«ç¾éš¾æ€§çš„é—å¿˜</p><p>ä¸€ç§æ€è·¯ï¼š</p><p>ä»»åŠ¡2é‡Œæ¢¯åº¦è¦æ›´æ–°æœªå¿…è¦å¾€ä¸­å¿ƒï¼Œä¹Ÿå¯ä»¥å¾€ä¸­ä¸‹æ–¹ï¼Œè¿™æ ·æ—¢åœ¨ä»»åŠ¡2çš„ä½lossåŒºåŸŸï¼Œä¹Ÿæ²¡æœ‰è·‘å‡ºä»»åŠ¡1çš„ä½lossåŒºåŸŸï¼Œå®ç°çš„æ–¹å¼æ˜¯æ‰¾åˆ°å¯¹ä¹‹å‰ä»»åŠ¡å½±å“æ¯”è¾ƒå°çš„å‚æ•°ï¼Œä¸»è¦å»æ›´æ–°é‚£äº›å‚æ•°ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­ï¼Œæ˜¾ç„¶$\theta_1$å¯¹ä»»åŠ¡1çš„losså½±å“è¶Šå°ï¼Œä½†æ˜¯æ›´æ–°å®ƒä¹‹åä¼šæ˜¾è‘—å½±å“ä»»åŠ¡2çš„lossï¼Œè€Œ$\theta_2$çš„æ”¹åŠ¨æ‰æ˜¯é€ æˆä»»åŠ¡1losså˜å¤§çš„å…ƒå‡¶ã€‚</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/1b27e4cf8478e749d8899d30b75bbb22.png" alt=""/></figure><p>Elastic Weight Consolidation(EWC)</p><ul>
<li><a href="https://arxiv.org/abs/1612.00796">https://arxiv.org/abs/1612.00796</a></li>
</ul>
<p>Synaptic Intelligence(SI)</p><ul>
<li><a href="https://arxiv.org/abs/1703.04200">https://arxiv.org/abs/1703.04200</a></li>
</ul>
<p>Memory Aware Synapses(MAS)</p><ul>
<li><a href="https://arxiv.org/abs/1711.09601">https://arxiv.org/abs/1711.09601</a></li>
</ul>
<p>RWalk</p><ul>
<li><a href="https://arxiv.org/abs/1801.10112">https://arxiv.org/abs/1801.10112</a></li>
</ul>
<p>Sliced Cramer Preservation(SCP)</p><ul>
<li><a href="https://openreview.net/forum?id=BJge3TNKwH">https://openreview.net/forum?id=BJge3TNKwH</a></li>
</ul>
<figure  style="flex: 132.76231263383298" ><img width="1240" height="467" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/474bbac22bf3778191de7bf09d10d69d.png" alt=""/></figure><h3>Memory Reply</h3>
<ol>
<li>åœ¨è®­ç»ƒtask1çš„æ—¶å€™ï¼ŒåŒæ—¶è®­ç»ƒä¸€ä¸ªç›¸åº”çš„generator</li>
<li>è®­ç»ƒtask2çš„æ—¶å€™ï¼Œç”¨task1çš„generatorç”Ÿæˆpseudo-dataï¼Œä¸€èµ·æ¥è®­ç»ƒç”Ÿæˆæ–°çš„model</li>
<li>åŒæ—¶ä¹Ÿè®­ç»ƒå‡ºä¸€ä¸ªtask1&amp;2çš„generator</li>
<li>...</li>
</ol>
<h1>Network Compress</h1>
<h2>pruning (å‰ªæ)</h2>
<p>Networks ar typically over-parameterized (there is significant redundant weights or neurons)</p><ul>
<li>å¯ä»¥çœ‹å“ªäº›å‚æ•°é€šå¸¸æ¯”è¾ƒå¤§ï¼Œæˆ–å€¼çš„å˜åŒ–ä¸å½±å“lossï¼ˆæ¢¯åº¦å°ï¼‰-&gt; æƒé‡ï¼Œä¸º0çš„æ¬¡æ•°å°‘ -&gt; ç¥ç»å…ƒ ç­‰ç­‰</li>
<li>å‰ªæåç²¾åº¦è‚¯å®šæ˜¯ä¼šä¸‹é™çš„</li>
<li>éœ€è¦æ¥ç€fine-tune</li>
<li>ä¸€æ¬¡ä¸è¦prune to much</li>
<li>å‰ªå‚æ•°å’Œå‰ªç¥ç»å…ƒæ•ˆæœæ˜¯ä¸ä¸€æ ·çš„<ul>
<li>å‰ªå‚æ•°ä¼šå½±å“çŸ©é˜µè¿ç®—ï¼Œç»§è€Œå½±å“GPUåŠ é€Ÿ</li>
</ul>
</li>
</ul>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¸ç›´æ¥trainä¸€ä¸ªå°çš„networkå‘¢ï¼Ÿ</p><ul>
<li>å°çš„networké€šå¸¸å¾ˆéš¾trainåˆ°åŒæ ·çš„å‡†ç¡®ç‡ã€‚ ï¼ˆå¤§ä¹é€å‡è¯´ï¼‰</li>
</ul>
<h2>Knowledge Distillation (çŸ¥è¯†è’¸é¦)</h2>
<p>è€å¸ˆæ¨¡å‹è®­ç»ƒå‡ºæ¥çš„ç»“æœï¼Œç”¨å­¦ç”Ÿæ¨¡å‹ï¼ˆå°æ¨¡å‹ï¼‰å»æ¨¡æ‹Ÿï¼ˆå³æ˜¯æ¨¡æ‹Ÿæ•´ä¸ªè¾“å‡ºï¼Œè€Œä¸æ˜¯æ¨¡æ‹Ÿåˆ†ç±»ç»“æœï¼‰ï¼Œè®©å°æ¨¡å‹èƒ½è¾¾åˆ°å¤§æ¨¡å‹åŒæ ·çš„ç»“æœã€‚</p><p>ä¸€èˆ¬è¿˜ä¼šåœ¨è¾“å‡ºçš„softmaxé‡Œé¢åŠ ä¸Šæ¸©åº¦å‚æ•°ï¼ˆå³å¹³æ»‘è¾“å‡ºï¼Œä¸åŒå¤§å°çš„æ•°é™¤ä¸€ä¸ªå¤§äº1çš„æ•°ï¼Œæ˜¾ç„¶è¶Šå¤§è¢«ç¼©å°çš„å€æ•°ä¹Ÿè¶Šå¤§ï¼Œæ¯”å¦‚100/10=10ï¼Œå°‘äº†90ï¼Œ10/10=1, åªå°‘äº†9ï¼Œå·®åˆ«ä¹Ÿä»90å˜æˆäº†9ï¼‰(æˆ–è€…å…´è¶£ä¸ªæç«¯çš„ä¾‹å­ï¼ŒTå–æ— ç©·å¤§ï¼Œé‚£ä¹ˆæ¯ä¸ªè¾“å‡ºå°±åŸºæœ¬ç›¸ç­‰äº†)</p><h2>Parameter Quantization</h2>
<ol>
<li>Using less bits to represent a value</li>
<li>Weight clustering<ul>
<li>æŠŠweightsåˆ†æˆé¢„å…ˆç¡®å®šå¥½çš„ç°‡ï¼ˆæˆ–æ ¹æ®åˆ†å¸ƒæ¥ç¡®å®šï¼‰</li>
<li>å¯¹æ¯ç°‡å–å‡å€¼ï¼Œç”¨å‡å€¼ä»£æ›¿æ•´ä¸ªç°‡é‡Œæ‰€æœ‰çš„å€¼</li>
</ul>
</li>
<li>represent frequent clusters by less bits, represent rare clusters by more bits<ul>
<li>Huffman encoding</li>
</ul>
</li>
</ol>
<p>æé™ï¼Œ<code>Binary Weights</code>ï¼Œç”¨ä¸¤ä¸ªbitsæ¥æè¿°æ•´ä¸ªç½‘ç»œï¼Œæ‰©å±•é˜…è¯»ã€‚</p><h2>Depthwise Separable Convolution</h2>
<p>å›é¡¾ä¸‹CNNçš„æœºåˆ¶ï¼Œå‚æ•°é‡æ˜¯ï¼š</p><ul>
<li>å·ç§¯æ ¸çš„å¤§å° x è¾“å…¥å›¾åƒçš„é€šé“æ•° x è¾“å‡ºçš„é€šé“æ•°</li>
<li>($k\times k$) x in_channel x out_channel</li>
</ul>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/769ea8db15464e205b9c674747eb650d.png" alt=""/></figure><p>è€Œ<code>Depthwise Separable Convolution</code>ç”±ä¸¤ä¸ªå·ç§¯ç»„æˆï¼š</p><ol>
<li>Depthwise Convolution<ul>
<li>å¾ˆå¤šäººå¯¹CNNçš„è¯¯è§£åˆšå¥½å°±æ˜¯Depthwise Convolutionçš„æ ·å­ï¼Œå³ä¸€ä¸ªå·ç§¯æ ¸å¯¹åº”ä¸€ä¸ªè¾“å…¥çš„channelï¼ˆäº‹å®ä¸Šæ˜¯ä¸€ç»„å·ç§¯æ ¸å¯¹åº”æ‰€æœ‰çš„è¾“å…¥channelï¼‰</li>
<li>å› æ­¤å®ƒçš„å‚æ•°ä¸ªæ•° k x k x in_channel</li>
</ul>
</li>
<li>PointWise Convolution<ul>
<li>è¿™é‡Œæ˜¯ä¸ºäº†è¡¥ä¸Šé€šé“ä¸é€šé“è¿™é—´çš„å…³ç³»</li>
<li>äºæ˜¯ç”¨äº†ä¸€ä¸ª1x1çš„<code>æ ‡å‡†</code>å·ç§¯ï¼ˆå³æ¯ä¸€ç»„å·ç§¯æ ¸å¯¹åº”è¾“å…¥çš„æ‰€æœ‰é€šé“ï¼‰</li>
<li>è¾“å‡ºchannelä¹Ÿç”±è¿™æ¬¡å·ç§¯å†³å®š</li>
<li>åº”ç”¨æ ‡å‡†å·ç§¯å‚æ•°é‡ï¼š(1x1) x in_channel x out_channel</li>
</ul>
</li>
</ol>
<figure  style="flex: 130.52631578947367" ><img width="1240" height="475" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/e147af5889954aa781498c5977f659f1.png" alt=""/></figure><p>ä¸¤ä¸ªå‚æ•°é‡åšå¯¹æ¯”, è®¾<code>in_channel = I</code>, <code>out_channel = O</code></p><ol>
<li>$p_1 = (k\times k) \times I \times O$</li>
<li>$p_2 = (k\times k) \times I + (1\times 1) \times I \times O = (k\times k) \times I + I \times O$</li>
<li>$\frac{p_2}{p_1} = \frac{I\cdot(k^2 + O)}{I\cdot{k^2\cdot O}}</li>
</ol>
<p>= \frac{1}{O} + \frac{1}{k^2} \approx \frac{1}{k^2} 
$</p><p>Oä»£è¡¨out_channelï¼Œå¤§å‹ç½‘ç»œé‡Œ256ï¼Œ512æ¯”æ¯”çš†æ˜¯ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å¿½ç•¥ï¼Œé‚£ä¹ˆå‰åå‚æ•°é‡å°±ç”±$k^2$å†³å®šäº†ï¼Œå¦‚æœæ˜¯å¤§å°ä¸º3çš„å·ç§¯æ ¸ï¼Œå‚æ•°é‡å°±å˜æˆ1/9äº†ï¼Œå·²ç»æ˜¯å‹ç¼©å¾—å¾ˆå¯è§‚äº†ã€‚</p><h3>Low rank approximation</h3>
<p>ä¸Šé¢æ˜¯åº”ç”¨ï¼ŒåŸç†å°±æ˜¯<code>Low rank approximation</code></p><p>ä»¥å…¨è¿æ¥ç½‘ç»œä¸¾ä¾‹</p><ol>
<li>å¦‚æœä¸€ä¸ªä¸€å±‚çš„ç½‘ç»œï¼Œè¾“å…¥<code>N</code>ï¼Œ è¾“å‡º<code>M</code>ï¼Œå‚æ•°ä¸º<code>W</code>ï¼Œé‚£ä¹ˆå‚æ•°é‡æ˜¯<code>MxN</code></li>
<li>ä¸­é—´æ’å…¥ä¸€ä¸ªçº¿æ€§å±‚<code>K</code>ï¼Œ<ul>
<li>å‚æ•°å˜æˆï¼š<code>V</code>:N-&gt;K, <code>U</code>:K-&gt;M,</li>
<li>å‚æ•°é‡ï¼š<code>NxK</code> + <code>KxM</code></li>
</ul>
</li>
<li>åªè¦Kè¿œå°äºMå’ŒNï¼ˆæ¯”å¦‚æ•°é‡çº§éƒ½ä¸ä¸€è‡´ï¼‰ï¼Œé‚£ä¹ˆå‚æ•°é‡æ˜¯æ¯”ç›´æ¥MxNè¦å°å¾ˆå¤šçš„</li>
<li>è¿™ä¹Ÿé™åˆ¶äº†èƒ½å¤Ÿå­¦ä¹ çš„å‚æ•°çš„å¯èƒ½æ€§ï¼ˆæ¯•ç«ŸåŸå§‹å‚æ•°é‡æ€ä¹ˆå–éƒ½è¡Œï¼‰<ul>
<li>æ‰€ä»¥å«<code>Low rank</code> approximation</li>
</ul>
</li>
</ol>
<p><strong>to learn more</strong></p><p>SqueezeNet</p><ul>
<li><a href="https://arxiv.org/abs/1602.07360">https://arxiv.org/abs/1602.07360</a></li>
</ul>
<p>MobileNet</p><ul>
<li><a href="https://arxiv.org/abs/1704.04861">https://arxiv.org/abs/1704.04861</a></li>
</ul>
<p>ShuffleNet</p><ul>
<li><a href="https://arxiv.org/abs/1707.01083">https://arxiv.org/abs/1707.01083</a></li>
</ul>
<p>Xception</p><ul>
<li><a href="https://arxiv.org/abs/1610.02357">https://arxiv.org/abs/1610.02357</a></li>
</ul>
<p>GhostNet</p><ul>
<li><a href="https://arxiv.org/abs/1911.11907">https://arxiv.org/abs/1911.11907</a></li>
</ul>
<h2>Dynamic Computation</h2>
<ol>
<li>åŒä¸€ä¸ªç½‘ç»œï¼Œè‡ªå·±æ¥å†³å®šè®¡ç®—é‡ï¼Œæ¯”å¦‚æ˜¯åœ¨ä¸åŒçš„è®¾å¤‡ä¸Šï¼Œåˆæˆ–è€…æ˜¯åœ¨åŒè®¾å¤‡çš„ä¸åŒæ—¶æœŸï¼ˆæ¯”å¦‚é—²æ—¶å’Œå¿™æ—¶ï¼Œæ¯”å¦‚ç”µé‡å……è¶³å’Œè™šç”µæ—¶ï¼‰</li>
<li>ä¸ºä»€ä¹ˆä¸ä¸ºä¸åŒçš„åœºæ™¯å‡†å¤‡ä¸åŒçš„modelå‘¢ï¼Ÿ<ul>
<li>åè€Œéœ€è¦æ›´å¤§çš„å­˜å‚¨ç©ºé—´ï¼Œä¸é—®é¢˜èµ·æºï¼ˆèµ„æºç“¶é¢ˆï¼‰å†²çªäº†ã€‚</li>
</ul>
</li>
</ol>
<h3>Dynamic Depth</h3>
<p>åœ¨éƒ¨åˆ†layerä¹‹åï¼Œæ¯ä¸€å±‚éƒ½æ’ä¸€ä¸ªé¢å¤–çš„layerï¼Œæå‰åšé¢„æµ‹å’Œè¾“å‡ºï¼Œç”±è°ƒç”¨è€…æ ¹æ®å…·ä½“æƒ…å†µå†³å®šéœ€è¦å¤šæ·±çš„depthæ¥äº§ç”Ÿè¾“å‡ºã€‚</p><p>è®­ç»ƒçš„æ—¶å€™æ—¢è¦è€ƒè™‘ç½‘ç»œç»ˆç‚¹çš„lossï¼Œè¿˜è¦è€ƒè™‘æ‰€æœ‰æå‰ç»“æŸçš„layerçš„softmaxç»“æœï¼ŒåŠ åˆ°ä¸€èµ·ç®—ä¸ªå¤§çš„Loss</p><p>Multi-Scale Dense Network(MSDNet)</p><ul>
<li><a href="https://arxviv.org/abs/1703.09844">https://arxviv.org/abs/1703.09844</a></li>
</ul>
<h3>Dynamic Width</h3>
<p>è®­ç»ƒçš„æ—¶å€™ï¼ˆåŒæ—¶ï¼Ÿï¼‰å¯¹ä¸åŒå®½åº¦ï¼ˆå³ç¥ç»å…ƒä¸ªæ•°ï¼Œæˆ–filterä¸ªæ•°ï¼‰è¿›è¡Œè®¡ç®—ï¼ˆå…¨éƒ¨æ·±åº¦ï¼‰ï¼Œä¹Ÿæ˜¯æŠŠæ¯ç§å®½åº¦æœ€åäº§ç”Ÿçš„lossåŠ èµ·æ¥å½“ä½œæ€»çš„Loss</p><p>åœ¨ä¿ç•™çš„å®½åº¦é‡Œï¼Œå‚æ•°æ˜¯ä¸€æ ·çš„ï¼ˆæ‰€ä»¥åº”è¯¥å°±æ˜¯åŒä¸€è½®è®­ç»ƒé‡Œçš„å‚æ•°äº†ï¼‰</p><p>Slimmable Neural Networks</p><ul>
<li><a href="https://arxiv.org/abs/1812.08928">https://arxiv.org/abs/1812.08928</a></li>
</ul>
<h3>Computation based on Sample Difficulty</h3>
<p>ä¸Šè¿°å†³å®šé‡‡ç”¨ä»€ä¹ˆæ ·çš„network/modelçš„æ˜¯äººå·¥å†³å®šçš„ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰è®©æœºå™¨è‡ªå·±å†³å®šé‡‡ç”¨ä»€ä¹ˆç½‘ç»œçš„å‘¢ï¼Ÿ</p><p>æ¯”å¦‚ä¸€å¼ ç®€å•çš„å›¾ç‰‡ï¼Œå‡ å±‚æˆ–ä¸€å±‚ç½‘å¼ å°±èƒ½å¾—åˆ°ç»“æœï¼Œè€Œå¦ä¸€å¼ å¯èƒ½å‰æ™¯å’Œæˆ–èƒŒæ™¯æ›´å¤æ‚çš„å›¾ç‰‡ï¼Œéœ€è¦å¾ˆå¤šå±‚æ‰èƒ½æœ€ç»ˆæŠŠç‰¹å¾æå–å‡ºæ¥ï¼Œåº”ç”¨åŒä¸€ä¸ªæ¨¡å‹çš„è¯å°±æœ‰ç‚¹èµ„æºæµªè´¹äº†ã€‚</p><ul>
<li>SkipNet: Learning Dynamic Routing in Convolutional Networks</li>
<li>Runtime Neural Pruning</li>
<li>BlockDrop: Dynamic Inference Paths in Residual Networks</li>
</ul>
<h1>Meta Learning</h1>
<ul>
<li>å­¦ä¹ çš„å­¦ä¹ ã€‚</li>
<li>ä¹‹å‰çš„machine learningï¼Œè¾“å‡ºæ˜¯æ˜ç¡®çš„ä»»åŠ¡ï¼Œæ¯”å¦‚æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¿˜æ˜¯ä¸€ä¸ªåˆ†ç±»ï¼›è€Œmeta-learningï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªmodel/networkï¼Œç”¨è¿™ä¸ªmodelï¼Œå¯ä»¥å»åšmachine learningçš„ä»»åŠ¡ã€‚</li>
<li>å®ƒå°±ç›¸å½“äºä¸€ä¸ªâ€œè¿”å‡½æ•°çš„å‡½æ•°â€</li>
<li>meta-learning å°±æ˜¯è®©æœºå™¨å­¦ä¼šå»æ¶æ„ä¸€ä¸ªç½‘ç»œï¼Œåˆå§‹åŒ–ï¼Œå­¦ä¹ ç‡ç­‰ç­‰ $\leftarrow \varPhi$: <code>learnable components</code><ul>
<li>categorize meta learning based on what is learnable</li>
</ul>
</li>
</ul>
<blockquote>
<p>ä¸å†æ·±å…¥</p></blockquote>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-4/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-3/" target="_self">æå®æ¯…MACHINE LEARNING 2021 SPRINGç¬”è®°[3]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-3/" target="_self">
                <time class="text-uppercase">
                    October 13 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><h1>CNN</h1>
<ol>
<li><strong>Receptive field</strong></li>
</ol>
<p>ä¸ç®¡æ˜¯è®¡ç®—æœºï¼Œè¿˜æ˜¯äººè„‘ï¼Œå»è®¤ä¸€ä¸ªç‰©ï¼Œéƒ½æ˜¯å»åˆ¤æ–­ç‰¹å®šçš„pattenï¼ˆæ‰€ä»¥å°±ä¼šæœ‰é”™è®¤çš„å›¾ç‰‡äº§ç”Ÿï¼‰ï¼Œè¿™ä¹Ÿè¯´æ˜ï¼Œå¦‚æœç¥ç»ç½‘ç»œè¦å»è¾¨è¯†ç‰©ä½“ï¼Œæ˜¯ä¸éœ€è¦æ¯ä¸ªç¥ç»å…ƒéƒ½æŠŠæ•´å¼ å›¾ç‰‡çœ‹ä¸€æ¬¡çš„ï¼Œåªéœ€è¦å…³æ³¨ä¸€äº›ç‰¹å¾åŒºåŸŸå°±å¥½äº†ã€‚ï¼ˆæ„Ÿå—é‡, <code>Receptive field</code>)</p><p>å¦‚æœä½ ä¸€ç›´ç”¨3x3ï¼Œä¼šä¸ä¼šçœ‹ä¸åˆ°å¤§çš„pattenå‘¢ï¼Ÿ$\rightarrow$ ä¼šä¹Ÿä¸ä¼šã€‚</p><p>é¦–å…ˆï¼Œå°çš„filterå½“ç„¶æ˜¯ä¸å¯èƒ½çœ‹åˆ°å®ƒçš„æ„Ÿå—é‡ä»¥å¤–çš„éƒ¨åˆ†ï¼Œä½†æ˜¯ï¼Œç¥ç»ç½‘ç»œæ˜¯å¤šå±‚æ¶æ„ï¼Œä½ è¿™å±‚çš„è¾“å‡ºå†è¢«å·ä¸€æ¬¡ï¼Œè¿™æ—¶å€™æ¯ä¸€ä¸ªæ•°å­—ä»£è¡¨çš„å°±æ˜¯ä¹‹å‰çš„9ä¸ªåƒç´ è®¡ç®—çš„ç»“æœï¼Œè¿™ä¸€è½®çš„9ä¸ªæ•°å­—å°±æ˜¯ä¸Šä¸€å±‚çš„81ä¸ªåƒç´ ï¼ˆå› ä¸ºstrideçš„åŸå› ï¼Œå¤§éƒ¨åˆ†æ˜¯é‡å¤çš„ï¼‰çš„è®¡ç®—ç»“æœï¼Œæ¢è¨€ä¹‹ï¼Œæ„Ÿå—é‡å¤§å¤§å¢å¼ºäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ åªéœ€è¦å¢åŠ å±‚æ•°ï¼Œå°±å¯ä»¥åœ¨å°çš„filterä¸Šå¾—åˆ°å¤§çš„patten.</p><ol start="2">
<li><strong>filter &amp; feature map</strong></li>
</ol>
<p>ä»ç¥ç»å…ƒè§’åº¦å’Œå…¨è¿æ¥è§’åº¦å‡ºå‘çš„è¯ï¼Œæ¯ä¸ªæ¡†å…¶å®å¯ä»¥æœ‰è‡ªå·±çš„å‚æ•°çš„ï¼ˆå³ä½ ç”¨äº†64æ­¥æŠŠæ•´ä¸ªå›¾ç‰‡æ‰«æå®Œçš„è¯ï¼Œå°±æœ‰64ç»„å‚æ•°ï¼‰ï¼Œè€Œäº‹å®ä¸Šä¸ºäº†ç®€åŒ–æ¨¡å‹ï¼Œå¯ä»¥è®©æŸäº›æ¡†å¯¹åº”åŒæ ·çš„å‚æ•°ï¼ˆ<strong>å‚æ•°å…±äº«</strong>ï¼‰ï¼ŒåŸå› å°±æ˜¯åŒä¸€ç‰¹å¾å¯èƒ½å‡ºç°åœ¨å¤šä¸ªä½ç½®ï¼Œæ¯”å¦‚äººæœ‰ä¸¤åªè„šã€‚</p><p>å†ç„¶åï¼Œå®é™…ä¸Šæ¯ä¸€æ¬¡éƒ½æ˜¯ç”¨ä¸€ç»„å‚æ•°æ‰«å®Œå…¨å›¾çš„ï¼Œæ„æ€æ˜¯åœ¨æ¯ä¸ªè§’è½éƒ½åªæœç´¢è¿™<strong>ä¸€ä¸ªç‰¹å¾</strong>ã€‚</p><p>æˆ‘ä»¬æŠŠè¿™ç§æœºåˆ¶å«<code>filter</code>ï¼Œä¸€ä¸ªfilteråªæ‰¾ä¸€ç§ç‰¹å¾ï¼Œä¹˜åŠ å‡ºæ¥çš„ç»“æœå«<code>feature map</code>ï¼Œå³è¿™ä¸ªfilteræå–å‡ºæ¥çš„ç‰¹å¾å›¾ã€‚</p><p>å› æ­¤ï¼Œ</p><ul>
<li>ä½ æƒ³æå–å¤šå°‘ä¸ªç‰¹å¾ï¼Œå°±å¾—æœ‰å¤šå°‘ä¸ªfilter</li>
<li>è¡¨ç°å‡ºæ¥å°±æˆäº†ä½ è¿™ä¸€å±‚è¾“å‡ºæœ‰å¤šå°‘ä¸ªchannel</li>
<li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ çš„å›¾ç‰‡è¿›æ¥æ˜¯3channelï¼Œå‡ºæ¥å°±æ˜¯Nä¸ªchanneläº†ï¼Œå–å†³äºä½ è®¾è®¡äº†å¤šå°‘ä¸ªfilter</li>
</ul>
<ol start="3">
<li><strong>Pooling &amp; subsampling</strong></li>
</ol>
<p>ç”±äºå›¾åƒçš„è§†è§‰ç‰¹å¾ï¼Œä½ æŠŠå®ƒæ”¾å¤§æˆ–ç¼©å°éƒ½èƒ½è¢«äººçœ¼è®¤å‡ºæ¥ï¼Œå› æ­¤å°±äº§ç”Ÿäº†poolingè¿™ç§æœºåˆ¶ï¼Œå¯ä»¥é™ä½æ ·æœ¬çš„å¤§å°ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†å‡å°è¿ç®—é‡å§ï¼ˆç¡¬ä»¶æ€§èƒ½è¶³å¤Ÿå°±å¯ä»¥ä¸è€ƒè™‘å®ƒï¼‰ã€‚</p><ol start="4">
<li><strong>Data Augmentation</strong></li>
</ol>
<p>CNNå¹¶ä¸èƒ½è¯†åˆ«ç¼©æ”¾ã€æ—‹è½¬ã€è£åˆ‡ã€ç¿»è½¬è¿‡çš„å›¾ç‰‡ï¼Œå› æ­¤è®­ç»ƒæ•°æ®çš„å¢å¼ºä¹Ÿæ˜¯å¿…è¦çš„ã€‚</p><h2>AlphaGo</h2>
<p><strong>layer 1</strong></p><ol>
<li>èƒ½è¢«å½±åƒåŒ–çš„é—®é¢˜å°±å¯ä»¥å°è¯•CNNï¼Œå›´æ£‹å¯ä»¥çœ‹æˆæ˜¯ä¸€å¼ 19x19çš„å›¾ç‰‡</li>
<li>æ¯ä¸€ä¸ªä½ç½®è¢«æ€»ç»“å‡ºäº†48ç§å¯èƒ½çš„æƒ…å†µ(è¶…å‚1)</li>
<li>æ‰€ä»¥è¾“å…¥å°±æ˜¯19x19x48</li>
<li>ç”¨0æ¥paddingæˆ23x23</li>
<li>å¾ˆå¤špattenã€å®šå¼ä¹Ÿæ˜¯å½±åƒåŒ–çš„ï¼Œå¯ä»¥è¢«filteræ‰«å‡ºæ¥</li>
<li>æ€»ç»“å‡º5x5å¤§å°çš„filterå°±å¤Ÿç”¨äº†ï¼ˆè¶…å‚2ï¼‰</li>
<li>å°±ç”¨äº†192ä¸ªfitlerï¼ˆå³æ¯ä¸€æ¬¡outputæœ‰48å±‚channel)ï¼ˆè¶…å‚3ï¼‰</li>
<li>stride = 1</li>
<li>ReLU</li>
</ol>
<p><strong>layer 2-12</strong></p><ol>
<li>paddingæˆ 21x21</li>
<li>192ä¸ª 3x3 filter with stride = 1</li>
<li>ReLU</li>
</ol>
<p><strong>layer 13</strong></p><ol>
<li>1x1 filter stride = 1</li>
<li>bias</li>
<li>softmax</li>
</ol>
<p>å…¶ä¸­192(ä¸ªfilter)è¿™ä¸ªè¶…å‚å¯¹æ¯”äº†128ï¼Œ256ï¼Œ384ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´äººç±»å¹¶ä¸ç†è§£å®ƒæ¯ä¸€æ¬¡éƒ½æå–äº†ä»€ä¹ˆç‰¹å¾ã€‚</p><blockquote>
<p>subsamplingå¯¹å›´æ£‹ä¹Ÿæœ‰ç”¨å—ï¼Ÿ ä¸Šé¢çš„ç»“æ„çœ‹å‡ºå¹¶æ²¡æœ‰ç”¨ï¼Œäº‹å®ä¸Šï¼Œå›´æ£‹ä½ æŠ½æ‰ä¸€è¡Œä¸€åˆ—å½±å“æ˜¯å¾ˆå¤§çš„ã€‚</p></blockquote>
<h1>Self-Attention</h1>
<p>å‰é¢è¯´çš„éƒ½æ˜¯è¾“å…¥ä¸ºä¸€ä¸ªå‘é‡ï¼ˆæ€»ä¼šæ‹‰å¹³æˆä¸€ç»´å‘é‡ï¼‰ï¼Œå¦‚æœæ˜¯å¤šä¸ªå‘é‡å‘¢ï¼Ÿæœ‰è¿™æ ·çš„åœºæ™¯å—ï¼Ÿ</p><ul>
<li>ä¸€æ®µæ–‡å­—ï¼Œæ¯ä¸€ä¸ªæ–‡å­—éƒ½ç”¨one-hotæˆ–word-embeddingæ¥è¡¨ç¤º<ul>
<li>ä¸ä½†æ˜¯å¤šä¸ªå‘é‡ï¼Œè€Œä¸”è¿˜é•¿çŸ­ä¸é½</li>
</ul>
</li>
<li>ä¸€æ®µè¯­éŸ³ï¼Œæ¯25msé‡‡æ ·å½¢æˆä¸€ä¸ªå‘é‡ï¼Œæ­¥é•¿ä¸ºæ¯10msé‡å¤é‡‡æ ·ï¼Œå½¢æˆå‘é‡åºåˆ—<ul>
<li>400 sample points (16khz)</li>
<li>39-dim MFCC</li>
<li>80-dim filter bank output</li>
<li>å‚è€ƒäººç±»è¯­è¨€å¤„ç†è¯¾ç¨‹</li>
</ul>
</li>
<li>ä¸€ä¸ªGraphç»„å‘é‡ï¼ˆæ¯”å¦‚social network)<ul>
<li>æ¯ä¸ªèŠ‚ç‚¹ï¼ˆæ¯ä¸ªäººçš„profileï¼‰å°±æ˜¯ä¸€ä¸ªå‘é‡</li>
</ul>
</li>
<li>ä¸€ä¸ªåˆ†å­ç»“æ„<ul>
<li>æ¯ä¸ªåŸå­å°±æ˜¯ä¸€ä¸ªone-hot</li>
</ul>
</li>
</ul>
<p><strong>è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</strong></p><ol>
<li>ä¸€ä¸ªå‘é‡å¯¹åº”ä¸€ä¸ªè¾“å‡º<ul>
<li>æ–‡å­— -&gt; POS tagging</li>
<li>è¯­éŸ³ -&gt; a, a, b, b(æ€ä¹ˆå»é‡ä¹Ÿå‚è€ƒ<a href="https://speech.ee.ntu.edu.tw/~hylee/dlhlp/2020-spring.html">äººç±»è¯­è¨€å¤„ç†</a>è¯¾ç¨‹)</li>
<li>graph -&gt; æ¯ä¸ªèŠ‚ç‚¹è¾“å‡ºç‰¹æ€§ï¼ˆæ¯”å¦‚æ¯ä¸ªäººçš„è´­ä¹°å†³ç­–ï¼‰</li>
</ul>
</li>
<li>åªæœ‰ä¸€ä¸ªè¾“å‡º<ul>
<li>æ–‡å­— -&gt; æƒ…ç»ªåˆ†æï¼Œèˆ†æƒ…åˆ†æ</li>
<li>è¯­éŸ³ -&gt; åˆ¤æ–­æ˜¯è°è¯´çš„</li>
<li>graph -&gt; è¾“å‡ºæ•´ä¸ªgraphçš„ç‰¹æ€§ï¼Œæ¯”å¦‚äº²æ°´æ€§å¦‚ä½•</li>
</ul>
</li>
<li>ä¸å®šè¾“å‡ºï¼ˆç”±networkè‡ªå·±å†³å®šï¼‰<ul>
<li>è¿™å°±å«seq2seq</li>
<li>æ–‡å­— -&gt; ç¿»è¯‘</li>
<li>è¯­éŸ³ -&gt; çœŸæ­£çš„è¯­éŸ³è¯†åˆ«</li>
</ul>
</li>
</ol>
<p>self-attention</p><p>ç¨ç¨å›é¡¾ä¸€ä¸‹self attentioné‡Œæœ€é‡è¦çš„q, k, vçš„éƒ¨åˆ†ï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/97e9b2e0e7ac0f115036ca6bd0c71849.png" alt=""/></figure><p>å›¾ç¤ºçš„æ˜¯q2ä¸æ‰€æœ‰çš„kç›¸ä¹˜ï¼Œå†åˆ†åˆ«ä¸å¯¹åº”çš„vç›¸ä¹˜ï¼Œç„¶åç›¸åŠ ï¼Œå¾—åˆ°q2å¯¹åº”çš„è¾“å‡ºï¼šb2çš„è¿‡ç¨‹ã€‚</p><p>ä¸‹å›¾åˆ™æ˜¯çŸ©é˜µåŒ–åçš„ç»“è®ºï¼š
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/429312b4d209231715578ba2ba3a80dc.png" alt=""/></figure>
å…·ä½“ç»†èŠ‚çœ‹ä¸“é¢˜</p><p>çœŸæ­£è¦å­¦çš„ï¼Œå°±æ˜¯å›¾ä¸­çš„$W^q, W^k, W^v$</p><h2>Multi-head Self-attention</h2>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/4ac2f963c12f8046cf93824b2a2c5f9f.png" alt=""/></figure><p>CNNæ˜¯Self-attentionçš„ç‰¹ä¾‹</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/9c914c0fa757448a64dfa2c88ae110e5.png" alt=""/></figure><h2>Self-attention for Graph</h2>
<p>äº†è§£æ›´å¤šï¼š<a href="https://youtu.be/eybCCtNKwzA">https://youtu.be/eybCCtNKwzA</a></p><h1>Transformer</h1>
<p>Transformeræ˜¯ä¸€ä¸ªseq2seqçš„model</p><p>ä»¥ä¸‹åœºæ™¯ï¼Œä¸ç®¡çœ‹ä¸Šå»åƒä¸åƒæ˜¯seq2seqçš„ç‰¹å¾ï¼Œéƒ½å¯ä»¥å°è¯•ç”¨seq2seqï¼ˆtrnasformerï¼‰æ¥â€œç¡¬trainä¸€å‘â€</p><ul>
<li>QAç±»çš„é—®é¢˜ï¼Œé€è¿›å»question + contextï¼Œè¾“å‡ºanswer<ul>
<li>ç¿»è¯‘ï¼Œæ‘˜è¦ï¼Œå·®åˆ«ï¼Œæƒ…æ„Ÿåˆ†æï¼Œåªè¦è®­ç»ƒèƒ½å¥—ä¸Šä¸Šé¢çš„æ ¼å¼ï¼Œå°±æœ‰å¯èƒ½</li>
</ul>
</li>
<li>æ–‡æ³•å‰–æï¼Œé€å…¥æ˜¯å¥å­ï¼Œè¾“å‡ºæ˜¯æ ‘çŠ¶çš„è¯­æ³•ç»“æ„<ul>
<li>æŠŠæ ‘çŠ¶ç»“æ„æ‘Šå¹³ï¼ˆå…¶å®å°±æ˜¯å¤šå±‚æ‹¬å·ï¼‰</li>
<li>ç„¶åå°±ç”¨è¿™ä¸ªå¯¹åº”å…³ç³»æ¥å½“æˆç¿»è¯‘æ¥è®­ç»ƒï¼ˆå³æŠŠè¯­æ³•å½“æˆç¿»è¯‘ï¼‰</li>
</ul>
</li>
<li>multi-label classification<ul>
<li>ä½ ä¸èƒ½åœ¨åšmulti-class classificationçš„æ—¶å€™å–top-k,å› ä¸ºæœ‰çš„å±äºä¸€ä¸ªç±»ï¼Œæœ‰çš„å±äºä¸‰ä¸ªç±»ï¼Œkä¸å®š</li>
<li>æ‰€ä»¥ä½ æŠŠæ¯ä¸ªè¾“å…¥å’ŒNä¸ªè¾“å‡ºä¹Ÿä¸¢åˆ°seq2seqé‡Œå»ç¡¬trainä¸€å‘ï¼Œç½‘ç»œä¼šè‡ªå·±å­¦åˆ°æ¯ä¸ªæ–‡ç« å±äºå“ªâ€œäº›â€ç±»åˆ«ï¼ˆä¸å®šä¸ªæ•°ï¼Œä¹Ÿåƒç¿»è¯‘ä¸€æ ·ï¼‰</li>
</ul>
</li>
<li>object dectection<ul>
<li>è¿™ä¸ªæ›´åŒªå¤·æ‰€æ€ï¼Œæ„Ÿå…´è¶£çœ‹è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/2005.12872(End-to-End">https://arxiv.org/abs/2005.12872(End-to-End</a> Object Detection with Transformers)</li>
</ul>
</li>
</ul>
<h2>Encoder</h2>
<p>Q, K, V(relavant/similarity), zero padding mask, layer normalization, residualç­‰, å…·ä½“çœ‹<code>self-attention</code>ä¸€èŠ‚ã€‚</p><h2>Decoder</h2>
<h3>AT v.s. NAT</h3>
<p>æˆ‘ä»¬ä¹‹å‰ç”¨çš„decoderéƒ½æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—åœ°é¢„æµ‹ï¼ˆè¾“å‡ºçš„ï¼‰</p><ul>
<li>æ‰€ä»¥æ‰æœ‰position-maskï¼ˆç”¨æ¥å±è”½å½“å‰ä½ç½®åé¢çš„å­—ï¼‰</li>
</ul>
<p>è¿™ç§å«<code>Auto Regressive</code>ï¼Œç®€ç§°<code>AT</code>,<code>NAT</code>å³<code>Non Auto Regressive</code></p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/a4e144ed0e5f9ad95a029f3224fc46e3.png" alt=""/></figure><p>å®ƒä¸€æ¬¡ç”Ÿæˆè¾“å‡ºçš„å¥å­ã€‚</p><p>è‡³äºseq2seqçš„è¾“å‡ºæ˜¯ä¸å®šé•¿çš„ï¼Œå®ƒæ˜¯æ€ä¹ˆåœ¨ä¸€æ¬¡è¾“å‡ºé‡Œé¢ç¡®å®šé•¿åº¦çš„ï¼Œä¸Šå›¾å·²ç»ç»™å‡ºäº†å‡ ç§åšæ³•ï¼š</p><ol>
<li>å¦åšä¸€ä¸ªpredictoræ¥è¾“å‡ºä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºåº”è¯¥è¾“å‡ºçš„é•¿åº¦</li>
<li>ç›´æ¥ç”¨ä¸€ä¸ªè¶³å¤Ÿé•¿çš„<bos>åšè¾“å…¥ï¼ˆæ¯”å¦‚300ä¸ªï¼‰ï¼Œé‚£è¾“å‡ºä¹Ÿå°±æœ‰300ä¸ªï¼Œå–åˆ°ç¬¬ä¸€ä¸ª<eos>ä¸ºæ­¢</li>
</ol>
<p>å› ä¸ºä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªç”Ÿæˆäº†ï¼Œå¥½å¤„</p><ol>
<li>å¯ä»¥å¹³è¡Œè¿ç®—ã€‚</li>
<li>è¾“å‡ºçš„é•¿åº¦æ›´å¯æ§</li>
</ol>
<blockquote>
<p>NATé€šå¸¸è¡¨ç°ä¸å¦‚ATå¥½ (why? <strong>Multi-mmodality</strong>)</p></blockquote>
<p>detail: <a href="https://youtu.be/jvyKmU4OM3c">https://youtu.be/jvyKmU4OM3c</a> (Non-Autoregressive Sequence Generation)</p><h3>AT</h3>
<p>åœ¨decoderé‡Œæœ€åˆæœ‰è®©äººçœ‹ä¸æ‡‚çš„ä¸‰ä¸ªç®­å¤´ä»encodeçš„è¾“å‡ºé‡ŒæŒ‡å‡ºæ¥:</p><figure class="vertical-figure" style="flex: 41.08681245858184" ><img width="1240" height="1509" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/04bb017a6b7821b1f8e1f676a4e89c13.png" alt=""/></figure><p>å…¶å®è¿™å°±æ˜¯<code>cross attention</code></p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/943872fa064ed57098cf57694c851ace.png" alt=""/></figure><p>å®ƒå°±æ˜¯æŠŠè‡ªå·±ç¬¬ä¸€å±‚(self-attentionå)çš„è¾“å‡ºä¹˜ä¸€ä¸ª$W^q$å¾—åˆ°çš„<code>q</code>ï¼Œå»è·Ÿencoderçš„è¾“å‡ºåˆ†åˆ«ä¹˜$W^k, W^v$å¾—åˆ°çš„kå’Œvè¿ç®—($\sum q \times k \times v$)å¾—åˆ°å½“å‰ä½ç½®çš„è¾“å‡ºçš„è¿‡ç¨‹ã€‚</p><p>è€Œä¸”ç ”ç©¶è€…ä¹Ÿå°è¯•è¿‡å„ç§<code>cross attention</code>çš„æ–¹æ³•ï¼Œè€Œä¸ä»…ä»…æ˜¯æœ¬æ–‡ä¸­çš„æ— è®ºå“ªä¸€å±‚éƒ½ç”¨<code>encoder</code>æœ€åä¸€å±‚çš„è¾“å‡ºåšqå’Œvè¿™ä¸€ç§æ–¹æ¡ˆï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/d1a0d2db75519d1eb4cd58bc9a0c65a5.png" alt=""/></figure><h2>Training Tips</h2>
<h3>å¤åˆ¶æœºåˆ¶</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/637e1eace14b2504906690435792aa40.png" alt=""/></figure><p>ä¸€äº›åœºæ™¯ï¼Œè®­ç»ƒçš„æ—¶å€™æ²¡å¿…è¦å»â€œç”Ÿæˆâ€é˜…è¯»ææ–™é‡Œæåˆ°çš„ä¸€äº›æ¦‚å¿µï¼Œåªéœ€è¦æŠŠå®ƒâ€œå¤åˆ¶â€å‡ºæ¥å³å¯ï¼Œæ¯”å¦‚ä¸Šè¿°çš„äººåï¼Œä¸“æœ‰åå­—ï¼Œæ¦‚å¿µç­‰ï¼Œä»¥åŠå¯¹æ–‡ç« åšæ‘˜è¦ç­‰ã€‚</p><ul>
<li>Pointer Network: <a href="https://youtu.be/VdOyqNQ9aww">https://youtu.be/VdOyqNQ9aww</a></li>
<li>Copying Mechanism in Seq2Seq <a href="https://arxiv.org/abs/1603.06393">https://arxiv.org/abs/1603.06393</a></li>
</ul>
<h3>Guided Attention</h3>
<p>åƒè¯­éŸ³è¿™ç§è¿ç»­æ€§çš„ï¼Œéœ€è¦å¼ºåˆ¶æŒ‡å®š(guide)å®ƒçš„attentioné¡ºåºï¼Œç›¸å¯¹è€Œè¨€ï¼Œæ–‡å­—è·³è·ƒæ„Ÿå¯ä»¥æ›´å¤§ï¼Œè¯­éŸ³ä¸€æ—¦ä¸è¿ç»­å°±å¤±å»äº†å¯å¬æ€§äº†ï¼Œä¸€äº›å…³é”®å­—ï¼š</p><ul>
<li>Monotonic Attention</li>
<li>Location-aware attention</li>
</ul>
<h3>Beam Search</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/0068ee933dbbe3ab1f2fdc59431bc72b.png" alt=""/></figure><h3>Optimizing Evaluation Metrics / BLEU</h3>
<ul>
<li><p>è®­ç»ƒçš„æ—¶å€™lossç”¨çš„æ˜¯cross entropyï¼Œè¦æ±‚lossè¶Šå°è¶Šå¥½ï¼Œ</p></li>
<li><p>è€Œåœ¨evaluationçš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯é¢„æµ‹å€¼ä¸çœŸå€¼çš„<code>BLEU score</code>ï¼Œè¦æ±‚scoreè¶Šå¤§è¶Šå¥½</p></li>
<li><p>é‚£ä¹ˆè¶Šå°çš„cross entropy lossçœŸçš„èƒ½äº§ç”Ÿè¶Šé«˜çš„BLEU scoreå—ï¼Ÿ æœªå¿…</p></li>
<li><p>é‚£ä¹ˆèƒ½ä¸èƒ½åœ¨è®­ç»ƒçš„æ—¶å€™ä¹Ÿç”¨BLEU scoreå‘¢ï¼Ÿ ä¸è¡Œï¼Œå®ƒå¤ªå¤æ‚æ²¡æ³•å¾®åˆ†ï¼Œå°±æ²¡æ³•bpåšæ¢¯åº¦äº†ã€‚</p></li>
</ul>
<h3>Exposure bias</h3>
<p>è®­ç»ƒæ—¶å€™åº”ç”¨äº†<code>Teaching force</code>ï¼Œç”¨äº†å…¨éƒ¨æˆ–éƒ¨åˆ†çœŸå€¼å½“ä½œé¢„æµ‹ç»“æœæ¥è®­ç»ƒï¼ˆæˆ–é˜²æ­¢ä¸€é”™åˆ°åº•ï¼‰ï¼Œè€Œevalçš„æ—¶å€™ç¡®å®å°±æ˜¯ä¸€é”™åˆ°åº•çš„æ¨¡å¼äº†ã€‚</p><h1>Self-supervised Learning</h1>
<ul>
<li>èŠéº»è¡—å®¶åº­ï¼šelmo, bert, erine...</li>
<li>bertå°±æ˜¯transformerçš„encoder</li>
</ul>
<h2>Bert</h2>
<h3>GLUE</h3>
<p>GLUE: General Language Understanding Evaluation</p><p>åŸºæœ¬ä¸Šå°±æ˜¯çœ‹ä»¥ä¸‹è¿™ä¹ä¸ªæ¨¡å‹çš„å¾—åˆ†ï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/bc43a4b9f8009e33413a2f5917c37fa2.png" alt=""/></figure><p>è®­ç»ƒï¼š</p><ol>
<li>é¢„æµ‹maskæ‰çš„è¯(masked token prediction)<ul>
<li>ä¸ºè®­ç»ƒæ•°æ®é›†æ·»åŠ éƒ¨åˆ†æ©ç ï¼Œé¢„æµ‹å¯èƒ½çš„è¾“å‡º</li>
<li>ç±»ä¼¼word2vecçš„C-Bow</li>
</ul>
</li>
<li>é¢„æµ‹ä¸‹ä¸€ä¸ªå¥å­ï¼ˆåˆ†ç±»ï¼Œæ¯”å¦‚æ˜¯å¦ç›¸å…³ï¼‰(next sentence prediction)<ul>
<li>åœ¨å¥é¦–æ·»åŠ <cls>ç”¨æ¥æ¥åˆ†ç±»ç»“æœ</li>
<li>ç”¨<sep>æ¥è¡¨ç¤ºå¥å­åˆ†éš”</li>
</ul>
</li>
</ol>
<p>ä¸‹æ¸¸ä»»åŠ¡ï¼ˆDownstream Taskï¼‰ &lt;- Fine Tune:</p><ol>
<li>sequence -&gt; class: sentiment analysis<ul>
<li>è¿™æ˜¯éœ€è¦æœ‰labelçš„</li>
<li><cls>èŠ‚ç‚¹å¯¹çš„linearéƒ¨åˆ†æ˜¯éšæœºåˆå§‹åŒ–</li>
<li>bertéƒ¨åˆ†æ˜¯pre-trainçš„</li>
</ul>
</li>
<li>sequence -&gt; sequence(ç­‰é•¿): POS tagging</li>
<li>2 sequences -&gt; class: NLI(ä»å¥å­Aèƒ½å¦æ¨å‡ºå¥å­B)(Natural Language Inferencee)<ul>
<li>ä¹Ÿæ¯”å¦‚æ–‡ç« ä¸‹é¢çš„ç•™è¨€çš„ç«‹åœºåˆ†æ</li>
<li>ç”¨<cls>è¾“å‡ºåˆ†ç±»ç»“æœï¼Œç”¨<sep>åˆ†éš”å¥å­</li>
</ul>
</li>
<li>Extraction-based Question Answering: åŸºäºå·²æœ‰æ–‡æœ¬çš„é—®ç­”ç³»ç»Ÿ<ul>
<li>ç­”æ¡ˆä¸€å®šæ˜¯å‡ºç°åœ¨æ–‡ç« é‡Œé¢çš„</li>
<li>è¾“å…¥æ–‡ç« å’Œé—®é¢˜çš„å‘é‡</li>
<li>è¾“å‡ºä¸¤ä¸ªæ•°å­—(start, end)ï¼Œè¡¨ç¤ºç­”æ¡ˆåœ¨æ–‡ç« ä¸­çš„ç´¢å¼•</li>
</ul>
</li>
</ol>
<p>QAè¾“å‡ºï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/af1aa0bae691c8837e101c1a4d97c30f.png" alt=""/></figure><p>æ€è·¯ï¼š</p><ol>
<li>ç”¨<cls>input<sep>document çš„æ ¼å¼æŠŠè¾“å…¥æ‘†å¥½</li>
<li>ç”¨pre-trainedçš„bertæ¨¡å‹è¾“å‡ºåŒæ ·ä¸ªæ•°çš„å‘é‡</li>
<li>å‡†å¤‡ä¸¤ä¸ªä¸bertæ¨¡å‹ç­‰é•¿çš„å‘é‡ï¼ˆæ¯”å¦‚768ç»´ï¼‰a, bï¼ˆrandom initialized)</li>
<li>aä¸documentçš„æ¯ä¸ªå‘é‡ç›¸ä¹˜(inner product)</li>
<li>softmaxåï¼Œæ‰¾åˆ°æœ€å¤§å€¼ï¼Œå¯¹åº”çš„ä½ç½®(argmax)å³ä¸ºstart index</li>
<li>åŒæ ·çš„äº‹bå†åšä¸€éï¼Œå¾—åˆ°end index</li>
</ol>
<figure  style="flex: 131.07822410147992" ><img width="1240" height="473" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/5fb69b6f706227e3cc81eaa740c28606.png" alt=""/></figure><h3>Bert train seq2seq</h3>
<p>ä¹Ÿæ˜¯å¯èƒ½çš„ã€‚å°±æ˜¯ä½ æŠŠè¾“å…¥â€œå¼„åâ€ï¼Œæ¯”å¦‚å»æ‰ä¸€äº›å­—è¯ï¼Œæ‰“ä¹±è¯åºï¼Œå€’è½¬ï¼Œæ›¿æ¢ç­‰ä»»æ„æ–¹å¼ï¼Œè®©ä¸€ä¸ªdecoderæŠŠå®ƒè¿˜åŸã€‚ -&gt; <strong>BART</strong></p><h3>é™„åŠ çŸ¥è¯†</h3>
<p>æœ‰ç ”ç©¶äººå‘˜ç”¨bertå»åˆ†ç±»DNAï¼Œè›‹ç™½è´¨ï¼ŒéŸ³ä¹ã€‚ä»¥DNAä¸ºä¾‹ï¼Œå…ƒç´ ä¸ºA,C,G,T,åˆ†åˆ«å¯¹åº”4ä¸ªéšæœºè¯æ±‡ï¼Œå†ç”¨bertå»åˆ†ç±»ï¼ˆç”¨ä¸€ä¸ªè‹±æ–‡çš„pre-trained modelï¼‰ï¼ŒåŒæ ·çš„ä¾‹å­ç”¨åœ¨äº†è›‹ç™½è´¨å’ŒéŸ³ä¹ä¸Šï¼Œå±…ç„¶å‘ç°æ•ˆæœå…¨éƒ¨è¦å¥½äºâ€œçº¯éšæœºâ€ã€‚</p><p>å¦‚æœä¹‹å‰çš„å®éªŒè¯´æ˜äº†bertçœ‹æ‡‚äº†æˆ‘ä»¬çš„æ–‡ç« ï¼Œé‚£ä¹ˆè¿™ä¸ªè’è¯çš„å®éªŒï¼ˆç”¨å®Œå…¨æ— å…³çš„éšæ„çš„è‹±æ–‡å•è¯ä»£æ›¿å¦ä¸€å­¦ç§‘é‡Œé¢çš„ç±»åˆ«ï¼‰ä¼¼ä¹è¯æ˜äº†äº‹æƒ…æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚</p><h3>More</h3>
<ol>
<li><a href="https://youtu.be/1_gRK9EIQpc">https://youtu.be/1_gRK9EIQpc</a></li>
<li><a href="https://youtu.be/Bywo7m6ySlk">https://youtu.be/Bywo7m6ySlk</a></li>
</ol>
<h2>Multi-lingual Bert</h2>
<p>ç•¥</p><h2>GPT-3</h2>
<p>è®­ç»ƒæ˜¯predict next token...so it can do generation(èƒ½åšç”Ÿæˆ)</p><blockquote>
<p>Language Model éƒ½èƒ½åšgeneration</p></blockquote>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/a4687a3585d0e42cada14edb4d3d0890.png" alt=""/></figure><p><a href="https://youtu.be/DOG1L9lvsDY">https://youtu.be/DOG1L9lvsDY</a></p><p>åˆ«çš„æ¨¡å‹æ˜¯pre-trainåï¼Œå†fine-tuneï¼Œ GPT-3æ˜¯æƒ³å®ç°zero-shotï¼Œ</p><h3>Image</h3>
<p><strong>SimCLR</strong></p><ul>
<li><a href="https://arxiv.org/abs/2002.05709">https://arxiv.org/abs/2002.05709</a></li>
<li><a href="https://github.com/google-research/simclr">https://github.com/google-research/simclr</a></li>
</ul>
<p><strong>BYOL</strong></p><ul>
<li><strong>B</strong>ootstrap <strong>y</strong>our <strong>o</strong>own <strong>l</strong>atent</li>
<li><a href="https://arxiv.org/abs/2006.07733">https://arxiv.org/abs/2006.07733</a></li>
</ul>
<h3>Speech</h3>
<p>åœ¨bertä¸Šæœ‰ä¹ä¸ªä»»åŠ¡(GLUE)æ¥å·®åˆ«æ•ˆæœå¥½ä¸å¥½ï¼Œåœ¨speeché¢†åŸŸè¿˜ç¼ºä¹è¿™æ ·çš„æ•°æ®åº“ã€‚</p><h2>Auto Encoder</h2>
<p>ä¹Ÿæ˜¯ä¸€ç§<code>self-supervised</code> Learning Framework -&gt; ä¹Ÿå« pre-train, å›é¡¾ï¼š
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/6d2689336625e12011479fa23633aa94.png" alt=""/></figure></p><p>åœ¨è¿™ä¸ªä¹‹å‰ï¼Œå…¶å®æœ‰ä¸ªæ›´å¤è€çš„ä»»åŠ¡ï¼Œå®ƒå°±æ˜¯<code>Auto Encoder</code></p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/b5667c49d1673c62d5fdbb794fd32053.png" alt=""/></figure><ul>
<li>ç”¨å›¾åƒä¸ºä¾‹ï¼Œé€šè¿‡ä¸€ä¸ªç½‘ç»œencodeæˆä¸€ä¸ªå‘é‡åï¼Œå†é€šè¿‡ä¸€ä¸ªç½‘ç»œè§£ç (reconstrucion)å›è¿™å¼ å›¾åƒï¼ˆå“ªæ€•æœ‰ä¿¡æ¯ç¼ºå¤±ï¼‰</li>
<li>ä¸­é—´ç”Ÿæˆçš„é‚£ä¸ªå‘é‡å¯ä»¥ç†è§£ä¸ºå¯¹åŸå›¾è¿›è¡Œçš„å‹ç¼©</li>
<li>æˆ–è€…è¯´ä¸€ç§é™ç»´</li>
</ul>
<p>é™ç»´çš„è¯¾ç¨‹ï¼š</p><ul>
<li>PCA: <a href="https://youtu.be/iwh5o_M4BNU">https://youtu.be/iwh5o_M4BNU</a></li>
<li>t-SNE: <a href="https://youtu.be/GBUEjkpoxXc">https://youtu.be/GBUEjkpoxXc</a></li>
</ul>
<p>æœ‰ä¸€ä¸ªde-noisingçš„Auto-encoder, ç»™å…¥çš„æ˜¯åŠ äº†å™ªéŸ³çš„æ•°æ®ï¼Œç»è¿‡encode-decodeä¹‹åè¿˜åŸçš„æ˜¯æ²¡æœ‰åŠ å™ªéŸ³çš„æ•°æ®</p><p>è¿™å°±åƒåŠ äº†å™ªéŸ³å»è®­ç»ƒbert</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/db0ed507503f41304ead7808d285a7f8.png" alt=""/></figure><h3>Feature Disentangle</h3>
<p>å»è§£é‡Šauto-encoderå‹æˆçš„å‘é‡å°±å«<code>Feature Disentagle</code>ï¼Œæ¯”å¦‚ä¸€æ®µéŸ³é¢‘ï¼Œå“ªäº›æ˜¯å†…å®¹ï¼Œå“ªäº›æ˜¯äººç‰©ï¼›ä¸€æ®µæ–‡å­—ï¼Œå“ªäº›è¡¨ç¤ºè¯­ä¹‰ï¼Œå“ªäº›æ˜¯è¯­æ³•ï¼›ä¸€å¼ å›¾ç‰‡ï¼Œå“ªäº›è¡¨ç¤ºç‰©ä½“ï¼Œå“ªäº›è¡¨ç¤ºçº¹ç†ï¼Œç­‰ã€‚</p><p>åº”ç”¨ï¼š voice conversion -&gt; å˜å£°å™¨</p><p>ä¼ ç»Ÿçš„åšæ³•åº”è¯¥æ˜¯æ¯ä¸€ä¸ªè¯­å¥ï¼Œéƒ½æœ‰ä¸¤ç§è¯­éŸ³çš„èµ„æ–™ï¼ŒNç§è¯­è¨€/è¯­éŸ³çš„è¯ï¼Œå°±éœ€è¦Nä»½ã€‚æœ‰Feature Disentangleçš„è¯ï¼Œåªè¦æœ‰ä¸¤ç§è¯­éŸ³çš„encoderï¼Œå°±èƒ½çŸ¥é“å“ªäº›æ˜¯è¯­éŸ³ç‰¹å¾ï¼Œå“ªäº›æ˜¯å†…å®¹ç‰¹å¾ï¼Œæ‹¼èµ·æ¥ï¼Œå°±èƒ½ç”¨Açš„è¯­éŸ³å»è¯»Bçš„å†…å®¹ã€‚æ‰€ä»¥<strong>å‰æ</strong>å°±æ˜¯èƒ½åˆ†æå‹ç¼©å‡ºæ¥çš„å‘é‡ã€‚</p><h3>Discrete Latent Representation</h3>
<p>å¦‚æœå‹ç¼©æˆçš„å‘é‡ä¸æ˜¯å®æ•°ï¼Œè€Œæ˜¯ä¸€ä¸ªbinaryæˆ–one-hot</p><ul>
<li>binary: æ¯ä¸€ä¸ªç»´åº¦å‡ ä¹éƒ½æœ‰å®ƒçš„å«ä¹‰ï¼Œæˆ‘ä»¬åªéœ€è¦çœ‹å®ƒæ˜¯0è¿˜æ˜¯1</li>
<li>one-hot: ç›´æ¥å˜åˆ†ç±»äº†ã€‚-&gt; <code>unsupervised classification</code></li>
</ul>
<p><strong>VQVAE</strong></p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/7d4061daabfdfcf415de004a69a1636b.png" alt=""/></figure><ul>
<li>Vector Quantized Variational Auot-encoder <a href="https://arxiv.org/abs/1711.00937">https://arxiv.org/abs/1711.00937</a></li>
</ul>
<h3>Text as Representation</h3>
<ul>
<li><a href="https://arxiv.org/abs/1810.02851">https://arxiv.org/abs/1810.02851</a></li>
</ul>
<p>å¦‚æœå‹ç¼©æˆçš„ä¸æ˜¯ä¸€ä¸ªå‘é‡ï¼Œè€Œä¹Ÿæ˜¯ä¸€æ®µ<code>word sequence</code>ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±æˆäº†<code>summary</code>çš„ä»»åŠ¡ï¼Ÿ åªè¦encoderå’Œdecoderéƒ½æ˜¯seq2seqçš„model</p><p>-&gt; seq2seq2seq auto-encoder -&gt; <code>unsupervised summarization</code></p><p>äº‹å®ä¸Šè®­ç»ƒçš„æ—¶å€™encoderå’Œdecoderå¯èƒ½äº§ç”Ÿå¼ºå…³è”ï¼Œè¿™ä¸ªæ—¶å€™å°±å¼•å…¥ä¸€ä¸ªé¢å¤–çš„<code>discriminator</code>æ¥ä½œåˆ¤åˆ«:
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/e470d48770f1cee066eca5b76e49e983.png" alt=""/></figure></p><p>æœ‰ç‚¹åƒcycle GANï¼Œä¸€ä¸ªgeneratoræ¥ä¸€ä¸ªdiscriminatorï¼Œå†æ¥å¦ä¸€ä¸ªgenerator</p><h3>abnormal detection</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/d8a6da742b367ace4528d833cb8623fa.png" alt=""/></figure><ul>
<li>Part 1: <a href="https://youtu.be/gDp2LXGnVLQ">https://youtu.be/gDp2LXGnVLQ</a></li>
<li>Part 2: <a href="https://youtu.be/cYrNjLxkoXs">https://youtu.be/cYrNjLxkoXs</a></li>
<li>Part 3: <a href="https://youtu.be/ueDlm2FkCnw">https://youtu.be/ueDlm2FkCnw</a></li>
<li>Part 4: <a href="https://youtu.be/XwkHOUPbc0Q">https://youtu.be/XwkHOUPbc0Q</a></li>
<li>Part 5: <a href="https://youtu.be/Fh1xFBktRLQ">https://youtu.be/Fh1xFBktRLQ</a></li>
<li>Part 6: <a href="https://youtu.be/LmFWzmn2rFY">https://youtu.be/LmFWzmn2rFY</a></li>
<li>Part 7: <a href="https://youtu.be/6W8FqUGYyDo">https://youtu.be/6W8FqUGYyDo</a></li>
</ul>
</div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-3/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-1/" target="_self">æå®æ¯…MACHINE LEARNING 2021 SPRINGç¬”è®°[1]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-1/" target="_self">
                <time class="text-uppercase">
                    October 13 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><blockquote>
<p>çº¯å¬è¯¾æ—¶ä¸€äº›æ€è·¯å’Œç¬”è®°ï¼Œæ²¡æœ‰æ•™ç¨‹ä½œç”¨ã€‚
è¿™ä¸ªè¯¾ç¨‹åé¢å°±æ¯”è¾ƒæ°´äº†ï¼Œå¤§é‡çš„å…¨æ˜¯ä»‹ç»æ€§çš„ä¸œè¥¿ï¼Œä¹Ÿç½—åˆ—äº†å¤§é‡çš„æ—¢å¾€è¯¾ç¨‹å’Œè®ºæ–‡ï¼Œå¦‚æœä½ åœ¨å·¥ä½œè¿‡ç ”ç©¶ä¸­ç¢°åˆ°äº†å®ƒæè¿‡çš„åœºæ™¯æˆ–é—®é¢˜ï¼Œå€’æ˜¯å¯ä»¥æŠŠå®ƒä½œç´¢å¼•ç”¨ã€‚</p></blockquote>
<h1>Linear Model</h1>
<h2>Piecewise Linear</h2>
<p>çº¿æ€§æ¨¡å‹æ°¸è¿œåªæœ‰ä¸€æ¡ç›´çº¿ï¼Œé‚£ä¹ˆå¯¹äºæŠ˜çº¿ï¼ˆæ›²çº¿ï¼‰ï¼Œèƒ½æ€æ ·æ›´å¥½åœ°å»ºæ¨¡å‘¢ï¼Ÿè¿™é‡Œè€ƒè™‘ä¸€ç§æ–¹æ³•ï¼Œ</p><ol>
<li>ç”¨ä¸€ä¸ª<code>å¸¸æ•°</code>åŠ ä¸€ä¸ª<code>æ•´æµå‡½æ•°</code><ul>
<li>å³å·¦å³ä¸¤ä¸ªé˜ˆå€¼å¤–yå€¼ä¸éšxå€¼å˜åŒ–ï¼Œé˜ˆå€¼å†…æ‰æ˜¯çº¿æ€§å˜åŒ–ï¼ˆå¤©ç”Ÿå°±æ‹¥æœ‰ä¸¤ä¸ªæŠ˜è§’ï¼‰ã€‚</li>
</ul>
</li>
<li>æ¯ä¸€ä¸ªè½¬æŠ˜ç‚¹åŠ ä¸€ä¸ªæ–°çš„æ•´æµå‡½æ•°</li>
</ol>
<p>å¦‚ä¸‹ï¼š
<figure  style="flex: 66.625" ><img width="1066" height="800" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/bc1ab298834013a9304c0c6939d2406b.png" alt=""/></figure></p><p>å¦‚æœæ˜¯æ›²çº¿ï¼Œä¹Ÿå¯ä»¥è¿‘ä¼¼åœ°ç†è§£ä¸ºæ•°ä¸ªæŠ˜çº¿æ„æˆçš„ï¼ˆå–å†³äºè¿‘ä¼¼çš„ç²¾åº¦ï¼‰ï¼Œè€Œè“è‰²çš„æ•´æµå‡½æ•°ä¸å¥½è¡¨ç¤ºï¼Œäº‹å®ä¸Šæœ‰sigmoidå‡½æ•°ä¸å®ƒéå¸¸æ¥è¿‘ï¼ˆå®ƒæ˜¯æ›²çº¿ï¼‰ï¼Œæ‰€ä»¥è“çº¿åˆå¯ä»¥å«ï¼š<code>Hard Sigmoid</code></p><p>æ‰€ä»¥ï¼Œæœ€ç»ˆæˆäº†ä¸€ä¸ªå¸¸æ•°(<code>bias</code>)å’Œæ•°ä¸ª<code>sigmoid</code>å‡½æ•°æ¥é€¼è¿‘çœŸå®çš„æ›²çº¿ã€‚åŒæ—¶ï¼Œæ¯ä¸€ä¸ªè½¬æŠ˜ç‚¹<code>i</code>ä¸Šså‡½æ•°çš„å…·ä½“å½¢çŠ¶ï¼ˆæ¯”å¦‚æœ‰å¤šæ–œå¤šé«˜ï¼‰ï¼Œå°±ç”±ä¸€ä¸ªæ–°çš„çº¿æ€§å˜æ¢æ¥æ§åˆ¶ï¼š$b_i + w_ix_n$ï¼ŒæŠŠ<code>i</code>ä¸Š<strong>ç´¯ç§¯çš„çº¿æ€§å˜æ¢</strong>ç´¯åŠ ï¼Œå°±å¾—åˆ°ä¸$x_n$æœ€å¯èƒ½é€¼è¿‘çš„æ›²çº¿ã€‚</p><p>ä¸‹å›¾æ¼”ç¤ºäº†3ä¸ªè½¬æŠ˜ç‚¹çš„æƒ…å†µï¼š</p><figure  style="flex: 66.625" ><img width="1066" height="800" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/1d785e5ce2165596c3ebeb09fc8fc48b.png" alt=""/></figure><p>è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„å¯¹b,wä¾èµ–çš„å‡½æ•°å˜æˆäº†å¯¹ï¼ˆ$w_i, b_i, c_i$)å’Œ, x, bçš„ä¾èµ–ï¼Œå³å¤šäº†å¾ˆå¤šå˜é‡ã€‚</p><ul>
<li>$y = b + wx_1$</li>
<li>$y = b + \sum_i c_i sigmoid(b_i + w_i x_{\color{red} 1})$</li>
</ul>
<p>æ³¨æ„è¿™ä¸ª$x_1$ï¼Œå³åªè½¬äº†ä¸€ä¸ªxå°±è¦å †ä¸€ä¸ª<code>sum</code>ï¼Œè€Œç›®å‰ä¹Ÿåªæ˜¯æ¼”ç¤ºäº†åªæœ‰ä¸€ä¸ªç‰¹å¾çš„æƒ…å†µã€‚</p><p>å¦‚æœæ›´å¤æ‚ä¸€ç‚¹çš„æ¨¡å‹ï¼Œæ¯æ¬¡ä¸æ˜¯çœ‹ä¸€ä¸ªxï¼Œè€Œçœ‹nä¸ªxï¼Œï¼ˆæ¯”å¦‚åˆ©ç”¨å‰7å¤©çš„è§‚çœ‹æ•°æ®æ¥é¢„æµ‹ç¬¬8å¤©çš„ï¼Œé‚£ä¹ˆå»ºæ¨¡çš„æ—¶å€™å°±æ˜¯æ¯ä¸€ä¸ªæ•°éƒ½è¦ä¸å‰7å¤©çš„æ•°æ®å»ºç«‹wå’Œbçš„å…³ç³»ï¼‰ï¼š</p><blockquote>
<p>å…¶å®å°±æ˜¯ç”±ä¸€ä¸ªfeatureå˜æˆäº†nä¸ªfeatureäº†ï¼Œä¸€èˆ¬çš„æ•™æä¼šç”¨ä¸åŒçš„featureæ¥è®²è§£ï¼ˆæ¯”å¦‚å½±å“æˆ¿ä»·çš„é™¤äº†æ—¶é—´ï¼Œè¿˜æœ‰é¢ç§¯ï¼Œåœ°æ®µç­‰ç­‰ï¼‰ï¼Œè€Œè¿™é‡Œåªæ˜¯å¢åŠ äº†å¤©æ•°ï¼Œå¯èƒ½ä¼šè®©äººæ²¡æœ‰ç«‹åˆ»å¼„æ¸…æ¥šä¸¤è€…å…¶å®æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚å…¶å®å°±æ˜¯x1, x2, x3...ä¸ç®¡å®ƒä»¬å¯¹åº”çš„æ˜¯åŒä¸€<strong>ç±»</strong>ç‰¹å¾ï¼Œè€Œæ˜¯å®Œå…¨ä¸åŒçš„å¤šä¸ª<strong>è§’åº¦</strong>çš„ç‰¹å¾ã€‚</p></blockquote>
<p>ç°åœ¨å°±æœ‰ä¸€å †$wx$äº†</p><ul>
<li>$y = b + \sum_j w_j x_j$</li>
<li>ç°åœ¨å°±å˜æˆäº†(æ³¨æ„ï¼Œå…¶å®å°±æ˜¯æŠŠåŠ å·å³è¾¹å®Œæ•´ä»£å…¥ï¼‰ï¼š</li>
<li>$y = b + \sum_i c_i sigmoid(b_i + \color{red}{\sum_j w_{ij} x_j})$</li>
</ul>
<p>å±•å¼€è®¡ç®—ï¼Œå†æ ¹æ®ç‰¹å¾ï¼Œåˆå¯ä»¥çœ‹å›çŸ©é˜µäº†ï¼ˆè€Œä¸æ˜¯ä»çŸ©é˜µå‡ºå‘æ¥æ€è€ƒï¼‰ï¼š</p><figure class="vertical-figure" style="flex: 33.29129886506936" ><img width="1056" height="1586" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/a84ecec9786db279d55ff5ecbb1a8124.png" alt=""/></figure><p>çŸ©é˜µè¿ç®—ç»“æœä¸º(r)ï¼Œå†sigmoidåï¼Œè®¾ç»“æœä¸ºa:</p><ul>
<li>$a_i = c_i \sigma(r_i)$</li>
<li>$y = b + \sum_i a_i$ c å’Œ aè¦ä¹˜åŠ ï¼Œä»ç„¶å¯ä»¥çŸ©é˜µåŒ–ï¼ˆå…¶å®æ˜¯å‘é‡åŒ–ï¼‰ï¼š</li>
<li>$y = b + c^T a$ï¼Œ æŠŠä¸Šé¢çš„å±•å¼€å›å»ï¼š</li>
<li>$y = b + c^T \sigma(\bold b + W x)$<ul>
<li>å‰åä¸¤ä¸ªbæ˜¯ä¸åŒçš„ï¼Œä¸€ä¸ªæ˜¯æ•°å€¼ï¼Œä¸€ä¸ªæ˜¯å‘é‡</li>
</ul>
</li>
</ul>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠç›®å‰æ‰€æœ‰çš„â€œæœªçŸ¥æ•°â€å…¨éƒ¨æ‹‰å¹³æ‹¼æˆäº†ä¸€ä¸ªå‘é‡ $\theta$ï¼š
<figure  style="flex: 66.625" ><img width="1066" height="800" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/961de3efa8dcf472170d57c5e60f2fc4.png" alt=""/></figure></p><p>è¿™é‡Œï¼Œå¦‚æœæŠŠ$c^T$å†™æˆ<code>W'</code>ä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬å·²ç»æ¨å¯¼å‡ºäº†ä¸€ä¸ª2å±‚çš„ç¥ç»ç½‘ç»œï¼šä¸€ä¸ªéšå±‚ï¼Œä¸€ä¸ªè¾“å‡ºå±‚ï¼š</p><ul>
<li>b+wx æ˜¯ç¬¬ä¸€å±‚ å¾—åˆ°<code>a</code></li>
<li>å¯¹<code>a</code>è¿›è¡Œä¸€æ¬¡sigmoidï¼ˆåˆ«çš„æ•™æé‡Œä¼šè¯´æ˜¯æ¿€æ´»ï¼‰å¾—åˆ°<code>a'</code></li>
<li>æŠŠ<code>a'</code>å½“ä½œè¾“å…¥ï¼Œå†è¿›è¡Œä¸€æ¬¡ b+wx (è¿™å°±æ˜¯éšå±‚äº†)</li>
<li>å¾—åˆ°çš„è¾“å‡ºå°±æ˜¯ç½‘ç»œçš„è¾“å‡º<code>o</code></li>
</ul>
<blockquote>
<p>è¿™é‡Œåœ¨ç”¨å¦ä¸€ä¸ªè§’åº¦æ¥å°è¯•è§£é‡Šç¥ç»ç½‘ç»œï¼Œæ¿€æ´»å‡½æ•°ç­‰ï¼Œä½†è¦æ³¨æ„ï¼Œsigmoidçš„å¼•å…¥åŸæœ¬æ˜¯å»â€å¯¹ç€æŠ˜çº¿æâ€œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯äººä¸ºé€‰æ‹©çš„ï¼Œè€Œè¿™é‡Œä»ç„¶å˜æˆäº†æœºå™¨å»â€å­¦ä¹ â€œï¼Œå³æ²¡æœ‰å‘Šè¯‰å®ƒå“ªäº›åœ°æ–¹æ˜¯è½¬æŠ˜ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´æœ‰ç‚¹é™·å…¥äº†ç”¨æœºå™¨å­¦ä¹ è§£é‡Šæœºå™¨å­¦ä¹ çš„æƒ…å†µã€‚</p></blockquote>
<blockquote>
<p>ä½†æ˜¯å¦‚æœæ˜¯çº¯æ›²çº¿ï¼Œé‚£ä¹ˆå…¶å®æ˜¯å¯ä»¥æ— æ•°ä¸ªsigmoidæ¥ç»„åˆçš„ï¼Œå°±ä¸å­˜åœ¨è¦å»æ‹ŸåˆæŸäº›â€œç‰¹å®šçš„ç‚¹â€ï¼Œé‚£æ ·åªè¦æ‰¾åˆ°æœ€åˆé€‚â€œæ•°é‡â€çš„sigmoigå°±è¡Œäº†ï¼ˆå› ä¸ºä»»ä½•ä¸€ä¸ªç‚¹éƒ½å¯ä»¥ç®—æ˜¯æŠ˜ç‚¹ï¼‰</p></blockquote>
<h2>Loss</h2>
<p>loss æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œä»æ—§æ˜¯ä¸€å †$\theta$ä»£å…¥åæ±‚çš„å€¼ä¸yçš„å·®ï¼Œæ±‚å’Œã€‚å¹¶æœŸæœ›æ‰¾åˆ°ä½¿lossæœ€å°åŒ–çš„$\theta$ï¼š</p><p>$\bold \theta = arg\ \underset{\theta}{min}\ L$</p></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-1/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-2/" target="_self">æå®æ¯…MACHINE LEARNING 2021 SPRINGç¬”è®°[2]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-2/" target="_self">
                <time class="text-uppercase">
                    October 13 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><h1>Optimization</h1>
<p>çœŸå®ä¸–ç•Œè®­ç»ƒæ ·æœ¬ä¼šå¾ˆå¤§ï¼Œ</p><ul>
<li>æˆ‘ä»¬å¾€å¾€ä¸ä¼šæŠŠæ•´ä¸ªæ‰€æœ‰æ•°æ®ç›´æ¥ç®—ä¸€æ¬¡lossï¼Œæ¥è¿­ä»£æ¢¯åº¦ï¼Œ</li>
<li>è€Œæ˜¯åˆ†æˆå¾ˆå¤šå°ä»½(mini-batch)æ¯ä¸€å°ä»½è®¡ç®—ä¸€æ¬¡lossï¼ˆç„¶åè¿­ä»£æ¢¯åº¦ï¼‰</li>
<li>ä¸‹ä¸€ä¸ªå°batchè®¤å‰ä¸€æ¬¡è¿­ä»£çš„ç»“æœ</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å®è¿™æ˜¯ä¸€ä¸ªä¸ä¸¥è°¨çš„è¿­ä»£ï¼Œç”¨åˆ«äººæ•°æ®çš„ç»“æœæ¥å½“æˆæœ¬è½®æ•°æ®çš„å‰æ<ul>
<li>æœ€å‡†ç¡®çš„å½“ç„¶æ˜¯æ‰€æœ‰æ•°æ®è®¡ç®—æ¢¯åº¦å’Œè¿­ä»£ã€‚</li>
<li>ä¸€å®šè¦æ‰¾è¡¥çš„è¯ï¼Œå¯ä»¥è¿™ä¹ˆè®¤ä¸ºï¼š<ul>
<li>å³ä½¿ä¸€ä¸ªå°batchï¼Œä¹Ÿæ˜¯å¯ä»¥è®­ç»ƒåˆ°åˆç†çš„å‚æ•°çš„</li>
<li>æ‰€ä»¥å‰ä¸€ä¸ªbatchè®­ç»ƒå‡ºæ¥çš„æ•°æ®ï¼Œæ˜¯ä¸€å®šç¨‹åº¦ä¸Šåˆç†çš„</li>
<li>ç°åœ¨æ¢äº†æ–°çš„æ•°æ®ï¼Œä½†ä¿æŒä¸Šä¸€è½®çš„å‚æ•°ï¼Œåè€Œå¯ä»¥é˜²æ­¢<code>è¿‡æ‹Ÿåˆ</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<figure  style="flex: 66.625" ><img width="1066" height="800" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/a5c3447aeea455b8aea110482cbcd750.png" alt=""/></figure><p>minibatchè¿˜æœ‰ä¸€ä¸ªæç«¯å°±æ˜¯batchsize=1ï¼Œå³æ¯æ¬¡çœ‹å®Œä¸€æ¡æ•°æ®å°±ä¸çœŸå€¼åšlossï¼Œè¿™å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œè€Œä¸”å®ƒéå¸¸å¿«ã€‚ä½†æ˜¯ï¼š</p><ol>
<li>å°batchè™½ç„¶å¿«ï¼Œä½†æ˜¯å®ƒéå¸¸noisyï¼ˆåŠæ¯ä¸€ç¬”æ•°æ®éƒ½æœ‰å¯èƒ½æ˜¯ä¸ªä¾‹ï¼Œæ²¡æœ‰å…¶å®ƒæ•°æ®æ¥æŠµæ¶ˆå®ƒçš„å½±å“ï¼‰</li>
<li>å› ä¸ºæœ‰gpuå¹³è¡Œè¿ç®—çš„åŸå› ï¼Œåªè¦ä¸æ˜¯batchéå¸¸å¤§ï¼ˆæ¯”å¦‚10000ä»¥ä¸Šï¼‰ï¼Œå…¶å®mini-batchå¹¶ä¸æ…¢</li>
<li>å¦‚æœæ˜¯å°æ ·æœ¬ï¼Œmini-batchåè€Œæ›´å¿«ï¼Œå› ä¸ºå®ƒä¸€æ¥å¯ä»¥å¹³è¡Œè¿ç®—ï¼Œåœ¨è®¡ç®—gradientçš„æ—¶å€™ä¸æ¯”å°batchæ…¢ï¼Œä½†æ˜¯å®ƒæ¯”å°batchè¦å°å‡ ä¸ªæ•°é‡çº§çš„update.</li>
</ol>
<p>ä»ç„¶æœ‰ä¸ªä½†æ˜¯ï¼šå®éªŒè¯æ˜å°çš„batch sizeä¼šæœ‰æ›´é«˜çš„å‡†ç¡®ç‡ã€‚
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/5ff5b42e644a35896a5ff9419e005465.png" alt=""/></figure></p><p>ä¸¤ä¸ªlocal minimalï¼Œå³è¾¹é‚£ä¸ªè®¤ä¸ºæ˜¯ä¸å¥½çš„ï¼Œå› ä¸ºå®ƒåªè¦æœ‰ä¸€ç‚¹åå·®ï¼Œä¸çœŸå€¼å°±ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚ä½†æ˜¯æ²¡æ‡‚ä¸ºä»€ä¹ˆå¤§çš„batchä¼šæ›´å®¹æ˜“è½åœ¨å³è¾¹ã€‚</p><p>è¿™æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿå…¶å®æ˜¯optimizationçš„é—®é¢˜ï¼Œåé¢ä¼šç”¨ä¸€äº›æ–¹æ³•æ¥è§£å†³ã€‚</p><h2>Sigmoid -&gt; RelU</h2>
<p>å‰é¢æˆ‘ä»¬ç”¨äº†softçš„æŠ˜çº¿æ¥æ¨¡æ‹ŸæŠ˜çº¿ï¼Œå…¶å®è¿˜å¯ä»¥å åŠ ä¸¤ä¸ªçœŸçš„æŠ˜çº¿(<code>ReLU</code>)ï¼Œè¿™æ‰æ˜¯æˆ‘ä¸€ç›´è¯´çš„<code>æ•´æµå‡½æ•°</code>çš„åå­—çš„ç”±æ¥ã€‚</p><figure  style="flex: 66.625" ><img width="1066" height="800" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/dad7e4a61c95964819eb135b85290edf.png" alt=""/></figure><p>ä»”ç»†çœ‹å›¾ï¼Œcå’Œc'åœ¨ç¬¬äºŒä¸ªè½¬æŠ˜çš„å³è¾¹ï¼Œä¸€ä¸ªæ˜¯å‘æ— ç©·å¤§å˜ï¼Œä¸€ä¸ªæ˜¯å‘æ— ç©·å°å˜ï¼Œåªè¦æ‰¾åˆ°åˆç†çš„æ–œç‡ï¼Œå°±èƒ½æŠµæ¶ˆæ‰ä¸¤ä¸ªè¶‹åŠ¿ï¼Œå˜æˆä¸€æ¡ç›´çº¿ã€‚</p><p>å¦‚æœè¦ç”¨ReLUï¼Œé‚£ä¹ˆç®€å•æ›¿æ¢ä¸€ä¸‹ï¼š</p><ul>
<li>$y = b + \sum_i {\color{ccdd00}{c_i}} sigmoid(\color{green}{b_i} + \sum_j \color{blue}{w_{ij}} x_j)$</li>
<li>$y = b + \sum_{\color{red}2i} {\color{ccdd00}{c_i}} \color{red}{max}(\color{red}0,\ \color{green}{b_i} + \sum_j \color{blue}{w_{ij}} x_j)$</li>
</ul>
<p>çº¢è‰²çš„å³ä¸ºæ”¹åŠ¨çš„éƒ¨åˆ†ï¼Œä¹Ÿå‘¼åº”äº†2ä¸ªreluæ‰æ„æˆä¸€ä¸ªsigmoidçš„é“ºå«ã€‚</p><p>æŠŠæ¯ä¸€ä¸ªaå½“æˆä¹‹å‰çš„xï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å¥—ä¸Šæ–°çš„w,b,cç­‰ï¼Œç”Ÿæˆæ–°çš„a-&gt;a'
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/fe56169175a358925eb1493eef7511a9.png" alt=""/></figure></p><figure  style="flex: 52.01793721973094" ><img width="928" height="892" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/565aa95b1ba87a098f82bb221977d8f1.png" alt=""/></figure><p>è€Œå¦‚æœå†å ä¸€å±‚ï¼Œåœ¨è¯¾ç¨‹é‡Œçš„èµ„æ–™é‡Œï¼Œåœ¨è®­ç»ƒé›†ä¸Šlossä»ç„¶èƒ½ä¸‹é™ï¼ˆåˆ°0.1ï¼‰ï¼Œä½†æ˜¯åœ¨æµ‹è¯•é›†é‡Œï¼Œlossåè€Œä¸Šå‡äº†ï¼ˆ0.44)ï¼Œè¿™æ„å‘³ç€å¼€å§‹è¿‡æ‹Ÿåˆäº†ã€‚</p><p>è¿™å°±æ˜¯åå‘ä»‹ç»ç¥ç»å…ƒå’Œç¥ç»ç½‘ç»œã€‚å…ˆä»‹ç»æ•°å­¦ä¸Šçš„åŠ¨æœºï¼Œç»„æˆç½‘ç»œåå†å‘Šè¯‰ä½ è¿™æ˜¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯ä¸€ä¸Šæ¥å°±ç»™ä½ æ‰¯ä»€ä¹ˆæ˜¯ç¥ç»å…ƒä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Œå†æ¥è§£é‡Šæ¯ä¸€ä¸ªç¥ç»å…ƒå¹²äº†ä»€ä¹ˆã€‚</p><p>è€Œä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œè¯¾ç¨‹é‡Œï¼Œsigmoidæ˜¯åœ¨é€»è¾‘å›å½’é‡Œæ‰å¼•å…¥çš„ï¼Œæ˜¯ä¸ºäº†æŠŠè¾“å‡ºé™å®šåœ¨1å’Œ0ä¹‹é—´ã€‚æ˜¾ç„¶è¿™é‡Œçš„ç›®çš„ä¸æ˜¯è¿™æ ·çš„ï¼Œæ˜¯ä¸ºäº†ç”¨è¶³å¤Ÿå¤šçš„sigmoidæˆ–reluæ¥é€¼è¿‘çœŸå®çš„æ›²çº¿ï¼ˆæŠ˜çº¿ï¼‰</p><h2>Framework of ML</h2>
<h3>é€šç”¨æ­¥éª¤ï¼š</h3>
<ol>
<li>è®¾å®šä¸€ä¸ªå‡½æ•°æ¥æè¿°é—®é¢˜$y = f_\theta(x)$, å…¶ä¸­$\theta$å°±æ˜¯æ‰€æœ‰æœªçŸ¥æ•°ï¼ˆå‚æ•°ï¼‰</li>
<li>è®¾å®šä¸€ä¸ªæŸå¤±å‡½æ•°$L(\theta)$</li>
<li>æ±‚è®©æŸå¤±å‡½æ•°å°½å¯èƒ½å°çš„$\theta^* = arg\ \underset{\theta}{\rm min}L(\theta)$</li>
</ol>
<h3>æ‹Ÿåˆä¸äº†çš„åŸå› ï¼š</h3>
<ol>
<li>è¿‡å¤§çš„lossé€šå¸¸â€œæš—ç¤ºâ€äº†æ¨¡å‹ä¸åˆé€‚ï¼ˆ<strong>model bias</strong>ï¼‰ï¼Œæ¯”å¦‚ä¸Šé¢çš„ç”¨å‰1å¤©æ•°æ®é¢„æµ‹åä¸€å¤©ï¼Œå¯ä»¥å°è¯•æ”¹æˆå‰7å¤©ï¼Œå‰30å¤©ç­‰ã€‚<ul>
<li>å¤§æµ·é‡Œæé’ˆï¼Œé’ˆå…¶å®ä¸åœ¨æµ·é‡Œ</li>
</ul>
</li>
<li>ä¼˜åŒ–é—®é¢˜ï¼Œæ¢¯åº¦ä¸‹é™ä¸åˆ°ç›®æ ‡å€¼<ul>
<li>é’ˆåœ¨å¤§æµ·é‡Œï¼Œæˆ‘å´æ²¡æœ‰åŠæ³•æŠŠå®ƒæ‰¾å‡ºæ¥</li>
</ul>
</li>
</ol>
<h3>å¦‚ä½•åˆ¤æ–­æ˜¯loss optimizationæ²¡åšå¥½ï¼Ÿ</h3>
<p>ç”¨ä¸åŒæ¨¡å‹æ¥æ¯”è¾ƒï¼ˆæ›´ç®€å•çš„ï¼Œæ›´æµ…çš„ï¼‰
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/4a4478c4160c3e330f1d7bdc4ac4b2bb.png" alt=""/></figure></p><p>ä¸Šå›¾ä¸­ï¼Œä¸ºä»€ä¹ˆ56å±‚çš„è¡¨ç°è¿˜ä¸å¦‚20å±‚å‘¢ï¼Ÿæ˜¯<code>overfitting</code>å—ï¼Ÿ<strong>ä¸ä¸€å®š</strong>ã€‚</p><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹åœ¨è®­ç»ƒé›†é‡Œçš„è¡¨ç°ï¼Œ56å±‚å±…ç„¶ä¹Ÿä¸å¦‚20å±‚ï¼Œè¿™åˆç†å—ï¼Ÿ <strong>ä¸åˆç†</strong></p><blockquote>
<p>ä½†å‡¡20å±‚èƒ½åšåˆ°çš„ï¼Œå¤šå‡ºçš„36å±‚å¯ä»¥ç›´æ¥å…¨éƒ¨identityï¼ˆå³å¤åˆ¶å‰ä¸€å±‚çš„è¾“å‡ºï¼‰ï¼Œä¹Ÿä¸å¯èƒ½æ¯”20å±‚æ›´å·®ï¼ˆç¥ç»ç½‘ç»œæ€»å¯ä»¥å­¦åˆ°çš„ï¼‰</p></blockquote>
<p>è¿™æ—¶ï¼Œå°±æ˜¯ä½ çš„loss optimizationæœ‰é—®é¢˜äº†ã€‚</p><h3>å¦‚ä½•è§£å†³overfitting</h3>
<ol>
<li>å¢åŠ æ•°æ®é‡<ul>
<li>å¢åŠ æ•°æ®é‡çš„ç»å¯¹æ•°é‡</li>
<li>data augmentationæ•°æ®å¢å¼ºï¼ˆæ¯”å¦‚åå¤éšæœºä»è®­ç»ƒé›†é‡Œå–ï¼Œæˆ–è€…å¯¹å›¾åƒè¿›è¡Œæ—‹è½¬ç¼©æ”¾ä½ç§»å’Œè£å‰ªç­‰ï¼‰</li>
</ul>
</li>
<li>ç¼©å‡æ¨¡å‹å¼¹æ€§<ul>
<li>ï¼ˆä½æ¬¡å•Šï¼Œæ›´å°‘çš„å‚æ•°ã€Œç‰¹å¾ã€å•Šï¼‰</li>
<li>æ›´å°‘çš„ç¥ç»å…ƒï¼Œå±‚æ•°å•Š</li>
<li>è€ƒè™‘å…±ç”¨å‚æ•°</li>
<li>early stopping</li>
<li>regularization<ul>
<li>è®©æŸå¤±å‡½æ•°ä¸æ¯ä¸ªç‰¹å¾ç³»æ•°ç›´æ¥æŒ‚å‹¾ï¼Œå°±å˜æˆäº†æƒ©ç½šé¡¹</li>
<li>å› ä¸ºå®ƒçš„å€¼è¶Šå¤§ï¼Œä¼šè®©æŸå¤±å‡½æ•°è¶Šå¤§ï¼Œè¿™æ ·å¯ä»¥â€œæƒ©ç½šâ€è¿‡å¤§çš„æƒé‡</li>
</ul>
</li>
<li>dropout<ul>
<li>éšæœºä¸¢å¼ƒä¸€äº›è®¡ç®—ç»“æœ</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2>Missmatch</h2>
<p>è¯¾ä¸Šä¸€ä¸ªæµ‹è¯•ï¼Œé¢„æµ‹2/26çš„è§‚çœ‹äººæ•°ï¼ˆå‘¨äº”ï¼Œå†å²æ•°æ®éƒ½æ˜¯è§‚çœ‹é‡ä½ï¼‰ï¼Œä½†å› ä¸ºå…¬å¼€äº†è¿™ä¸ªæµ‹è¯•ï¼Œå¼•èµ·å¾ˆå¤šäººç–¯ç‹‚ç‚¹å‡»ï¼Œç»“æœé€ æˆäº†è¿™ä¸€å¤©çš„é¢„æµ‹ç»“æœéå¸¸å·®ã€‚</p><p>è¿™ä¸ªä¸å«overfittingï¼Œè€Œæ˜¯<code>mismatch</code>ï¼Œè¡¨ç¤ºçš„æ˜¯<strong>è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ†å¸ƒæ˜¯ä¸ä¸€æ ·çš„</strong></p><p>mismatchçš„é—®é¢˜ï¼Œå†æ€ä¹ˆå¢åŠ æ•°æ®ä¹Ÿæ˜¯ä¸å¯èƒ½è§£å†³çš„ã€‚</p><h2>optimization problems</h2>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜æ²¡æœ‰å¾—åˆ°è§£å†³ï¼š</p><ol>
<li>loss optimizationæœ‰é—®é¢˜æ€ä¹ˆè§£å†³<ul>
<li>å…¶å®å°±æ˜¯åˆ¤æ–­æ˜¯ä¸æ˜¯saddle pointï¼ˆéç‚¹ï¼‰</li>
</ul>
</li>
<li>mismatchæ€ä¹ˆè§£å†³</li>
</ol>
<h3>saddle point</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/71ae2a0cf3a214a3c0660ad34a18874e.png" alt=""/></figure><p>hessiançŸ©é˜µæ˜¯äºŒæ¬¡å¾®åˆ†ï¼Œå½“ä¸€æ¬¡å¾®åˆ†ä¸º0çš„æ—¶å€™ï¼ŒäºŒæ¬¡å¾®åˆ†å¹¶ä¸ä¸€å®šä¸º0ã€‚è¿™æ˜¯é¢˜çœ¼ã€‚</p><p>å¯¹äºçº¢æ å†…çš„éƒ¨åˆ†ï¼Œè®¾$\theta - \theta^T = v$ï¼Œæœ‰ï¼š</p><ul>
<li>for all v: $v^T H v &gt; 0 \rightarrow \theta'$é™„è¿‘çš„$\theta$éƒ½è¦æ›´å¤§<ul>
<li>-&gt; ç¡®å®æ˜¯åœ¨<code>local minima</code></li>
</ul>
</li>
<li>for all v: $v^T H v &lt; 0 \rightarrow \theta'$é™„è¿‘çš„$\theta$éƒ½è¦æ›´å°<ul>
<li>-&gt; ç¡®å®æ˜¯åœ¨<code>local maxima</code></li>
</ul>
</li>
<li>è€Œæ—¶å¤§æ—¶å°ï¼Œè¯´æ˜æ˜¯åœ¨<code>saddle point</code></li>
</ul>
<p>äº‹å®ä¸Šæˆ‘ä»¬ä¸å¯èƒ½å»æ£€æŸ¥<code>æ‰€æœ‰çš„v</code>ï¼Œè¿™é‡Œç”¨Hessian matrixæ¥åˆ¤æ–­ï¼š</p><ul>
<li>$\rm H$ is <code>positive definite</code> $\rightarrow$ all eigen values are positive $\rightarrow$ local minimal</li>
<li>$\rm H$ is <code>negative definite</code> $\rightarrow$ all eigen values are negative $\rightarrow$ local maximal</li>
</ul>
<p>ç”¨ä¸€ä¸ªå¾ˆåƒåœ¾çš„ç½‘ç»œä¸¾ä¾‹ï¼Œè¾“å…¥æ˜¯1ï¼Œè¾“å‡ºæ˜¯1ï¼Œæœ‰w1, w2ä¸¤å±‚ç½‘ç»œå‚æ•°ï¼Œå› ä¸ºå‡½æ•°ç®€å•ï¼Œä¸¤æ¬¡å¾®åˆ†å¾—åˆ°çš„hessiançŸ©é˜µè¿˜æ˜¯æ¯”è¾ƒç®€å•ç›´è§‚çš„ï¼š
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/149c13520fe91f6bd35b4512d3feb892.png" alt=""/></figure></p><p>ç”±äºç‰¹å¾å€¼æœ‰æ­£æœ‰è´Ÿï¼Œæˆ‘ä»¬åˆ¤æ–­åœ¨äº›(0, 0)è¿™ä¸ª<code>critical point</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ª<code>saddle point</code>.</p><p>å¦‚æœä½ åˆ¤æ–­å‡ºå½“å‰çš„å‚æ•°ç¡®å®å¡åœ¨äº†éç‚¹ï¼Œå®ƒåŒæ—¶ä¹ŸæŒ‡æ˜äº†<code>update direction</code>!</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/81aa9722408cf52b4a133a54a7435dd9.png" alt=""/></figure><p>å›¾ä¸­ï¼Œ</p><ol>
<li>å…ˆæ„å»ºå‡ºäº†ä¸€ä¸ªå°äº0çš„ç»“æœï¼Œä»¥ä¾¿æ‰¾åˆ°å¯ä»¥è®©$L(\theta)$æ”¶æ•›çš„ç›®æ ‡</li>
<li>è¿™ä¸ªç»“æœä¾èµ–äºæ‰¾åˆ°è¿™æ ·ä¸€ä¸ªu<ul>
<li>è¿™ä¸ªuæ˜¯$\theta, \theta'$ç›¸å‡çš„ç»“æœ</li>
<li>å®ƒè¿˜æ˜¯$H$çš„<code>eigen vector</code></li>
<li>å®ƒçš„<code>eigen value</code>$\rightarrow \lambda$ è¿˜è¦å°äº0</li>
</ul>
</li>
</ol>
<p>å®é™…ä¸Šï¼Œ<code>eigen value</code>æ˜¯å¯ä»¥ç›´æ¥æ±‚å‡ºæ¥çš„ï¼ˆä¸Šä¾‹å·²ç»æ±‚å‡ºæ¥äº†ï¼‰ï¼Œç”±å®ƒå¯ä»¥æ¨å‡º<code>eigen vector</code>ï¼Œæ¯”å¦‚[1, 1]$^T$ï¼ˆè‡ªè¡Œè¡¥ç›¸å…³è¯¾ç¨‹ï¼‰ï¼Œå¾€å¾€ä¼šä¸€å¯¹å¤šï¼Œåº”è¯¥éƒ½æ˜¯åˆç†çš„ï¼Œæˆ‘ä»¬é¡ºç€å…±ä¸­ä¸€ä¸ªuå»æ›´æ–°$\theta$ï¼Œå°±å¯ä»¥ç»§ç»­æ”¶æ•›lossã€‚</p><blockquote>
<p>å®é™…ä¸ä¼šçœŸçš„å»è®¡ç®—hessian matrix?</p></blockquote>
<h3>Momentum</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/14f0976b60bb909a3ec3b147594b49bb.png" alt=""/></figure><p>ä¸ç®¡æ˜¯è¾ƒä¸ºå¹³å¦çš„é¢ï¼Œè¿˜æ˜¯saddle pointï¼Œå¦‚æœå°çƒä»¥å›¾ç¤ºçš„æ–¹å¼æ»šä¸‹å»ï¼ŒçœŸå®çš„ç‰©ç†ä¸–ç•Œæ˜¯ä¸å¯èƒ½åœç•™åœ¨é‚£ä¸ªgradientä¸º0æˆ–æ¥è¿‘äº0çš„ä½ç½®çš„ï¼Œå› ä¸ºå®ƒæœ‰â€œåŠ¨é‡â€ï¼Œå³æƒ¯æ€§ï¼Œç”šè‡³è¿˜å¯èƒ½æ»šè¿‡local minimaï¼Œè¿™æ°å¥½æ˜¯æˆ‘ä»¬éœ€è¦çš„ç‰¹æ€§ã€‚
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/f2711cc9c420552051336483c760c347.png" alt=""/></figure>
ä¸ä½†è€ƒè™‘å½“å‰æ¢¯åº¦ï¼Œè¿˜è€ƒè™‘ä¹‹å‰ç´¯ç§¯çš„å€¼ï¼ˆåŠ¨é‡ï¼‰ï¼Œè¿™ä¸ªä¹‹å‰ï¼Œæ˜¯ä¹‹å‰æ‰€æœ‰çš„åŠ¨é‡ï¼Œè€Œä¸æ˜¯å‰ä¸€æ­¥çš„ï¼š
$$
\begin{aligned}
m^0 &amp;= 0 \
m^1 &amp;= -\eta g^0 \
m^2 &amp;= -\lambda \eta g^0 - \eta g^1 \
&amp;\vdots
\end{aligned}
$$</p><h3>adaptive learning rate</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/632ad7d3ca2cd8bae9138dfdcd311805.png" alt=""/></figure><p>ä¸æ˜¯ä»€ä¹ˆæ—¶å€™losså¡ä½äº†å°±è¯´æ˜åˆ°äº†æç‚¹(æœ€å°å€¼ï¼Œéç‚¹ï¼Œå¹³å¦çš„ç‚¹)</p><p>çœ‹ä¸‹é¢è¿™ä¸ªerror surfaceï¼Œä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªå˜åŠ¨éå¸¸å¹³ç¼“ï¼Œä¸€ä¸ªéå¸¸å‰§çƒˆï¼Œå¦‚æœåº”ç”¨ç›¸åŒçš„<code>learning rate</code>ï¼Œè¦ä¹ˆåå¤æ¨ªè·³ï¼ˆè¿‡å¤§ï¼‰ï¼Œè¦ä¹ˆå°±å†ä¹ŸæŒªä¸åŠ¨æ­¥ï¼ˆå¤ªå°ï¼‰ï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/78118fcfe7c7a300c0fb3c063101642e.png" alt=""/></figure><h3>Adagrad (Root Mean Square)</h3>
<p>äºæ˜¯æœ‰äº†ä¸‹é¢çš„ä¼˜åŒ–æ–¹æ³•ï¼Œæ€è·¯ä¸<code>l2æ­£åˆ™åŒ–</code>å·®ä¸å¤šï¼Œåˆ©ç”¨ä¸åŒå‚æ•°æœ¬èº«gradientçš„å¤§å°æ¥â€œæƒ©ç½šâ€å®ƒèµ·åˆ°çš„ä½œç”¨ã€‚</p><ol>
<li>è¿™é‡Œç”¨çš„æ˜¯ç›¸é™¤ï¼Œå› ä¸ºæˆ‘çš„æ¢¯åº¦è¶Šå°ï¼Œæ­¥ä¼å°±å¯ä»¥è·¨å¾—æ›´å¤§äº†ã€‚</li>
<li>å¹¶ä¸”é‡‡ç”¨çš„æ˜¯æ¢¯åº¦çš„å¹³æ–¹å’Œ(<code>Root Mean Square</code>)</li>
</ol>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/5cad715ddff837d3280d5f38270b27c6.png" alt=""/></figure><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/e6eb54b116d3c2b0889449550c4ab5a1.png" alt=""/></figure><p>å›¾ä¸­å¯ä»¥çœ‹å‡ºå¹³ç¼“çš„$\theta_1$å°±å¯ä»¥åº”ç”¨å¤§çš„å­¦ä¹ ç‡ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™ä¸ªæ–¹æ³•å°±æ˜¯<code>Adagrad</code>çš„ç”±æ¥ã€‚ä¸åŒçš„å‚æ•°ç”¨ä¸åŒçš„æ­¥ä¼æ¥è¿­ä»£ï¼Œè¿™æ˜¯ä¸€ç§æ€è·¯ã€‚</p><p>è¿™å°±è§£å†³é—®é¢˜äº†å—ï¼Ÿçœ‹ä¸‹é¢è¿™ä¸ªæ–°æœˆå½¢çš„error surfaceï¼Œä¸å–å…³å­äº†ï¼Œè¿™ä¸ªä»¥å‰æ¥è§¦çš„æ›´å¤šï¼Œå³æ¢¯åº¦éšæ—¶é—´çš„å˜åŒ–è€Œä¸åŒï¼Œ</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/2faed0f3097f4189d91a745c25ee50ca.png" alt=""/></figure><h3>RMSProp</h3>
<p>è¿™ä¸ªæ–¹æ³•æ˜¯æ‰¾ä¸åˆ°è®ºæ–‡çš„ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨<code>Adagrad</code>åšå¹³æ–¹å’Œçš„æ—¶å€™ï¼Œç»™äº†ä¸€ä¸ª$\alpha$ä½œä¸ºå½“å‰è¿™ä¸ªæ¢¯åº¦çš„æƒé‡(0,1)ï¼Œè€ŒæŠŠå‰é¢äº§ç”Ÿçš„$\sigma$ç›´æ¥åº”ç”¨$(1-\alpha)$ï¼š</p><ul>
<li>$\theta_i^{t+1} \leftarrow \theta_i^t - \frac{\eta}{\color{red}{\sigma_i^t}} g_i^t$</li>
<li>$\sigma_i^t = \sqrt{\alpha(\theta_i^{t-1})^2 + (1-\alpha)(g_i^t)^2}$</li>
</ul>
<figure  style="flex: 118.22660098522168" ><img width="960" height="406" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/e2c29123c5ddf87908d3328295e5bb79.png" alt=""/></figure><h3>Adam: (RMSProp + Momentum)</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/399b29c70ef02dadc3f57a47ddca3a2f.png" alt=""/></figure><h3>Learning Rate Scheduling</h3>
<p>ç»ˆäºæ¥åˆ°äº†æœ€ç›´è§‚çš„lr schedulingéƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“ç†è§£çš„ï¼Œéšç€æ—¶é—´çš„å˜åŒ–ï¼ˆå¦‚æœä½ æ‹Ÿåˆæœ‰æ•ˆçš„è¯ï¼‰ï¼Œè¶Šæ¥è¿‘local minimaï¼Œlrè¶Šå°ã€‚</p><p>è€ŒRMSPropä¸€èŠ‚é‡Œè¯´çš„lréšæ—¶é—´å˜åŒ–å¹¶ä¸æ˜¯è¿™ä¸€èŠ‚é‡Œçš„éšæ—¶é—´å˜åŒ–ï¼Œè€Œæ˜¯è®¾å®šä¸€ä¸ªæƒé‡ï¼Œå§‹ç»ˆè®©<strong>å½“å‰</strong>çš„æ¢¯åº¦æ‹¥æœ‰æœ€é«˜æƒé‡ï¼Œæ³¨é‡çš„æ˜¯å½“å‰ä¸è¿‡å¾€ï¼Œè€Œscheduleåˆ™è€ƒé‡çš„æ˜¯æœ‰è®¡åˆ’çš„å‡å°ã€‚</p><p>ä¸‹å›¾ä¸­ï¼Œåº”ç”¨äº†adamä¼˜åŒ–åï¼Œç”±äºé•¿ä¹…ä»¥æ¥æ¨ªå‘ç§»åŠ¨ç´¯ç§¯çš„å°æ¢¯åº¦ä¼šçªç„¶çˆ†å‘ï¼Œå½¢æˆäº†å›¾ä¸­çš„å±€é¢ï¼Œåº”ç”¨äº†schedulingåï¼Œäººä¸ºåœ¨è¶Šé è¿‘æå€¼å­¦ä¹ ç‡è¶Šä½ï¼Œå¾ˆæ˜æ˜¾ç›´æ¥å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚
<figure  style="flex: 50.7399577167019" ><img width="960" height="946" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/3d5a17833ffc7c40d1b452b9e7bd6771.png" alt=""/></figure></p><p>è€Œ<code>warm up</code>æ²¡æœ‰åœ¨åŸç†æˆ–ç›´è§‚ä¸Šè®²è§£æ›´å¤šï¼Œäº†è§£ä¸€ä¸‹å§ï¼Œå®æ“ä¸Šæ˜¯å¾ˆå¯è¡Œçš„ï¼Œå¾ˆå¤šçŸ¥åçš„ç½‘ç»œéƒ½ç”¨äº†å®ƒï¼š</p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/4357f7df834313bc33800b14e2268252.png" alt=""/></figure><p>è¦å¼ºè¡Œè§£é‡Šçš„è¯ï¼Œå°±æ˜¯adamçš„$\theta$æ˜¯ä¸€ä¸ªåŸºäºç»Ÿè®¡çš„ç»“æœï¼Œæ‰€ä»¥è¦åœ¨çœ‹äº†è¶³å¤Ÿå¤šçš„æ•°æ®ä¹‹åæ‰æœ‰æ„ä¹‰ï¼Œå› æ­¤é‡‡ç”¨äº†ä¸€å¼€å§‹å°æ­¥ä¼å†å¢åŠ åˆ°å¤§æ­¥ä¼è¿™æ ·ä¸€ä¸ªè¿‡åº¦ï¼Œæ‹¿åˆ°è¶³å¤Ÿçš„æ•°æ®ä¹‹åï¼Œæ‰å¼€å§‹ä¸€ä¸ªæ­£å¸¸çš„ä¸æ–­å‡å°çš„scheduleçš„è¿‡ç¨‹ã€‚</p><p>æ›´å¤šå¯å‚è€ƒï¼š<code>RAdam</code>: <a href="https://arxiv.org/abs/1908.03265">https://arxiv.org/abs/1908.03265</a></p><h3>Summary of Optimization</h3>
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/fd50408d5cc7b3a7fc6a1b7e8542a01d.png" alt=""/></figure><p>å›é¡¾ä¸‹<code>Momentum</code>ï¼Œå®ƒå°±æ˜¯ä¸ä½†è€ƒè™‘å½“å‰çš„æ¢¯åº¦ï¼Œè¿˜è€ƒè™‘ä¹‹å‰æ‰€æœ‰çš„æ¢¯åº¦ï¼ˆåŠ èµ·æ¥ï¼‰ï¼Œé€šè¿‡æ•°å­¦è®¡ç®—ï¼Œå½“ç„¶æ˜¯èƒ½ç®—å‡ºå®ƒçš„â€åŠ¨é‡â€œçš„ã€‚</p><p>é‚£ä¹ˆåŒæ ·æ˜¯ç´¯è®¡è¿‡å¾€çš„æ¢¯åº¦ï¼Œä¸€ä¸ªåœ¨åˆ†æ¯ï¼ˆ$\theta$)ï¼Œä¸€ä¸ªåœ¨åˆ†å­ï¼ˆmomentum)ï¼Œé‚£ä¸æ˜¯æŠµæ¶ˆäº†å—ï¼Ÿ</p><ol>
<li>momentumæ˜¯ç›¸åŠ ï¼Œä¿ç•™äº†æ–¹å‘</li>
<li>$\sigma$æ˜¯å¹³æ–¹å’Œï¼Œåªä¿ç•™äº†å¤§å°</li>
</ol>
<h2>Batch Normalization</h2>
<p>æ²¿ç€cost surfaceæ‰¾åˆ°æœ€ä½ç‚¹æœ‰ä¸€ä¸ªæ€è·¯ï¼Œå°±æ˜¯èƒ½ä¸èƒ½æŠŠå±±â€œé“²å¹³â€ï¼Ÿå³æŠŠåœ°è²Œç”±å´å²–å˜å¾—å¹³æ»‘ç‚¹ï¼Ÿ <code>batch normalization</code>å°±æ˜¯å…¶ä¸­ä¸€ç§æŠŠå±±é“²å¹³çš„æ–¹æ³•ã€‚
<figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/495d3f5866aebabc0cc9e30a73ac917c.png" alt=""/></figure></p><p>å…¶å®å°±æ˜¯äººä¸ºæ§åˆ¶äº†errorçš„èŒƒå›´ï¼Œè®©å®ƒåœ¨å„ä¸ªfeatureä¸Šé¢çš„â€œæ•°é‡çº§â€åŸºæœ¬ä¸€è‡´ï¼ˆå‡å€¼0ï¼Œæ–¹å·®1ï¼‰ï¼Œè¿™æ ·äº§ç”Ÿçš„error surfaceä¸ä¼šå‡ºç°æŸå‚æ•°å½±å“ç›¸å½“å°ï¼ŒæŸäº›å½±å“åˆç›¸å½“å¤§ï¼Œè€Œçº¯ç²¹æ˜¯å› ä¸ºinputæœ¬èº«é‡çº§ä¸åŒçš„åŸå› ï¼ˆæ¯”å¦‚æˆ¿ä»·åŠ¨ä»¥ç™¾ä¸‡è®¡ï¼Œè€Œå¹´ä»½æ˜¯ä¸€å¹´ä¸€å¹´å¢çš„ï¼‰</p><p>error surfaceå¯ä»¥æƒ³è±¡æˆæ¯ä¸€ä¸ªç‰¹å¾æ‹¥æœ‰ä¸€ä¸ªè½´ï¼ˆè¯¾ç¨‹ç”¨äºŒåˆ°ä¸‰ç»´æ¼”ç¤ºï¼‰ï¼ŒBNè®©æ¯æ¡è½´ä¸Šçš„ticksæ‹¥æœ‰å·®ä¸å¤šçš„åº¦é‡ã€‚</p><p>ç„¶åï¼Œä½ æŠŠå®ƒä¸¢åˆ°æ·±å±‚ç½‘ç»œé‡Œå»ï¼Œä½ çš„è¾“å‡ºçš„åˆ†å¸ƒåˆæ˜¯ä¸å¯æ§çš„ï¼Œè¦æ¥ä¸‹ä¸€ä¸ªç½‘ç»œçš„è¯ï¼Œä½ çš„è¾“å‡ºåˆæˆäº†ä¸‹ä¸€ä¸ªç½‘ç»œçš„è¾“å…¥ã€‚è™½ç„¶ä½ åœ¨è¾“å‡ºå‰nomalizationè¿‡äº†ï¼Œä½†æ˜¯å¯èƒ½è¢«æå¤§å’Œæå°çš„æƒé‡wåˆç»™å˜äº†äº†æ•°é‡çº§ä¸åŒçš„è¾“å‡º</p><p>å†ç„¶åï¼Œä¸åƒç¬¬ä¸€å±‚ï¼Œè¾“å…¥çš„æ•°æ®æ¥è‡ªäºè®­ç»ƒèµ„æ–™ï¼Œä¸‹ä¸€å±‚çš„è¾“å…¥æ˜¯è¦åœ¨ä¸Šä¸€å±‚çš„è¾“å‡ºè¿›è¡Œsigmoidä¹‹åçš„</p><p>å†ç„¶åï¼Œä½ å»çœ‹çœ‹sigmoidå‡½æ•°çš„å½¢çŠ¶ï¼Œå®ƒåœ¨å¤§äºä¸€å®šå€¼æˆ–å°äºä¸€å®šå€¼ä¹‹åï¼Œå¯¹xçš„å˜åŒ–æ˜¯éå¸¸ä¸æ•æ„Ÿäº†ï¼Œè¿™æ ·éå¸¸å®¹æ˜“äº†å‡ºç°æ¢¯åº¦æ¶ˆå¤±çš„ç°è±¡ã€‚</p><p>äºæ˜¯ï¼Œå‡ºäºä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼Œæˆ‘ä»¬éƒ½ä¼šè€ƒè™‘åœ¨è¾“å‡ºåä¹Ÿæ¥ä¸€æ¬¡batch normalization::</p><ol>
<li>å½’ä¸€åŒ–ï¼ˆ$\mu=0, \delta=1$)</li>
<li>æŠŠè¾“å…¥å‹ç¼©åˆ°ä¸€ä¸ªï¼ˆsigmoidæ¢¯åº¦è¾ƒå¤§çš„ï¼‰å°åŒºé—´å†…</li>
</ol>
<p>ç…§è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦åœ¨sigmoidä¹‹å‰è¿›è¡Œä¸€æ¬¡BNçš„ï¼Œè€Œæœ‰çš„æ•™æä¼šå‘Šè¯‰ä½ ä¹‹å‰ä¹‹ååšéƒ½æ²¡å…³ç³»ï¼Œé‚£ä¹ˆä¹‹åå»åšå°±ä¸§å¤±äº†ä»¥ä¸Šç¬¬äºŒæ¡çš„å¥½å¤„ã€‚</p><p><strong>å‰¯ä½œç”¨</strong></p><ul>
<li>ä»¥å‰$x_1 \rightarrow z_1 \rightarrow a_1$</li>
<li>ç°åœ¨$\tilde z_1$æ˜¯ç”¨æ‰€æœ‰$z_i$ç®—å‡ºæ¥çš„ï¼Œä¸å†æ˜¯ç‹¬ç«‹çš„äº†</li>
</ul>
<p><strong>åè®°1</strong></p><p>æœ€åï¼Œå®é™…è¿˜ä¼šæŠŠ$\tilde z_i$å†è¿™ä¹ˆå¤„ç†ä¸€æ¬¡ï¼š</p><ul>
<li>$\hat z_i = \gamma \odot \tilde z_i + \beta$</li>
</ul>
<p>ä¸è¦æ‹…å¿ƒåˆæŠŠé‡çº§å’Œåç§»éƒ½åšå›å»äº†ï¼Œä¼šä»¥1å’Œ0ä¸ºåˆå§‹å€¼æ…¢æ…¢learnçš„ã€‚</p><p><strong>åè®°2</strong></p><p>æ¨ç†çš„æ—¶å€™ï¼Œå¦‚æœbatch sizeä¸å¤Ÿï¼Œç”šè‡³åªæœ‰ä¸€æ¡æ—¶ï¼Œæ€ä¹ˆå»ç®—$\mu, \sigma$å‘¢ï¼Ÿ</p><p>pytorchåœ¨è®­ç»ƒçš„æ—¶å€™ä¼šè®¡ç®—<code>moving average</code>of $\mu$ and $\sigma$ of the batches.(æ¯æ¬¡æŠŠå½“å‰æ‰¹æ¬¡çš„å‡å€¼å’Œå†å²å‡å€¼æ¥è®¡ç®—ä¸€ä¸ªæ–°çš„å†å²å‡å€¼$\bar \mu$)</p><ul>
<li>$\bar \mu \leftarrow p \bar \mu + (1-p)\mu_t$</li>
</ul>
<p>æ¨ç†çš„æ—¶å€™ç”¨$\bar \mu, \bar \sigma$ã€‚</p><p>æœ€åï¼Œç”¨äº†BNï¼Œå¹³æ»‘äº†error surfaceï¼Œå­¦ä¹ ç‡å°±å¯ä»¥è®¾å¤§ä¸€ç‚¹äº†ï¼ŒåŠ é€Ÿæ”¶æ•›ã€‚</p><h1>Classification</h1>
<p>ç”¨æ•°å­—æ¥è¡¨ç¤ºclassï¼Œå°±ä¼šå­˜åœ¨è®¤ä¸º1è·Ÿ2æ¯”è¾ƒè¿‘ä¸3æ¯”è¾ƒè¿œçš„å¯èƒ½ï¼ˆä»æ•°å­¦è¿ç®—æ¥çœ‹ä¹Ÿç¡®å®æ˜¯çš„ï¼Œæ¯•ç«Ÿç¥ç»ç½‘ç»œå°±æ˜¯ä¸æ–­åœ°ä¹˜åŠ å’Œä¸çœŸå€¼å‡åšå¯¹æ¯”ï¼‰ï¼Œæ‰€ä»¥å¼•å…¥äº†one-hotï¼Œå®ƒçš„ç‰¹å¾å°±æ˜¯classä¹‹é—´æ— å…³è”ã€‚</p><p>æ°æ°æ˜¯è¿™ä¸ªç‰¹æ€§ï¼Œä½¿å¾—ç”¨one-hotæ¥è¡¨ç¤ºè¯å‘é‡çš„æ—¶å€™æˆäº†ä¸€ä¸ªè¦å…‹æœçš„ç¼ºç‚¹ã€‚é¢„æµ‹å•è¯ç¡®å®æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œç„¶åè¯ä¸è¯ä¹‹é—´å´å¹¶ä¸æ˜¯æ— å…³çš„ï¼Œæ°æ°æ˜¯æœ‰è·ç¦»è¿œè¿‘çš„æ¦‚å¿µçš„ï¼Œè€ŒæŠŠå®ƒè¿˜åŸå›æ•°å­—ä¹Ÿè§£å†³ä¸äº†é—®é¢˜ï¼Œå› ä¸ºå•ä¸ªæ•°å­—ä¸å‰åçš„æ•°å­—ç¡®å®è¿‘äº†ï¼Œä½†æ˜¯ç©ºé—´ä¸Šè¿˜æ˜¯å¯ä»¥å’Œå¾ˆå¤šæ•°å­—æ¥è¿‘çš„ï¼Œæ‰€ä»¥å‘é‡è¿˜æ˜¯å¿…è¦çš„ï¼Œäºæ˜¯åˆç»§ç»­æ‰“è¡¥ä¸ï¼Œæ‰æœ‰äº†ç¨ å¯†çŸ©é˜µembeddingçš„è¯ç”Ÿã€‚</p><h2>softmax</h2>
<p>softmaxçš„ä¸€ä¸ªç®€å•çš„è§£é‡Šå°±æ˜¯ä½ çš„çœŸå€¼æ˜¯0å’Œ1çš„ç»„åˆ(one-hot)ï¼Œä½†ä½ çš„é¢„æµ‹å€¼å¯ä»¥æ˜¯ä»»ä½•æ•°ï¼Œå› ä¸ºä½ éœ€è¦æŠŠå®ƒnormalizeåˆ°(0,1)çš„åŒºé—´ã€‚</p><p>å½“classåªæœ‰ä¸¤ä¸ªæ—¶ï¼Œç”¨softmaxå’Œç”¨sigmoidæ˜¯ä¸€æ ·çš„ã€‚</p><h2>loss</h2>
<p>å¯ä»¥ç»§ç»­ç”¨MeanSquare Error(MSE) $ e = \sum_i(\hat y_i - y'_i)^2$ï¼Œä½†æ›´å¸¸ç”¨çš„æ˜¯ï¼š</p><h3>Cross-entropy</h3>
<p>$e = - \sum_i \hat y_i lny'_i$</p><blockquote>
<p><code>Minimizing cross-entropy</code> is equivalent to <code>maximizing likelihood</code></p></blockquote>
<figure  style="flex: 67.24511930585683" ><img width="1240" height="922" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/57db1539a499b753d283f44fd02b1476.png" alt=""/></figure><p>linear regressionæ˜¯æƒ³ä»çœŸå€¼ä¸é¢„æµ‹å€¼çš„å·®æ¥å…¥æ‰‹æ‰¾åˆ°æœ€åˆé€‚çš„å‚æ•°ï¼Œè€Œlogistic regressionæ˜¯æƒ³æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆçœŸå€¼åˆ†å¸ƒçš„çš„é¢„æµ‹åˆ†å¸ƒã€‚</p><p>åœ¨å´æ©è¾¾çš„è¯¾ç¨‹é‡Œï¼Œè¿™ä¸ªæŸå¤±å‡½æ•°æ˜¯â€æ‰¾å‡ºæ¥çš„â€œï¼š</p><figure class="vertical-figure" style="flex: 42.29195088676671" ><img width="1240" height="1466" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/962ad32822f268909e640f943fb27eaa.png" alt=""/></figure><ol>
<li>é¦–å…ˆï¼Œ$\theta x$åçš„å€¼å¯ä»¥æ˜¯ä»»æ„å€¼ï¼Œæ‰€ä»¥å†sigmoidä¸€ä¸‹ï¼Œä»¥ä¸‹è®°ä¸ºhx</li>
<li>hxçš„æ„æ€å°±æ˜¯<code>yä¸º1çš„æ¦‚ç‡</code></li>
<li>æˆ‘éœ€è¦ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œå¸Œæœ›å½“çœŸå€¼æ˜¯0æ—¶ï¼Œé¢„æµ‹yä¸º1çš„æ¦‚ç‡çš„è¯¯å·®åº”è¯¥ä¸ºæ— ç©·å¤§<ul>
<li>ä¹Ÿå°±æ˜¯è¯´hx=0æ—¶ï¼ŒæŸå¤±å‡½æ•°çš„ç»“æœåº”è¯¥æ˜¯æ— ç©·å¤§</li>
<li>è€Œhx=1æ—¶, æŸå¤±åº”è¯¥ä¸º0</li>
</ul>
</li>
<li>åŒç†ï¼Œå½“yä¸º1æ—¶ï¼Œhx=0æ—¶æŸå¤±åº”è¯¥æ˜¯æ— ç©·å¤§ï¼Œhx=1æ—¶æŸå¤±ä¸º0</li>
<li>è¿™æ—¶å€™æ‰å‘Šè¯‰ä½ ï¼Œlogå‡½æ•°<strong>åˆšå¥½é•¿è¿™æ ·</strong>ï¼Œè¯·å›çœ‹ä¸Šé¢çš„ä¸¤å¼ å›¾</li>
</ol>
<p>è€Œåˆ«çš„åœ°æ–¹æ˜¯å‘Šè¯‰ä½ logæ˜¯ä¸ºäº†æŠŠæ¦‚ç‡è¿ä¹˜å˜æˆè¿åŠ ï¼Œæ–¹ä¾¿è®¡ç®—ã€‚æå®æ¯…è¿™é‡Œå¹²è„†å°±ç›´æ¥å‘Šè¯‰ä½ å…¬å¼é•¿è¿™æ ·äº†ã€‚ã€‚ã€‚</p><p>è¿™é‡Œç»•ä¸¤ä¸ªå¼¯å°±å¥½äº†ï¼š</p><ol>
<li>y=1æ—¶ï¼Œé¢„æµ‹yä¸º1çš„æ¦‚ç‡ä¸º1ï¼Œ y=0æ—¶ï¼Œåº”é¢„æµ‹y=1çš„æ¦‚ç‡ä¸º0</li>
<li>è€Œè¿™é‡Œæ˜¯åšæŸå¤±å‡½æ•°ï¼Œæ‰€ä»¥é¢„æµ‹å¯¹äº†æŸå¤±ä¸º0ï¼Œé”™äº†æŸå¤±æ— ç©·å¤§</li>
<li>é¢„æµ‹ä¸º1çš„æ¦‚ç‡å°±æ˜¯hxï¼Œæ¨ªè½´ä¹Ÿæ˜¯hx</li>
</ol>
<blockquote>
<p>è¯¾ç¨‹é‡Œè¯´softmaxå’Œcross entorpyç´§å¯†åˆ°pytorché‡Œç›´æ¥å°±æŠŠä¸¤è€…ç»“åˆåˆ°ä¸€èµ·äº†ï¼Œåº”ç”¨cross entropyçš„æ—¶å€™æŠŠsoftmaxåŠ åˆ°äº†ä½ çš„networkçš„æœ€åä¸€å±‚ï¼ˆä¹Ÿå°±æ˜¯è¯´ä½ æ²¡å¿…è¦æ‰‹å†™ï¼‰ã€‚è¿™é‡Œè¯´çš„åªæ˜¯pytorchæ˜¯è¿™ä¹ˆå¤„ç†çš„å—ï¼Ÿ</p><p>----æ˜¯çš„</p></blockquote>
<h3>CE v.s. MSE</h3>
<p>æ•°å­¦è¯æ˜ï¼š<a href="http://speech.ee.ntu.edu.tw/~tlkagk/courses/MLDS_2015_2/Lecture/Deep%20More%20(v2).ecm.mp4/index.html">http://speech.ee.ntu.edu.tw/~tlkagk/courses/MLDS_2015_2/Lecture/Deep%20More%20(v2).ecm.mp4/index.html</a></p><figure  style="flex: 66.66666666666667" ><img width="960" height="720" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/97f9a28a6fef03ce00f321f79903a216.png" alt=""/></figure><p>å•çœ‹å®éªŒç»“æœï¼Œåˆå§‹ä½ç½®åŒä¸ºlossè¾ƒå¤§çš„å·¦ä¸Šè§’ï¼Œå› ä¸ºCEæœ‰æ˜æ˜¾çš„æ¢¯åº¦ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°å³ä¸‹è§’çš„æå€¼ï¼Œä½†æ˜¯MSEå³ä½¿losså·¨å¤§ï¼Œä½†æ˜¯å´æ²¡æœ‰æ¢¯åº¦ã€‚å› æ­¤å¯¹äºé€»è¾‘å›å½’ï¼Œé€‰æ‹©äº¤å‰ç†µä»å®éªŒæ¥çœ‹æ˜¯åˆç†çš„ï¼Œæ•°å­¦æ¨å¯¼è¯·çœ‹ä¸Šé¢çš„é“¾æ¥ã€‚</p></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/%E6%9D%8E%E5%AE%8F%E6%AF%85MACHINE-LEARNING-2021-SPRING%E7%AC%94%E8%AE%B0-2/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
    <article class="yue prism-post-item col-md-8 offset-md-2">
        <h1 class="prism-post-title"><a class="no-link" href="/archives/Deep-Learning-with-Python-Notes-7/" target="_self">ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[7]</a></h1>
        <div class="prism-post-time">
            <a class="no-link" href="/archives/Deep-Learning-with-Python-Notes-7/" target="_self">
                <time class="text-uppercase">
                    October 12 2021
                </time>
            </a>
        </div>
        <div class="prism-content"><h1>Generative deep learning</h1>
<p>Our perceptual modalities, our language, and our artwork all have <code>statistical structure</code>. Learning this structure is what deep-learning algorithms excel at.</p><p>Machine-learning models can learn the <code>statistical latent space</code> of images, music, and stories, and they can then<code>sample from this space</code>, <strong>creating new artworks</strong> with characteristics similar to those the model has seen in its training data.</p><h2>Text generation with LSTM</h2>
<h3>Language model</h3>
<p>å¾ˆå¤šåœ°æ–¹éƒ½åœ¨æŒ‰è‡ªå·±çš„ç†è§£å®šä¹‰<code>language model</code>ï¼Œè¿™æœ¬ä¹¦å®šä¹‰å¾ˆæ˜ç¡®ï¼Œèƒ½ä¸ºæ ¹æ®å‰æ–‡é¢„æµ‹ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ªtokenå»ºç«‹æ¦‚ç‡æ¨¡å‹çš„ç½‘ç»œã€‚</p><blockquote>
<p>any network that can model the probability of the next token given the previous ones is called a language model.</p></blockquote>
<ol>
<li>æ‰€ä»¥é¦–å…ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªnetwork</li>
<li>å®ƒåšçš„äº‹æ˜¯modelä¸€ä¸ªprobability</li>
<li>å†…å®¹æ˜¯the next token</li>
<li>æ¡ä»¶æ˜¯previous tokens</li>
</ol>
<p>ä¸€æ—¦ä½ æœ‰äº†è¿™æ ·ä¸€ä¸ªlanguage modelï¼Œä½ å°±èƒ½<code>sample from it</code>ï¼Œè¿™å°±æ˜¯å‰é¢ç¬”è®°é‡Œçš„sample from lantent space, ç„¶ågenerateäº†ã€‚</p><h3>greedy sampling and stochastic sampling</h3>
<p>å¦‚æœæ ¹æ®æ¦‚ç‡æ¨¡å‹æ¯æ¬¡éƒ½é€‰â€œæœ€å¯èƒ½â€çš„è¾“å‡ºï¼Œåœ¨è¿è´¯æ€§ä¸Šè¢«è¯æ˜æ˜¯ä¸å¥½çš„ï¼Œè€Œä¸”ä¹Ÿä¸§å¤±äº†åˆ›é€ æ€§ï¼Œæ‰€ä»¥è¿˜æ˜¯ç»™äº†ä¸€å®šçš„éšæœºæ€§èƒ½é€‰åˆ°â€œä¸é‚£ä¹ˆå¯èƒ½â€çš„è¾“å‡ºã€‚</p><p>å› ä¸ºäººç±»æ€ç»´æœ¬èº«ä¹Ÿæ˜¯<code>è·³è·ƒ</code>çš„ã€‚</p><p>è€ƒè™‘ä¸¤ä¸ªè¾“å‡ºä¸‹ä¸€ä¸ªtokenæ—¶çš„æç«¯æƒ…å†µï¼š</p><!-- --> | <!-- --> | <!-- --> | <!-- -->
<p>------- | ------- | ------- | -------
çº¯éšæœºï¼Œæ‰€æœ‰å¯é€‰è¯çš„æ¦‚ç‡æ˜¯å‡ç­‰çš„ | æ¯«æ— æ„ä¹‰ | <code>max entropy</code> | åˆ›é€ æ€§é«˜
greedy sampling | æ¯«æ— ç”Ÿè¶£ | <code>minimum entropy</code> | å¯é¢„æµ‹æ€§é«˜</p><p>å®ç°æ–¹å¼ï¼š<code>softmax temperature</code></p><p>é™¤ä¸€ä¸ª<code>æ¸©åº¦</code>ï¼Œå¦‚æœæ¸©åº¦å¤§äº1ï¼Œé‚£ä¹ˆæ¸©åº¦è¶Šå¤§ï¼Œè¢«é™¤æ•°ç¼©å¹…åº¦å°±è¶Šå¤§ï¼ˆè¿™æ ·æ¸©å·®å°±è¶Šå°ï¼Œåˆ†å¸ƒä¼šæ›´å¹³å‡ï¼‰-&gt; åå‘äº†çº¯éšæœºçš„æ¦‚ç‡ç»“æ„ï¼ˆå‡ç­‰ï¼‰</p><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">reweight_distribution</span><span class="p">(</span><span class="n">original_distribution</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">original_distribution</span><span class="p">)</span> <span class="o">/</span> <span class="n">temperature</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">distribution</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span>
</pre></div>
<p>å†™æˆå…¬å¼
$
\frac{e^{\frac{log(d)}{T}}}{\sum e^{\frac{log(d)}{T}}}
$
è¿™æ˜¯å¯¹æ¸©åº¦å’Œsigmoidåšäº†èåˆï¼š</p><ol>
<li>ä¸€ä¸ªæ˜¯å¯¹ç›®æ ‡åˆ†å¸ƒå–è‡ªç„¶å¯¹æ•°åé™¤æ¸©åº¦å†å½“æˆeçš„æŒ‡æ•°ç»™å¹‚å›å»ï¼ˆå¦‚æœä¸é™¤æ¸©åº¦ï¼Œé‚£å°±æ˜¯å…ˆlogå†eï¼Œç­‰äºæ˜¯åŸæ•°ï¼‰</li>
<li>æ ‡å‡†çš„sigmoidæ–¹ç¨‹</li>
</ol>
<blockquote>
<p>è¿™é‡Œå›é¡¾ä¸€ä¸ªæ¦‚å¿µï¼šSampling from a space</p></blockquote>
<p>ä¹¦é‡Œå¤§é‡ç”¨äº†è¿™ä¸ªæ¦‚å¿µï¼Œç»“åˆä»£ç ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªpredictå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€èˆ¬äººç†è§£çš„â€œ<code>é¢„æµ‹ï¼Œæ¨ç†</code>â€ï¼Œæ˜¯ä»ä¸šåŠ¡é€»è¾‘æ–¹é¢æ¥ç†è§£ï¼Œä½œè€…æ›´æ„¿æ„ä»ç»Ÿè®¡å­¦å’Œçº¿æ€§ä»£æ•°è§’åº¦æ¥ç†è§£ã€‚</p><p>ä¸¤ç§è®­ç»ƒæ–¹æ³•ï¼š</p><ol>
<li>æ¯æ¬¡ç”¨Nä¸ªå­—ï¼Œæ¥é¢„æµ‹ç¬¬N+1ä¸ªå­—ï¼Œå³outputåªæœ‰1ä¸ª(voc_size, 1)ï¼Œè®­ç»ƒçš„æ˜¯language model</li>
<li>æ¯æ¬¡ç”¨Nä¸ªå­—(a, b), æ¥é¢„æµ‹(a+1, b+1)ï¼Œ outputæœ‰Nä¸ª(voc_size, N)ï¼Œè®­ç»ƒçš„æ˜¯ç‰¹å®šçš„ä»»åŠ¡ï¼Œæ¯”å¦‚å†™è¯—ï¼Œä½œéŸ³ä¹</li>
</ol>
<p>è¿‡ç¨‹ï¼š</p><ol>
<li>å‡†å¤‡æ•°æ®ï¼ŒXä¸ºä¸€ç»„å¥å­ï¼ŒYä¸ºæ¯ä¸€ä¸ªå¥å­å¯¹åº”çš„ä¸‹ä¸€ä¸ªå­—ï¼ˆå…¨éƒ¨å‘é‡åŒ–ï¼‰</li>
<li>æ­å»ºä¸€ä¸ªLSTM + Dense çš„ç½‘ç»œï¼Œè¾“å‡ºæ ¹æ®å…·ä½“æƒ…å†µè¦ä¹ˆä¸º1ï¼Œè¦ä¹ˆä¸ºN</li>
<li>æ¯ä¸€ä¸ªepoché‡Œå‡è¿›è¡Œé¢„æµ‹ï¼ˆå¦‚æœä¸æ˜¯ä¸ºäº†çœ‹è¿‡ç¨‹ï¼Œæœ‰å¿…è¦å—ï¼Ÿæˆ‘ä»¬è¦æœ€åä¸€è½®çš„é¢„æµ‹ä¸å°±è¡Œäº†ï¼Ÿï¼‰<ul>
<li>è¿›è¡Œä¸€æ¬¡fit(å°±æ˜¯train)ï¼Œå¾—åˆ°ä¼˜åŒ–åçš„å‚æ•°</li>
<li>éšæœºå–ä¸€æ®µæ–‡æœ¬ï¼Œç”¨ä½œç§å­ï¼ˆç”¨æ¥ç”Ÿæˆç¬¬ä¸€ä¸ªå­—ï¼‰</li>
<li>è®¡ç®—ç”Ÿæˆå¤šå°‘ä¸ªå­—ï¼Œå°±å¼€å§‹forå¾ªç¯<ul>
<li>å‘é‡åŒ–å½“å‰çš„ç§å­ï¼ˆä¼šè¶Šæ¥è¶Šé•¿ï¼‰</li>
<li>predictï¼Œå¾—åˆ°æ¯ä¸ªå­—çš„æ¦‚ç‡</li>
<li>softmax temperatureï¼Œå¹³æ»‘æ¦‚ç‡ï¼Œå–å‡ºnext_token</li>
<li>next_tokenè½¬å›æ–‡æœ¬ï¼Œé™„åŠ åˆ°seedåé¢</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3>DeepDream</h3>
<p>çœ‹äº†ä¸€éï¼Œä¸æ„Ÿå…´è¶£ã€‚æ ¸å¿ƒæ€è·¯è·Ÿè§†è§‰åŒ–filterçš„æ€è·¯æ˜¯ä¸€æ ·çš„ï¼š<code>gradient ascent</code></p><ol>
<li>ä»å¯¹æ¯ä¸ªlayeré‡Œçš„å•ä¸ªfilteråšæ¢¯åº¦ä¸Šå‡å˜æˆäº†å¯¹æ•´ä¸ªlayeråšæ¢¯åº¦ä¸Šå‡</li>
<li>ä¸å†ä»éšæœºå™ªå£°å¼€å§‹ï¼Œè€Œæ˜¯ä»ä¸€å¼ çœŸå®å›¾ç‰‡å¼€å§‹ï¼Œå®ç°è¿™äº›layeré‡Œå¯¹å›¾ç‰‡å½±å“æœ€å¤§çš„patternsçš„distorting</li>
</ol>
<h3>Neural style transfer</h3>
<p>Neural style transfer consists of applying the <code>style</code> of a reference image to a target image while conserving the <code>content</code> of the target image.</p><ul>
<li>ä¸¤ä¸ªå¯¹è±¡ï¼š<code>reference</code>, <code>target</code> image</li>
<li>ä¸¤ä¸ªæ¦‚å¿µï¼š<code>style</code>å’Œ<code>content</code></li>
</ul>
<p>å¯¹<code>B</code>çš„contentåº”ç”¨<code>A</code>çš„styleï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºâ€œç¬”åˆ·â€ï¼Œæˆ–è€…ç”¨å‰äº›å¹´çš„æµè¡Œåº”ç”¨æ¥è§£é‡Šï¼šæŠŠä¸€å‰¯ç”»æ°´å½©åŒ–ï¼Œæˆ–æ²¹ç”»åŒ–ã€‚</p><p>æŠŠstyleåˆ†è§£ä¸ºä¸åŒspatial scalesä¸Šçš„ï¼šçº¹ç†ï¼Œé¢œè‰²ï¼Œå’Œvisual pattern</p><p>æƒ³ç”¨æ·±åº¦å­¦ä¹ æ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆè‡³å°‘å¾—å®šä¹‰æŸå¤±å‡½æ•°æ˜¯ä»€ä¹ˆæ ·çš„ã€‚</p><p>If we were able to mathematically define <code>content</code> and <code>style</code>, then an appropriate loss function to minimize would be the following:</p><div class="highlight"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">style</span><span class="p">(</span><span class="n">reference_image</span><span class="p">)</span> <span class="o">-</span> <span class="n">style</span><span class="p">(</span><span class="n">generated_image</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">distance</span><span class="p">(</span><span class="n">content</span><span class="p">(</span><span class="n">original_image</span><span class="p">)</span> <span class="o">-</span> <span class="n">content</span><span class="p">(</span><span class="n">generated_image</span><span class="p">))</span>
</pre></div>
<p>å³å¯¹æ–°å›¾è€Œè¨€ï¼Œ<code>çº¹ç†è¦æ— é™é è¿‘Aï¼Œå†…å®¹è¦æ— é™é è¿‘B</code>ã€‚</p><ul>
<li>the content loss<ul>
<li>å›¾åƒå†…å®¹å±äºé«˜çº§æŠ½è±¡ï¼Œå› æ­¤åªéœ€è¦top layerså‚ä¸å°±è¡Œäº†ï¼Œå®é™…åº”ç”¨ä¸­åªå–äº†æœ€é¡¶å±‚</li>
</ul>
</li>
<li>the style loss<ul>
<li>åº”ç”¨<code>Gram matrix</code><ul>
<li>the inner product of the feature maps of a given layer</li>
<li>correlations between the layer's feature</li>
<li>éœ€è¦ç”Ÿæˆå›¾å’Œå‚è€ƒå›¾çš„æ¯ä¸€ä¸ªå¯¹åº”çš„layeræ‹¥æœ‰ç›¸åŒçš„çº¹ç†(same <code>textures</code> at different <code>spatial scales</code>)ï¼Œå› æ­¤éœ€è¦æ‰€æœ‰çš„layerå‚ä¸</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ä»è¿™é‡Œåº”è¯¥ä¹Ÿèƒ½åˆ¤æ–­å‡ºè¦æ­å»ºç½‘ç»œçš„è¯ï¼Œinputè‡³å°‘ç”±ä¸‰éƒ¨åˆ†ï¼ˆä¸‰å¼ å›¾ç‰‡ï¼‰æ„æˆäº†ã€‚</p><p><strong>demo</strong></p><ul>
<li>inputä¸ºå‚è€ƒå›¾ï¼Œç›®æ ‡å›¾ï¼Œå’Œç”Ÿæˆå›¾ï¼ˆå ä½ï¼‰ï¼Œconcatenateæˆä¸€ä¸ªtensor</li>
<li>ç”¨VGG19æ¥åšç‰¹å¾æå–</li>
<li>è®¡ç®—loss<ol>
<li>ç”¨ç”Ÿæˆå›¾å’Œ<code>ç›®æ ‡å›¾</code>çš„<code>top_layer</code>ä»¥L2 normè·ç¦»åšloss</li>
<li>ç”¨ç”Ÿæˆå›¾å’Œ<code>å‚è€ƒå›¾</code>çš„<code>every</code> layerä»¥L2 Normåšlosså¹¶ç´¯åŠ </li>
<li>å¯¹ç”Ÿæˆå›¾åç§»1åƒç´ åšregularization lossï¼ˆå…·ä½“çœ‹ä¹¦ï¼‰</li>
<li>ä¸Šè¿°ä¸‰ç»„lossç´¯åŠ ï¼Œä¸ºä¸€è½®çš„loss</li>
</ol>
</li>
<li>ç”¨lossè®¡ç®—å¯¹input(å³ä¸‰è”å›¾)çš„æ¢¯åº¦</li>
</ul>
<h2>Generating images</h2>
<blockquote>
<p>Sampling from a latent space of images to create entirely new images</p></blockquote>
<p>ç†Ÿæ‚‰çš„å¥å¼åˆæ¥äº†ã€‚</p><p>æ ¸å¿ƒæ€æƒ³ï¼š</p><ol>
<li>low-dimensional <code>latent space</code> of representations<ul>
<li>ä¸€èˆ¬æ˜¯ä¸ªvector space</li>
<li>any point can be mapped to a realistic-looking image</li>
</ul>
</li>
<li>the module capable of <code>realizing this mapping</code>, can take point as input, then output an image, this called:<ul>
<li>generator -&gt; GAN</li>
<li>decoder -&gt; VAE</li>
</ul>
</li>
</ol>
<p>VAE v.s. GAN</p><ul>
<li>VAEs are great for learning latent spaces that are <code>well structured</code></li>
<li>GANs generate images that can potentially be <code>highly realistic</code>, but the latent space they come from may not have as much structure and continuity.</li>
</ul>
<h3>VAEï¼ˆvariational autoencodersï¼‰</h3>
<p>given a <code>latent space</code> of representations, or an embedding space, <code>certain directions</code> in the space <strong>may</strong> encode interesting axes of variation in the original data. -&gt; inspired by <code>concept space</code></p><p>æ¯”å¦‚åŒ…å«äººè„¸çš„æ•°æ®é›†çš„latent spaceé‡Œï¼Œæ˜¯å¦ä¼šå­˜åœ¨<code>smile vectors</code>ï¼Œå®šä½è¿™æ ·çš„vectorï¼Œå°±å¯ä»¥ä¿®æ”¹å›¾ç‰‡ï¼Œè®©å®ƒprojectingåˆ°è¿™ä¸ªlatent spaceé‡Œå»ã€‚</p><p><strong>Variational autoencoders</strong></p><p>Variational autoencoders are a kind of <em>generative model</em> thatâ€™s especially appropriate for the task of <strong>image editing</strong> via concept vectors.</p><p>Theyâ€™re a modern take on <code>autoencoders</code> (a type of network that aims to <code>encode</code>an input to a <code>low-dimensional</code> latent space and then decode it back) that mixes ideas from deep learning with <strong>Bayesian inference</strong>.</p><ul>
<li>VAEæŠŠå›¾ç‰‡è§†ä½œéšè—ç©ºé—´çš„å‚æ•°è¿›è¡Œç»Ÿè®¡è¿‡ç¨‹çš„ç»“æœã€‚</li>
<li>å‚æ•°å°±æ˜¯è¡¨ç¤ºä¸€ç§æ­£æ€åˆ†å¸ƒçš„meanå’Œvarianceï¼ˆå®é™…å–çš„log_variance)</li>
<li>ç”¨è¿™ä¸ªåˆ†å¸ƒå¯ä»¥è¿›è¡Œé‡‡æ ·(sample)</li>
<li>æ˜ å°„å›original image</li>
</ul>
<ol>
<li>An encoder module turns the input samples <em>input_img</em> into two parameters in a latent space of representations, <code>z_mean</code> and <code>z_log_variance</code>.</li>
<li>You randomly sample a point z from the latent normal distribution thatâ€™s assumed to generate the input image, via $z = z_mean + e^{z_log_variance} \times \epsilon$, where $\epsilon$ is a random tensor of small values.</li>
<li>A decoder module maps <em>this point</em> in the latent space back to the original input image.</li>
</ol>
<blockquote>
<p>Because epsilon is random, the process ensures that every point thatâ€™s <strong>close to the latent location</strong> where you encoded input_img (z-mean) can be decoded to something <strong>similar</strong> to input_img, thus forcing the latent space to be continuously meaningful.</p></blockquote>
<ol>
<li>æ‰€ä»¥VAEç”Ÿæˆçš„å›¾ç‰‡æ˜¯å¯è§£é‡Šçš„ï¼Œæ¯”å¦‚åœ¨latent spaceä¸­è·ç¦»ç›¸è¿‘çš„ä¸¤ç‚¹ï¼Œdecodeå‡ºæ¥çš„å›¾ç‰‡ç›¸ä¼¼åº¦ä¹Ÿå°±å¾ˆé«˜ã€‚</li>
<li>å¤šç”¨äºç¼–è¾‘å›¾ç‰‡ï¼Œå¹¶ä¸”èƒ½ç”ŸæˆåŠ¨ç”»è¿‡ç¨‹ï¼ˆå› ä¸ºæ˜¯è¿ç»­çš„ï¼‰</li>
</ol>
<p>ä¼ªä»£ç (ä¸ç®—ï¼Œå¯ä»¥è¯´æ˜¯éª¨å¹²ä»£ç ï¼‰ï¼š</p><div class="highlight"><pre><span></span><span class="n">z_mean</span><span class="p">,</span> <span class="n">z_log_variance</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">input_img</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z_mean</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">z_log_variance</span><span class="p">)</span> <span class="o">*</span> <span class="n">epsilon</span>  <span class="c1"># sampling</span>
<span class="n">reconstructed_img</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">input_img</span><span class="p">,</span> <span class="n">reconstructed_img</span><span class="p">)</span>
</pre></div>
<p>VAE encoder network</p><div class="highlight"><pre><span></span><span class="n">img_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">latent_dim</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">input_img</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">shape_before_flattening</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">int_shape</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">z_mean</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">z_log_var</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
<ol>
<li>å¯è§æ˜¯ä¸€ä¸ªæ ‡å‡†çš„multi-headçš„ç½‘ç»œ</li>
<li>å¯è§æ‰€è°“çš„latent spaceï¼Œå…¶å®å°±æ˜¯transformingåçš„ç»“æœ</li>
<li>encodeçš„ç›®çš„æ˜¯å›å½’å‡ºä¸¤ä¸ªå‚æ•°ï¼ˆæœ¬ä¾‹æ˜¯ä¸¤ä¸ª2ç»´å‚æ•°ï¼‰</li>
<li>ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªç†è§£ä¸ºmean, ä¸€ä¸ªç†è§£ä¸ºlog_variance</li>
</ol>
<p>decoderè¿‡ç¨‹å°±æ˜¯å¯¹meanå’Œvaréšæœºé‡‡æ ·ï¼ˆå¾—åˆ°z)ï¼Œç„¶åä¸æ–­ä¸Šé‡‡æ ·(<code>Conv2DTranspose</code>)å¾—åˆ°å½¢çŠ¶ä¸æºå›¾ä¸€è‡´çš„è¾“å‡º(å¾—åˆ°z_decode)çš„è¿‡ç¨‹ã€‚</p><ol>
<li>z_decodeè·ŸzåšBCE loss</li>
<li>è¿˜è¦åŠ ä¸€ä¸ªregularization lossé˜²æ­¢overfitting</li>
</ol>
<blockquote>
<p>æ­¤å¤„è¯·çœ‹ä¹¦ï¼Œæ¼”ç¤ºäº†è‡ªå®šä¹‰çš„lossã€‚å› ä¸ºkerasé«˜åº¦å°è£…ï¼Œæ‰€ä»¥å„ç§åœ¨å°è£…ä¹‹å¤–çš„è‡ªå®šä¹‰çš„ç”¨æ³•å°¤å…¶å€¼å¾—å…³æ³¨ã€‚æ¯”å¦‚è¿™é‡Œï¼Œè‡ªå®šä¹‰äº†lossä¹‹åï¼ŒModelå’Œfité‡Œå°±ä¸éœ€è¦ä¼ Yï¼Œcompileæ—¶ä¹Ÿä¸éœ€è¦ä¼ lossäº†ã€‚</p></blockquote>
<blockquote>
<p>lossæ˜¯åœ¨æœ€åä¸€å±‚layeré‡Œè®¡ç®—çš„ï¼Œå¹¶ä¸”é€šè¿‡ä¸€ä¸ªlayeræ–¹æ³•<code>add_loss</code>ï¼ŒæŠŠlosså’Œinputé€šçŸ¥ç»™äº†networkï¼ˆå¦‚æœä½ æƒ³çŸ¥é“æ³¨å…¥ç‚¹çš„è¯ï¼‰</p></blockquote>
<p>ä½¿ç”¨æ¨¡å‹çš„è¯ï¼Œå°±æ˜¯ç”Ÿæˆä¸¤ç»„éšæœºæ•°ï¼Œå½“æˆmeanå’Œlog_varianceï¼Œè§‚å¯Ÿdecodeä¹‹åçš„ç»“æœã€‚</p><h3>GAN</h3>
<p><code>Generative adversarial network</code>å¯ä»¥åˆ›ä½œä»¥å‡ä¹±çœŸçš„å›¾ç‰‡ã€‚é€šè¿‡è®­ç»ƒæœ€å¥½çš„é€ å‡å’Œå’Œæœ€å¥½çš„é‰´åˆ«è€…æ¥è¾¾åˆ°â€œåˆ›é€ â€è¶Šæ¥è¶Šé€¼è¿‘äººç±»åˆ›ä½œçš„ä½œå“ã€‚</p><ul>
<li><strong>Generator</strong> network: Takes as input a random vector (a random point in the latent space), and decodes it into a synthetic image</li>
<li><strong>Discriminator</strong> network (or adversary): Takes as input an image (real or synthetic), and predicts whether the image came from the training set or was created by the generator network.</li>
</ul>
<p><strong>deep convolutional GAN (DCGAN)</strong></p><ul>
<li>a GAN where the generator and discriminator are deep convnets.</li>
<li>In particular, it uses a <code>Conv2DTranspose</code> layer for image upsampling in the generator.</li>
</ul>
<p>è®­ç»ƒç”Ÿæˆå™¨æ˜¯å†²ç€èƒ½è®©é‰´åˆ«å™¨å°½å¯èƒ½é‰´åˆ«ä¸ºçœŸçš„æ–¹å‘çš„ï¼šthe generator is trained to <code>fool</code> the discriminatorã€‚</p><blockquote>
<p>è¿™å¥è¯å…¶å®æš—å«äº†ä¸€ä¸ªå‰æï¼Œä¸‹é¢ä¼šè¯´ï¼Œå°±æ˜¯æ­¤æ—¶discriminatoræ˜¯ç¡®å®šçš„ã€‚å³åœ¨ç¡®å®šçš„é‰´åˆ«èƒ½åŠ›ä¸‹ï¼Œå°½å¯èƒ½å»æ‹Ÿåˆgeneratorçš„è¾“å‡ºï¼Œè®©å®ƒèƒ½é€šè¿‡å½“å‰é‰´åˆ«å™¨çš„æµ‹è¯•ã€‚</p></blockquote>
<p>ä¹¦ä¸­è¯´è®­ç»ƒDCGANå¾ˆå¤æ‚ï¼Œè€Œä¸”å¾ˆå¤štrick, è¶…å‚é çš„æ˜¯ç»éªŒè€Œä¸æ˜¯ç†è®ºæ”¯æ’‘ï¼Œæ‘˜æŠ„å¹¶ç¬”è®°a bag of trickså¦‚ä¸‹ï¼š</p><ul>
<li>We use <code>tanh</code> as the last activation in the generator, instead of sigmoid, which is more commonly found in other types of models.</li>
<li>We sample points from the latent space using a <code>normal distribution</code> (Gaussian distribution), not a uniform distribution.</li>
<li>Stochasticity is good to induce robustness. Because GAN training results in a dynamic equilibrium, GANs are likely to get stuck in all sorts of ways. Introducing randomness during training helps prevent this. We introduce randomness in two ways:<ul>
<li>by using <code>dropout</code> in the discriminator</li>
<li>and by adding <code>random noise</code> to the labels for the discriminator.</li>
</ul>
</li>
<li>Sparse gradients can hinder GAN training. In deep learning, sparsity is often a desirable property, <strong>but not in GANs</strong>. Two things can induce gradient sparsity: <code>max pooling</code> operations and <code>ReLU</code> activations.<ul>
<li>Instead of max pooling, we recommend using <code>strided convolutions</code> for downsampling(ç”¨æ­¥é•¿å·ç§¯ä»£æ›¿pooling),</li>
<li>and we recommend using a <code>LeakyReLU</code> layer instead of a ReLU activation. Itâ€™s similar to ReLU, but it relaxes sparsity constraints by allowing small negative activation values.</li>
</ul>
</li>
<li>In generated images, itâ€™s common to see <code>checkerboard artifacts</code>(stirdeå’Œkernel sizeä¸åŒ¹é…åƒä¸‡çš„) caused by unequal coverage of the pixel space in the generator.<ul>
<li>To fix this, we use a kernel size thatâ€™s divisible by the stride size whenever we use a strided <code>Conv2DTranpose</code> or Conv2D in both the generator and the discriminator.</li>
</ul>
</li>
</ul>
<p><strong>Train</strong></p><ol>
<li>Draw random points in the latent space (random noise).</li>
<li>Generate images with generator using this random noise.</li>
<li>Mix the generated images with real ones.</li>
<li>Train discriminator using these mixed images, with corresponding targets:<ul>
<li>either â€œrealâ€ (for the real images) or â€œfakeâ€ (for the generated images).</li>
<li>æ‰€ä»¥é‰´åˆ«å™¨æ˜¯<code>å•ç‹¬è®­ç»ƒçš„</code>ï¼ˆå‰é¢ç¬”è®°é“ºå«è¿‡äº†ï¼‰</li>
<li>ä¸‹é¢å°±æ˜¯trainæ•´ä¸ªDCGANäº†ï¼š</li>
</ul>
</li>
<li>Draw new random points in the latent space.</li>
<li>Train gan using these random vectors, with targets that all say â€œthese are real images.â€ This updates the weights of the generator (only, because the discriminator is frozen inside gan) to move them toward getting the discriminator to predict â€œthese are real imagesâ€ for generated images: this trains the generator to fool the discriminator.<ul>
<li>åªtrainç½‘ç»œé‡Œçš„generator</li>
<li>discriminatorä¸è®­ç»ƒï¼Œå› ä¸ºæ˜¯è¦ç”¨â€œå·²ç»è®­ç»ƒåˆ°ç›®å‰ç¨‹åº¦çš„â€discriminatoræ¥åšä¸‹é¢çš„ä»»åŠ¡</li>
<li>ä»»åŠ¡å°±æ˜¯åªé€å…¥ä¼ªé€ å›¾ï¼Œå¹¶å£°æ˜æ‰€æœ‰å›¾éƒ½æ˜¯çœŸçš„ï¼Œå»è®©generatorç”Ÿæˆèƒ½é€¼è¿‘è¿™ä¸ªå£°æ˜çš„å›¾</li>
<li>generatorå°±æ˜¯è¿™ä¹ˆè®­ç»ƒå‡ºæ¥çš„ã€‚</li>
<li>æ‰€ä»¥å®é™…ä»£ç æ˜¯ä¸€æ¬¡epochæ˜¯ç”±trainä¸€ä¸ª<code>discriminator</code>å’Œtrainä¸€ä¸ª<code>GAN</code>ç»„æˆ.</li>
</ul>
</li>
</ol>
<p>å› ä¸ºé‰´åˆ«å™¨å’Œç”Ÿæˆå™¨æ˜¯ä¸€èµ·è®­ç»ƒçš„ï¼Œå› æ­¤å‰å‡ è½®ç”Ÿæˆçš„è‚¯å®šæ˜¯å™ªéŸ³ï¼Œä½†å‰å‡ è½®é‰´åˆ«å™¨ä¹Ÿæ˜¯çé‰´åˆ«çš„ã€‚</p></div>
        
        <div class="prism-action-bar">
            <div class="comment-action action-item"><a class="no-link text-uppercase" href="/archives/Deep-Learning-with-Python-Notes-7/#prism__comment" target="_self"><i class="fa fa-comment"></i>Comment</a></div>
        </div>
        
    </article>
    
</section>

<div class="container">
    <section id="prism__page__pagination" class="prism-pagination" class="col-md-8 offset-md-2">
        <ul>
            
            <li class="next">
                <a class="no-link" href="/page/2/" target="_self"><i class="fa fa-chevron-left" aria-hidden="true"></i>Newer</a>
            </li>
            
            
            <li class="prev">
                <a class="no-link" href="/page/4/" target="_self">Older<i class="fa fa-chevron-right" aria-hidden="true"></i></a>
            </li>
            
        </ul>
    </section>
</div>


</main>

            <footer id="prism__footer">
                <section>
                    <div>
                        <nav class="social-links">
                            <ul><li><a class="no-link" title="Twitter" href="https://twitter.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-twitter"></i></a></li><li><a class="no-link" title="GitHub" href="https://github.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-github"></i></a></li><li><a class="no-link" title="Weibo" href="https://weibo.com/1071696872" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-weibo"></i></a></li></ul>
                        </nav>
                    </div>

                    <section id="prism__external_links">
                        <ul>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://github.com/AlanDecode/Maverick" rel="noopener noreferrer nofollow">Maverick</a>ï¼šğŸ„â€ Go My Own Way.
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://www.imalan.cn" rel="noopener noreferrer nofollow">Triple NULL</a>ï¼šHome page for AlanDecode.
                                <span>|</span>
                            </li>
                            
                        </ul>
                    </section>

                    <div class="copyright">
                        <p class="copyright-text">
                            <span class="brand">walker's code blog</span>
                            <span>Copyright Â© 2022 AlanDecode</span>
                        </p>
                        <p class="copyright-text powered-by">
                            | Powered by <a href="https://github.com/AlanDecode/Maverick" class="no-link" target="_blank" rel="noopener noreferrer nofollow">Maverick</a> | Theme <a href="https://github.com/Reedo0910/Maverick-Theme-Prism" target="_blank" class="no-link" rel="noopener noreferrer nofollow">Prism</a>
                        </p>
                    </div>
                    <div class="footer-addon">
                        
                    </div>
                </section>
                <script>
                    var site_build_date = "2019-12-06T12:00+08:00"

                </script>
                <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-efa8685153.js"></script>
            </footer>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    <!--katex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.js"></script>
    <script>
        mathOpts = {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false }
            ]
        };

    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    
</body>

</html>