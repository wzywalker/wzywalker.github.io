<!DOCTYPE HTML>
<html lang="english">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,AlanDecode,Galileo,blog" />
    <meta name="generator" content="Maverick 1.2.1" />
    <meta name="template" content="Prism" />
    <link rel="alternate" type="application/rss+xml" title="walker's code blog &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="walker's code blog &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-b9d78ff38a.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-182e5a8869.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/d69e93fb6d600dd3092b98eaebaa4bce.json"
        }

    </script>
    
<title>ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[6] - walker's code blog</title>
<meta name="author" content="walker" />
<meta name="description" content="Advanced deep-learning best practices" />
<meta property="og:title" content="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[6] - walker's code blog" />
<meta property="og:description" content="Advanced deep-learning best practices" />
<meta property="og:site_name" content="walker's code blog" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/Deep-Learning-with-Python-Notes-6/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2021-10-03T18:29:00-00.00" />
<meta name="twitter:title" content="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[6] - walker's code blog" />
<meta name="twitter:description" content="Advanced deep-learning best practices" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
</head>

<body>
    <div class="container prism-container">
        <header class="prism-header" id="prism__header">
            <h1 class="text-uppercase brand"><a class="no-link" href="/" target="_self">walker's code blog</a></h1>
            <p>coder, reader</p>
            <nav class="prism-nav"><ul><li><a class="no-link text-uppercase " href="/" target="_self">Home</a></li><li><a class="no-link text-uppercase " href="/archives/" target="_self">Archives</a></li><li><a class="no-link text-uppercase " href="/about/" target="_self">About</a></li><li><a href="#" target="_self" class="search-form-input no-link text-uppercase">Search</a></li></ul></nav>
        </header>
        <div class="prism-wrapper" id="prism__wrapper">
            
<main>
    <section class="prism-section row" id="prism__content">
        <article class="yue col-md-8 offset-md-2">
            <h1 class="prism-post-title">ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[6]</h1>
            <div class="prism-post-time">
                <time class="text-uppercase">
                    October 03 2021
                </time>
            </div>
            <div class="prism-content-body">
                <h1>Advanced deep-learning best practices</h1>
<p>è¿™ä¸€ç« æ˜¯ä»‹ç»äº†æ›´å¤šçš„ç½‘ç»œï¼ˆä»kerasçš„å°è£…ç‰¹æ€§å‡ºå‘ï¼‰ç»“æ„å’Œæ¨¡å—ï¼Œä»¥åŠbatch normalization, model ensemblingç­‰çŸ¥è¯†ã€‚</p><h2>beyond Sequential model</h2>
<p>å‰é¢ä»‹ç»çš„éƒ½æ˜¯Sequentialæ¨¡å‹ï¼Œå°±æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°layerå‰åå †å ï¼Œç°å®ä¸­æœ‰å¾ˆå¤šåœºæ™¯å¹¶ä¸æ˜¯ä¸€è¿›ä¸€å‡ºçš„ï¼š</p><ol>
<li>multi-input model</li>
</ol>
<p>å‡è®¾ä¸ºäºŒæ‰‹è¡£ç‰©ä¼°ä»·ï¼š</p><ul>
<li>æ ¼å¼åŒ–çš„å…ƒæ•°æ®ï¼ˆå“ç‰Œï¼Œæ€§åˆ«ï¼Œå¹´é¾„ï¼Œæ¬¾å¼ï¼‰: one-hot, dense</li>
<li>å•†å“çš„æ–‡å­—æè¿°ï¼šRNN or 1D convnet</li>
<li>å›¾ç‰‡å±•ç¤ºï¼š2D convnet</li>
<li>æ¯ä¸ªinputç”¨é€‚åˆè‡ªå·±çš„ç½‘ç»œåšè¾“å‡ºï¼Œç„¶ååˆå¹¶èµ·æ¥ä½œä¸ºä¸€ä¸ªinputï¼Œå›å½’ä¸€ä¸ªä»·æ ¼</li>
</ul>
<ol start="2">
<li>multi-output model (multi-head)</li>
</ol>
<p>ä¸€èˆ¬çš„æ£€æµ‹å™¨é€šå¸¸å°±æ˜¯å¤šå¤´æ¨¡å‹ï¼Œå› ä¸ºæ—¢è¦å›å½’å¯¹è±¡ç±»åˆ«ï¼Œè¿˜è¦å›å½’å‡ºå¯¹è±¡çš„ä½ç½®</p><ol start="3">
<li>graph-like model</li>
</ol>
<p>è¿™ä¸ªåå­—å¾ˆå¥½åœ°å½¢å®¹äº†åšæ·±åº¦å­¦ä¹ æ—¶çœ‹åˆ«äººçš„ç½‘ç»œæ˜¯ä»€ä¹ˆæ ·çš„æ–¹å¼ï¼šçœ‹å›¾ã€‚ç°ä»£çš„SOTAçš„ç½‘ç»œå¾€å¾€æ—¢æ·±ä¸”å¤æ‚ï¼Œè€Œç½‘ç»œç»“æ„ç”»å‡ºæ¥ä¹Ÿä¸å†æ˜¯ä¸€æ¡çº¿æˆ–å‡ ä¸ªç®€å•åˆ†æ”¯ï¼Œè¿™æœ¬ä¹¦å¹²è„†æŠŠå®ƒä»¬å«å›¾å½¢ç½‘ç»œï¼š<code>Inception</code>, <code>Residual</code></p><p>ä¸ºäº†èƒ½æ¶æ„è¿™äº›å¤æ‚çš„ç½‘ç»œï¼Œkerasä»‹ç»äº†æ–°çš„è¯­æ³•ï¼Œå…ˆçœ‹çœ‹æ€ä¹ˆé‡å†™<code>Sequential</code>:</p><div class="highlight"><pre><span></span><span class="n">seq_model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">seq_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,)))</span>
<span class="n">seq_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">seq_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>

<span class="c1"># é‡å†™</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">input_tensor</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">output_tensor</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">output_tensor</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">summayr</span><span class="p">()</span>
</pre></div>
<p>æˆ‘ä»¬è‡ªå·±å®ç°è¿‡é™æ€å›¾ï¼Œæœ€ç»ˆå»æ‰§è¡Œçš„æ—¶å€™èƒ½ä»å°¾è¿½æº¯åˆ°å¤´ï¼Œå¹¶ä»å¤´æ¥å¼€å§‹è®¡ç®—ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š</p><ol>
<li>input, outputæ˜¯Tensorç±»ï¼Œæ‰€ä»¥æœ‰å®Œæ•´çš„å±‚æ¬¡ä¿¡æ¯</li>
<li>outputå¾€ä¸Šè¿½æº¯ï¼Œæœ€ç»ˆæº¯åˆ°ç¼ºå°‘ä¸€ä¸ªinput</li>
<li>è¿™ä¸ªinputæ°å¥½ä¹Ÿæ˜¯Modelçš„æ„é€ å‡½æ•°ä¹‹ä¸€ï¼Œé—­ç¯äº†ã€‚</li>
</ol>
<p>ä¹¦é‡Œè¯´çš„æ›´ç®€å•ï¼Œoutputæ˜¯inputä¸æ–­transformingçš„ç»“æœã€‚å¦‚æœä¼ ä¸€ä¸ªæ²¡æœ‰è¿™ä¸ªå…³ç³»çš„inputè¿›å»ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p><strong>demo</strong></p><p>ç”¨ä¸€ä¸ªQAçš„ä¾‹å­æ¥æ¼”ç¤ºå¤šè¾“å…¥ï¼ˆä¸€ä¸ªé—®å¥ï¼Œä¸€æ®µèµ„æ–™ï¼‰ï¼Œè¾“å‡ºä¸ºç­”æ¡ˆåœ¨èµ„æ–™æ—¶çš„ç´¢å¼•ï¼ˆç®€åŒ–ä¸ºå•ä¸ªè¯ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªè¾“å‡ºï¼‰</p><div class="highlight"><pre><span></span><span class="n">text_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="n">embedded_text</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span>
    <span class="mi">64</span><span class="p">,</span> <span class="n">text_vocabulary_size</span><span class="p">)(</span><span class="n">text_input</span><span class="p">)</span>
<span class="n">encoded_text</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">32</span><span class="p">)(</span><span class="n">embedded_text</span><span class="p">)</span>  <span class="c1"># lstm å¤„ç†èµ„è®¯</span>
<span class="n">question_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;question&#39;</span><span class="p">)</span>


<span class="n">embedded_question</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span>
    <span class="mi">32</span><span class="p">,</span> <span class="n">question_vocabulary_size</span><span class="p">)(</span><span class="n">question_input</span><span class="p">)</span>
<span class="n">encoded_question</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">16</span><span class="p">)(</span><span class="n">embedded_question</span><span class="p">)</span> <span class="c1"># lstm å¤„ç†é—®å¥</span>

<span class="n">concatenated</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">encoded_text</span><span class="p">,</span> <span class="n">encoded_question</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ç«–å‘æ‹¼æ¥ï¼ˆå³ä¸å¢åŠ å†…å®¹åªå¢åŠ æ•°é‡ï¼‰</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">answer_vocabulary_size</span><span class="p">,</span>
                      <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">concatenated</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="n">text_input</span><span class="p">,</span> <span class="n">question_input</span><span class="p">],</span> <span class="n">answer</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>
</pre></div>
<p>è¿™é‡Œæ˜¯æŠŠç­”æ¡ˆç›´æ¥ç»™å›å½’å‡ºæ¥äº†(one-hot)ï¼Œå¦‚æœæ˜¯ç»™å‡ºç­”æ¡ˆçš„é¦–å°¾ä½ç½®ï¼Œé‚£è‚¯å®šåªèƒ½ç”¨ç´¢å¼•äº†ã€‚</p><p><strong>demo</strong></p><p>å¤šå¤´è¾“å‡ºçš„ï¼š</p><div class="highlight"><pre><span></span><span class="c1"># çº¿æ€§å›å½’</span>
<span class="n">age_prediction</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># é€»è¾‘å›å½’</span>
<span class="n">income_prediction</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_income_groups</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;income&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># äºŒå…ƒé€»è¾‘å›å½’</span>
<span class="n">gender_prediction</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">posts_input</span><span class="p">,</span>
              <span class="p">[</span><span class="n">age_prediction</span><span class="p">,</span> <span class="n">income_prediction</span><span class="p">,</span> <span class="n">gender_prediction</span><span class="p">])</span>
</pre></div>
<p>æ¢¯åº¦å›å½’è¦æ±‚lossæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œkerasæä¾›äº†æ–¹æ³•å°†ä¸‰ä¸ªlossåŠ èµ·æ¥ï¼ŒåŒæ—¶ä¸ºäº†é‡çº²ç»Ÿä¸€ï¼Œè¿˜ç»™äº†æƒé‡å‚æ•°ï¼š</p><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span>
<span class="n">loss</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">],</span> <span class="n">loss_weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">])</span>
</pre></div>
<h2>Directed acyclic graphs of layers</h2>
<p>æœ‰å‘æ— ç¯å›¾ã€‚å¯ä»¥ç†è§£ä¸ºæœ€ç»ˆä¸ä¼šå›åˆ°å‡ºå‘ç‚¹ã€‚</p><p>ç°åœ¨ä¼šä»‹ç»çš„æ˜¯å‡ ä¸ª<code>Modules</code>ï¼Œæ„æ€æ˜¯å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªlayerï¼Œæ¥æ„é€ ä½ çš„ç½‘ç»œ/æ¨¡å‹ã€‚</p><h3>Inception Modules</h3>
<ul>
<li>inspired by <code>network-in-network</code></li>
<li>å¯¹åŒä¸€ä¸ªè¾“å…¥åšä¸åŒï¼ˆå±‚æ•°/æ·±åº¦ï¼‰çš„å·ç§¯ï¼ˆä¿è¯æœ€ç»ˆç›¸åŒçš„ä¸‹é‡‡æ ·ç»´åº¦ï¼‰ï¼Œæœ€ååˆå¹¶ä¸ºä¸€ä¸ªè¾“å‡º</li>
<li>å› ä¸ºå·ç§¯çš„æ·±åº¦ä¸å°½ç›¸åŒï¼Œå­¦åˆ°çš„ç©ºé—´ç‰¹å¾ä¹Ÿæœ‰ç²—æœ‰ç»†</li>
</ul>
<h3>Residual Connections</h3>
<ul>
<li>æœ‰äº›åœ°æ–¹å«shortcut</li>
<li>ç”¨çš„æ˜¯ç›¸åŠ ï¼Œä¸æ˜¯concatenate, å¦‚æœå½¢çŠ¶å˜äº†ï¼Œå¯¹earlier activationåšlinear transformation</li>
<li>è§£å†³<code>vanishing gradients</code> and <code>representational bottlenecks</code></li>
<li>adding residual connections to any model that has more than 10 layers is likely to be beneficial.</li>
</ul>
<p><strong>representational bottlenecks</strong></p><p>åºåˆ—æ¨¡å‹æ—¶ï¼Œæ¯ä¸€å±‚çš„è¡¨ç¤ºéƒ½æ¥è‡ªäºå‰ä¸€å±‚ï¼Œå¦‚æœå‰ä¸€å±‚å¾ˆå°ï¼Œæ¯”å¦‚ç»´åº¦è¿‡ä½ï¼Œé‚£ä¹ˆæºå¸¦çš„ä¿¡æ¯é‡ä¹Ÿè¢«å‹ç¼©å¾—å¾ˆæœ‰é™äº†ï¼Œæ•´ä¸ªæ¨¡å‹éƒ½ä¼šè¢«è¿™ä¸ªâ€œç“¶é¢ˆâ€é™åˆ¶ã€‚æ¯”å¦‚éŸ³é¢‘ä¿¡å·å¤„ç†ï¼Œé™ç»´å°±æ˜¯é™é¢‘ï¼Œæ¯”å¦‚åˆ°0-15kHzï¼Œä½†æ˜¯ä¸‹æ¸¸ä»»åŠ¡ä¹Ÿæ²¡æ³•recover dropped frequenciesäº†ã€‚æ‰€æœ‰çš„æŸå¤±éƒ½æ˜¯æ°¸ä¹…çš„ã€‚</p><p>Residual connections, by <code>reinjecting</code> earlier information downstream, partially solve this issue for deep-learning models.ï¼ˆåˆä¸€æ¬¡å¼ºè°ƒ<code>reinject</code>ï¼‰</p><h3>Lyaer weight sharihng</h3>
<p>åœ¨ç½‘ç»œçš„ä¸åŒä½ç½®ç”¨åŒä¸€ä¸ªlayerï¼Œå¹¶ä¸”å‚æ•°ä¹Ÿç›¸åŒã€‚ç­‰äºå…±äº«äº†ç›¸åŒçš„çŸ¥è¯†ï¼Œç›¸åŒçš„è¡¨ç¤ºï¼Œä»¥åŠæ˜¯åŒæ—¶(simultaneously)è®­ç»ƒçš„ã€‚</p><p>ä¸€ä¸ªè¯­ä¹‰ç›¸ä¼¼åº¦çš„ä¾‹å­ï¼Œè¾“å…¥æ˜¯Aå’ŒBè¿˜æ˜¯Bå’ŒAï¼Œæ˜¯ä¸€æ ·çš„ï¼ˆå³å¯ä»¥äº’æ¢ï¼‰ã€‚æ¶æ„ç½‘ç»œçš„æ—¶å€™ï¼Œç”¨LSTMæ¥å¤„ç†å¥å­ï¼Œéœ€è¦åšä¸¤ä¸ªLSTMå—ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥åªåšä¸€ä¸ªLSTMï¼Œåˆ†åˆ«å–‚å…¥ä¸¤ä¸ªå¥å­ï¼Œåˆå¹¶ä¸¤ä¸ªè¾“å‡ºæ¥åšåˆ†ç±»ã€‚å°±æ˜¯è€ƒè™‘åˆ°è¿™ç§äº’æ¢æ€§ï¼Œæ—¢ç„¶èƒ½äº’æ¢ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªlayerä¹Ÿèƒ½åº”ç”¨å¦ä¸€ä¸ªå¥å­ï¼Œå› æ­¤å°±ä¸å¿…è¦å†æ–°å»ºä¸€ä¸ªLSTM.</p><h3>Models as layers</h3>
<p>è®²äº†ä¸¤ç‚¹ï¼š</p><ol>
<li>modelä¹Ÿå¯ä»¥å½“layerä½¿ç”¨</li>
<li>å¤šå¤„ä½¿ç”¨åŒä¸€ä¸ªmodelä¹Ÿæ˜¯å…±äº«å‚æ•°ï¼Œå¦‚ä¸Šä¸€èŠ‚ã€‚</li>
</ol>
<p>ä¸¾äº†ä¸ªåŒæ‘„åƒå¤´ç”¨ä»¥æ„ŸçŸ¥æ·±åº¦çš„ä¾‹å­ï¼Œæ¯ä¸ªæ‘„åƒå¤´éƒ½ç”¨ä¸€ä¸ªXceptionç½‘ç»œæå–ç‰¹å¾ï¼Œä½†æ˜¯å¯ä»¥å…±ç”¨è¿™ä¸ªç½‘ç»œï¼Œå› ä¸ºæ‹çš„æ˜¯åŒæ ·çš„å†…å®¹ï¼Œåªéœ€è¦å¤„ç†ä¸¤ä¸ªæ‘„åƒå¤´æ‹åˆ°çš„å†…å®¹çš„å·®åˆ«å°±èƒ½å­¦ä¹ åˆ°æ·±åº¦ä¿¡æ¯ã€‚å› ä¸ºå¸Œæœ›æ˜¯ç”¨åŒæ ·çš„ç‰¹å¾æå–æœºåˆ¶çš„ã€‚</p><p>éƒ½æ˜¯èœ»èœ“ç‚¹æ°´ã€‚</p><h2>More Advanced</h2>
<h3>Batch Normalization</h3>
<ol>
<li>ç¬¬ä¸€å¥è¯å°±æ˜¯è¯´ä¸ºäº†è®©æ ·æœ¬æ•°æ®çœ‹èµ·æ¥<strong>æ›´ç›¸ä¼¼</strong>ï¼Œè¯´æ˜è¿™æ˜¯åˆè¡·ã€‚</li>
<li>ç„¶åæ˜¯èƒ½æ›´å¥½åœ°æ³›åŒ–åˆ°æœªçŸ¥æ•°æ®ï¼ˆåŒæ ·ä¹Ÿæ˜¯å› ä¸ºbnåå°±<strong>æ›´ç›¸ä¼¼</strong>äº†ï¼‰</li>
<li>æ·±åº¦ç½‘ç»œä¸­æ¯ä¸€å±‚ä¹‹åä¹Ÿéœ€è¦åš<ul>
<li>è¿˜æœ‰ä¸€ä¸ªä¹¦é‡Œæ²¡è®²åˆ°çš„åŸå› ï¼Œå°±æ˜¯æŠŠå€¼ç§»åˆ°æ¿€æ´»å‡½æ•°çš„æ¢¯åº¦å¤§çš„åŒºåŸŸï¼ˆæ¯”å¦‚0é™„è¿‘ï¼‰ï¼Œå¦åˆ™è¿‡å¤§è¿‡å°çš„å€¼åœ¨æ¿€æ´»å‡½æ•°çš„æ›²çº¿é‡Œéƒ½æ˜¯å‡ ä¹æ²¡æœ‰æ¢¯åº¦çš„ä½ç½®</li>
</ul>
</li>
<li>å†…éƒ¨ç”¨çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡(<code>exponential moving average</code>)</li>
<li>ä¸€äº›å±‚æ•°éå¸¸æ·±çš„ç½‘ç»œå¿…é¡»ç”¨BNï¼Œåƒresnet 50, 101, 152, inception v3, xceptionç­‰</li>
</ol>
<h3>Depthwise Separable Convolution</h3>
<p>ä¹‹å‰çš„å·ç§¯ï¼Œä¸ç®¡æœ‰å¤šå°‘ä¸ªlayerï¼Œéƒ½æ˜¯æ”¾åˆ°çŸ©é˜µé‡Œä¸€æ¬¡è®¡ç®—çš„ï¼ŒDSCæŠŠæ¯ä¸€ä¸ªlayeræ‹†å¼€ï¼Œå•ç‹¬åšå·ç§¯ï¼ˆä¸å…±äº«å‚æ•°ï¼‰ï¼Œå› ä¸ºæ²¡æœ‰ä¸€ä¸ªå·¨å¤§çš„çŸ©é˜µï¼Œå˜æˆäº†å‡ ä¸ªå°çŸ©é˜µä¹˜æ³•ï¼Œå‚æ•°é‡ä¹Ÿå¤§å¤§å˜å°‘äº†ã€‚</p><ol>
<li>å¯¹äºå°æ ·æœ¬å¾ˆæœ‰æ•ˆ</li>
<li>å¯¹äºå¤§è§„æ¨¡æ•°æ®é›†ï¼Œå®ƒå¯ä»¥æˆä¸ºé‡Œé¢çš„å›ºå®šç»“æ„çš„æ¨¡å—ï¼ˆå®ƒä¹Ÿæ˜¯Xceptionçš„åŸºç¡€æ¶æ„ä¹‹ä¸€ï¼‰</li>
</ol>
<blockquote>
<p>In the future, itâ€™s likely that depthwise separable convolutions will <code>completely replace regular convolutions</code>, whether for 1D, 2D, or 3D applications, due to their higher representational efficiency.</p></blockquote>
<p>?!!</p><h3>Model ensembling</h3>
<ol>
<li>Ensembling consists of <strong>pooling together</strong> the predictions of a set of different models, to produce better predictions.</li>
<li>æœŸæœ›æ¯ä¸€ä¸ª<code>good model</code>æ‹¥æœ‰<code>part of the truth</code>(éƒ¨åˆ†çš„çœŸç›¸)ã€‚ç›²äººæ‘¸è±¡çš„ä¾‹å­ï¼Œæ²¡æœ‰å“ªä¸ªç›²äººæ‹¥æœ‰ç›´æ¥æ„ŸçŸ¥ä¸€å¤´è±¡çš„èƒ½åŠ›ï¼Œæœºå™¨å­¦ä¹ å¯èƒ½å°±æ˜¯è¿™æ ·ä¸€ä¸ªç›²äººã€‚</li>
<li>The key to making ensembling work is the <code>diversity</code> of the set of classifiers -&gt; å…³é”®æ˜¯è¦â€œå¤šæ ·æ€§â€ã€‚ <code>Diversity</code> is what makes ensembling work.</li>
<li>åƒä¸‡<strong>ä¸è¦</strong>å»ensemblingåŒæ ·çš„ç½‘ç»œä»…ä»…æ”¹å˜åˆå§‹åŒ–è€Œå»trainå¤šæ¬¡çš„ç»“æœã€‚</li>
<li>æ¯”è¾ƒå¥½çš„å®è·µæœ‰ensemble <code>tree-based</code> models(random forests, gradient-boosted trees) å’Œæ·±åº¦ç¥ç»ç½‘ç»œ</li>
<li>ä»¥åŠ<code>wide and deep</code> category of models, blending deep learning with shallow learning.</li>
</ol>
<p>åŒæ ·æ˜¯èœ»èœ“ç‚¹æ°´ã€‚</p>
            </div>
        </article>
        <div class="prism-post-meta col-md-8 offset-md-2">
    <span>walker</span>
    
    <span>/</span>
    <span>
        <a class="category no-link" href="/category/posts/" target="_self">
        posts
        </a>
    </span>
    
    
    <span>/</span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/deep%20learning/" target="_self">#deep learning</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" target="_self">#æ·±åº¦å­¦ä¹ </a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/keras/" target="_self">#keras</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/cv/" target="_self">#cv</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/nlp/" target="_self">#nlp</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/tensorflow/" target="_self">#tensorflow</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/gan/" target="_self">#gan</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/lstm/" target="_self">#lstm</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/language%20mode/" target="_self">#language mode</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/rnn/" target="_self">#rnn</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/heatmap/" target="_self">#heatmap</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/dropout/" target="_self">#dropout</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/machine%20learning/" target="_self">#machine learning</a>
    </span>
    
    
    
    <span>/</span>
    <span class="leancloud_visitors" id="/archives/Deep-Learning-with-Python-Notes-6/" data-flag-title="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[6]"><span class="leancloud-visitors-count"></span> Views</span>
    
</div>
    </section>

    
<section id="prism__pagination" class="prism-pagination" class="col-md-8 offset-md-2">
    <ul>
        
        <li class="next">
            <a class="no-link" href="/archives/Deep-Learning-with-Python-Notes-7/" target="_self" title="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[7]"><i class="fa fa-chevron-left" aria-hidden="true"></i>Newer</a>
        </li>
        
        
        <li class="prev">
            <a class="no-link" href="/archives/Deep-Learning-with-Python-Notes-5/" target="_self" title="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[5]">Older<i class="fa fa-chevron-right" aria-hidden="true"></i></a>
        </li>
        
    </ul>
</section>


    
    <script>
        var initValine = function() {
            new Valine({"enable": true, "el": "#vcomments", "appId": "7tP92LoqK2cggW61DvJmWBo0-gzGzoHsz", "appKey": "iQCtrtlr8eKrQllM03GMESMJ", "visitor": true, "recordIP": true});
        }

    </script>
    <script defer src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js' onload="initValine()"></script>
    <div class="prism-comment-section container" id="prism__comment">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div id="vcomments"></div>
            </div>
        </div>
    </div>
    

</main>

            <footer id="prism__footer">
                <section>
                    <div>
                        <nav class="social-links">
                            <ul><li><a class="no-link" title="Twitter" href="https://twitter.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-twitter"></i></a></li><li><a class="no-link" title="GitHub" href="https://github.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-github"></i></a></li><li><a class="no-link" title="Weibo" href="https://weibo.com/1071696872" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-weibo"></i></a></li></ul>
                        </nav>
                    </div>

                    <section id="prism__external_links">
                        <ul>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://github.com/AlanDecode/Maverick" rel="noopener noreferrer nofollow">Maverick</a>ï¼šğŸ„â€ Go My Own Way.
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://www.imalan.cn" rel="noopener noreferrer nofollow">Triple NULL</a>ï¼šHome page for AlanDecode.
                                <span>|</span>
                            </li>
                            
                        </ul>
                    </section>

                    <div class="copyright">
                        <p class="copyright-text">
                            <span class="brand">walker's code blog</span>
                            <span>Copyright Â© 2022 AlanDecode</span>
                        </p>
                        <p class="copyright-text powered-by">
                            | Powered by <a href="https://github.com/AlanDecode/Maverick" class="no-link" target="_blank" rel="noopener noreferrer nofollow">Maverick</a> | Theme <a href="https://github.com/Reedo0910/Maverick-Theme-Prism" target="_blank" class="no-link" rel="noopener noreferrer nofollow">Prism</a>
                        </p>
                    </div>
                    <div class="footer-addon">
                        
                    </div>
                </section>
                <script>
                    var site_build_date = "2019-12-06T12:00+08:00"

                </script>
                <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-efa8685153.js"></script>
            </footer>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    <!--katex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.js"></script>
    <script>
        mathOpts = {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false }
            ]
        };

    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    
</body>

</html>