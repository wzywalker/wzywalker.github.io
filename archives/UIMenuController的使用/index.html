<!DOCTYPE HTML>
<html lang="english">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,AlanDecode,Galileo,blog" />
    <meta name="generator" content="Maverick 1.2.1" />
    <meta name="template" content="Prism" />
    <link rel="alternate" type="application/rss+xml" title="walker's code blog &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="walker's code blog &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-b9d78ff38a.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-182e5a8869.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/77827c3aeb31044bbd156ff3ba8e3368.json"
        }

    </script>
    
<title>UIMenuControllerçš„ä½¿ç”¨ - walker's code blog</title>
<meta name="author" content="walker" />
<meta name="description" content="#1, åŸºæœ¬ä½¿ç”¨" />
<meta property="og:title" content="UIMenuControllerçš„ä½¿ç”¨ - walker's code blog" />
<meta property="og:description" content="#1, åŸºæœ¬ä½¿ç”¨" />
<meta property="og:site_name" content="walker's code blog" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/UIMenuController%E7%9A%84%E4%BD%BF%E7%94%A8/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2018-03-21T00:00:00-00.00" />
<meta name="twitter:title" content="UIMenuControllerçš„ä½¿ç”¨ - walker's code blog" />
<meta name="twitter:description" content="#1, åŸºæœ¬ä½¿ç”¨" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
</head>

<body>
    <div class="container prism-container">
        <header class="prism-header" id="prism__header">
            <h1 class="text-uppercase brand"><a class="no-link" href="/" target="_self">walker's code blog</a></h1>
            <p>coder, reader</p>
            <nav class="prism-nav"><ul><li><a class="no-link text-uppercase " href="/" target="_self">Home</a></li><li><a class="no-link text-uppercase " href="/archives/" target="_self">Archives</a></li><li><a class="no-link text-uppercase " href="/about/" target="_self">About</a></li><li><a href="#" target="_self" class="search-form-input no-link text-uppercase">Search</a></li></ul></nav>
        </header>
        <div class="prism-wrapper" id="prism__wrapper">
            
<main>
    <section class="prism-section row" id="prism__content">
        <article class="yue col-md-8 offset-md-2">
            <h1 class="prism-post-title">UIMenuControllerçš„ä½¿ç”¨</h1>
            <div class="prism-post-time">
                <time class="text-uppercase">
                    March 21 2018
                </time>
            </div>
            <div class="prism-content-body">
                <p>#1, åŸºæœ¬ä½¿ç”¨
ä»¥å¯¹ä¸€ä¸ªUILabelé•¿æŒ‰å¼¹å‡ºèœå•ä¸ºä¾‹
##å­ç±»åŒ–UILabel
å› ä¸ºéœ€è¦è¦†ç›–è¿™å‡ ä¸ªæ–¹æ³•:
<code>- (BOOL)canBecomeFirstResponder</code>; è¿”å›YES 
åŒæ—¶éœ€è¦åœ¨æ¯æ¬¡UIå…ƒç´ å‡ºç°çš„æ—¶å€™å»<code>becomeFirstResponder</code>ä¸€æ¬¡,æ‰èƒ½æ˜¾ç¤ºå‡ºèœå•. åœ¨æˆ‘çš„å®æµ‹ä¸­, æˆ‘åœ¨<code>ViewDidLoad</code>é‡Œé¢è¿™ä¹ˆåšäº†, å½“UIå¯¼èˆªåˆ°åˆ«çš„é¡µé¢(å¯¼èˆªæ§ä»¶, æˆ–modalé¡µé¢), ç„¶åå›æ¥, èœå•åˆå¤±æ•ˆäº†, æ‰€ä»¥æˆ‘å†™åˆ°<code>ViewWillAppear</code>é‡Œé¢å»äº†, é€šè¿‡</p><p><code>- (BOOL)canPerformAction:(SEL)action withSender:(nullable id)sender</code>;
è¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªmenuItemç”Ÿæˆçš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡, å› æ­¤åœ¨æ–¹æ³•ä½“é‡Œå°±è¦æ ¹æ®actionæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºåœ¨èœå•é‡Œ, å¦‚æœä¸éœ€è¦, åˆ™è¿”å›<code>NO</code>. ä¹Ÿå°±æ˜¯è¯´, å¦‚æœä½ ä»€ä¹ˆéƒ½ä¸åš, ç›´æ¥è¿”ä¸€ä¸ª<code>YES</code>, é‚£ä¹ˆæ‰€æœ‰çš„é»˜è®¤èœå•é¡¹éƒ½ä¼šæ˜¾ç¤ºå‡ºæ¥, æ­¤å¤„æˆ‘ä»¬åªè¦ä¸€ä¸ª<code>Copy</code>é€‰é¡¹å§:</p>
<pre><code>- (BOOL)canPerformAction:(SEL)action withSender:(id)sender {
    return (action == @selector(copy:));
}
</code></pre>
<p>##æ·»åŠ è§¦å‘æ–¹å¼
å¦‚æœæ˜¯ä»¥é•¿æŒ‰ä¸ºè§¦å‘, åˆ™æ·»åŠ é•¿æŒ‰æ‰‹åŠ¿, ä»£ç ç‰‡æ®µå¦‚ä¸‹:</p>
<pre><code>// åœ¨awakeFromNibé‡Œé¢æ·»åŠ å³å¯
UILongPressGestureRecognizer *menuGesture = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(menu:)];
    menuGesture.minimumPressDuration = 0.2;
    [self addGestureRecognizer:menuGesture];

- (void)menu:(UILongPressGestureRecognizer *)sender {
    if (sender.state == UIGestureRecognizerStateBegan) {
        UIMenuController *menu = [UIMenuController sharedMenuController];
        [menu setTargetRect:self.frame inView:self.superView]; // æŠŠè°çš„ä½ç½®å‘Šè¯‰æ§åˆ¶å™¨, èœå•å°±ä¼šä»¥å…¶ä¸ºåŸºå‡†åœ¨åˆé€‚çš„ä½ç½®å‡ºç°
        [menu setMenuVisible:YES animated:YES];
    }
}
</code></pre>
<p>##ç¼–å†™èœå•è¡Œä¸º
ä¸Šé¢æˆ‘ä»¬åªè¦äº†copy, é‚£ä¹ˆå°±è¦†ç›–é»˜è®¤çš„copyæ–¹æ³•:</p>
<pre><code>- (void)copy:(id)sender {
    UIPasteboard *paste = [UIPasteboard generalPasteboard];
    paste.string = self.text;
}
</code></pre>
<p>#2, æ·»åŠ è‡ªå®šä¹‰èœå•é¡¹
è‡ªå®šä¹‰èœå•åªéœ€è¦åœ¨èœå•æ§åˆ¶å™¨æ·»åŠ å‡ ä¸ªitemå³å¯, ç»“åˆä¸Šä¾‹, æˆ‘çš„é‚£ä¸ªlabelæ˜¯æ˜¾ç¤ºç”µè¯å·ç çš„, é‚£ä¹ˆå°±è®©å®ƒå¤šæ˜¾ç¤ºä¸€ä¸ªâ€æ‰“ç”µè¯â€å’Œä¸€ä¸ªâ€å‘çŸ­ä¿¡â€èœå•å§, å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯, åœ¨è®¾ç½®è‡ªå®šä¹‰èœå•é¡¹æ—¶, è®¾ç½®çš„itemsåªå½±å“è‡ªå®šä¹‰éƒ¨åˆ†, æ ‡å‡†èœå•é¡¹ä»ç„¶æ˜¯ç”±<code>canPerformAction</code>å†³å®šçš„:</p>
<pre><code>UIMenuItem *itemCall = [[UIMenuItem alloc] initWithTitle:@&quot;Call&quot; action:@selector(call:)];
UIMenuItem *itemMessage = [[UIMenuItem alloc] initWithTitle:@&quot;Message&quot; action:@selector(message:)];
[[UIMenuController sharedMenuController] setMenuItems: @[itemCall, itemMessage]];
[[UIMenuController sharedMenuController] update];
</code></pre>
<blockquote>
<p>æ³¨, æ·»åŠ äº†ä¸¤ä¸ªèœå•å, canPerformActionéœ€è¦ç›¸åº”å˜åŒ–, è‡ªå·±æƒ³æƒ³åº”è¯¥æ€ä¹ˆæ”¹. ä¹Ÿå¯ä»¥åœ¨ä¸‹ä¸€èŠ‚çœ‹ä»£ç . å½“ç„¶ä¹Ÿè¦è‡ªè¡Œå†™å®Œé‡Œé¢çš„callå’Œmessageæ–¹æ³•, å‚ç…§copyçš„å†™æ³•å³å¯</p></blockquote>
<p>#3, UITableViewCellé•¿æŒ‰æ˜¾ç¤ºèœå•
##æ ‡å‡†èœå•é¡¹
UITableViewé‡Œé¢é•¿é¡¹æ¡ç›®æ˜¾ç¤ºæ ‡å‡†èœå•, åªéœ€è¦å®ç°ä¸‹è¿°ä»£ç†æ–¹æ³•å³å¯:</p>
<pre><code>- (BOOL)tableView:(UITableView *)tableView shouldShowMenuForRowAtIndexPath:(NSIndexPath *)indexPath {
    return YES;
}

- (BOOL)tableView:(UITableView *)tableView canPerformAction:(SEL)action forRowAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender {
    return (action == @selector(copy:)); // åªæ˜¾ç¤ºCopy
}

- (void)tableView:(UITableView *)tableView performAction:(SEL)action forRowAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender {
    if (action == @select(copy:)) {
        UIPasteboard *paste = [UIPasteboard generalPasteboard];
        paste.string = cell.detailLabel.text; // è‡ªè¡Œå†™ä¸šåŠ¡é€»è¾‘
    }
}
</code></pre>
<p>#4, TableViewCellæ·»åŠ è‡ªå®šä¹‰èœå•é¡¹</p><p>åŒæ ·ä¹Ÿå¾—å­ç±»åŒ–ä¸€ä¸ªTableViewCell,ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†è¦†ç›–åŒæ ·çš„å‡ ä¸ªæ–¹æ³•:</p>
<pre><code>- (BOOL)canPerformAction:(SEL)action withSender:(id)sender {
    return (action == @selector(copy:) || action == @selector(call:) || action == @selector(message:)); // æ­¤å¤„æˆ‘ä»¬æŠŠä¸‰ä¸ªè¡Œä¸ºéƒ½å†™å…¨äº†, å›ç­”ä¸Šä¸€èŠ‚çš„é—®é¢˜
}

- (BOOL)canBecomeFirstResponder {
    return YES;
}
</code></pre>
<p>ä½†å› ä¸ºtableViewå·²ç»å®ç°äº†èœå•, æ‰€ä»¥ä¸éœ€è¦æ˜¾å¼ä¸ºæ¯ä¸ªcellå»<code>becomeFirtResponder</code>äº†.</p><p>æ·»åŠ èœå•é¡¹çš„æ–¹æ³•åŒä¸Š, å†™èœå•è¡Œä¸ºçš„æ–¹æ³•åŒ<code>copy:</code>, éƒ½æ˜¯ä¸€æ ·çš„.</p><blockquote>
<p>æ³¨: ä½ ä»¬æˆ–è®¸å·²ç»å‘ç°äº†, æ·»åŠ è‡ªå®šä¹‰èœå•é¡¹çš„æ—¶å€™, ä»ç„¶éœ€è¦<code>canPerformAction</code>, åœ¨è¿™é‡Œ, ä¸tableViewä»£ç†é‡Œé¢çš„åŒåæ–¹æ³•æœ‰ä»€ä¹ˆå…³ç³»? æ˜¯çš„, ä¸¤ä¸ªéƒ½è¦å†™, tableViewé‡Œé¢çš„åªä¼šå½±å“æ ‡å‡†èœå•, æ–‡æ¡£è¯´åªæ”¯æŒè¿™ä¸¤ä¸ª<code>UIResponderStandardEditActions</code> (copy/paste)</p></blockquote>
<blockquote>
<p>æ³¨: ç„¶è€Œ, <code>- (void)tableView:(UITableView *)tableView performAction:(SEL)action forRowAtIndexPath:(NSIndexPath *)indexPath withSender:(id)sender</code>è¿™ä¸ªæ–¹æ³•å´æœ‰ç‚¹åˆ«æ‰­, ä¸€æ¥ä¸éœ€è¦å»å®ç°äº†, äºŒæ¥åˆä¸èƒ½æ³¨é‡Šæ‰(ä½ ä»¬è‡ªå·±è¯•ä¸€ä¸‹), ç­‰äºä¸€å®šè¦ç•™ä¸€ä¸ªç©ºçš„æ–¹æ³•ä½“åœ¨é‚£é‡Œâ€¦</p></blockquote>

            </div>
        </article>
        <div class="prism-post-meta col-md-8 offset-md-2">
    <span>walker</span>
    
    <span>/</span>
    <span>
        <a class="category no-link" href="/category/posts/" target="_self">
        posts
        </a>
    </span>
    
    
    <span>/</span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/menu/" target="_self">#menu</a>
    </span>
    
    
    
    <span>/</span>
    <span class="leancloud_visitors" id="/archives/UIMenuController%E7%9A%84%E4%BD%BF%E7%94%A8/" data-flag-title="UIMenuControllerçš„ä½¿ç”¨"><span class="leancloud-visitors-count"></span> Views</span>
    
</div>
    </section>

    
<section id="prism__pagination" class="prism-pagination" class="col-md-8 offset-md-2">
    <ul>
        
        <li class="next">
            <a class="no-link" href="/archives/Xcode%E8%87%AA%E5%A2%9Ebuild%E5%8F%B7/" target="_self" title="Xcodeè‡ªå¢buildå·"><i class="fa fa-chevron-left" aria-hidden="true"></i>Newer</a>
        </li>
        
        
        <li class="prev">
            <a class="no-link" href="/archives/OC%E9%9D%99%E6%80%81%E5%BA%93%E9%87%8CNSClassFromString%E5%BE%97%E5%88%B0nil%E7%9A%84%E8%A7%A3%E5%86%B3/" target="_self" title="OCé™æ€åº“é‡ŒNSClassFromStringå¾—åˆ°nilçš„è§£å†³">Older<i class="fa fa-chevron-right" aria-hidden="true"></i></a>
        </li>
        
    </ul>
</section>


    
    <script>
        var initValine = function() {
            new Valine({"enable": true, "el": "#vcomments", "appId": "7tP92LoqK2cggW61DvJmWBo0-gzGzoHsz", "appKey": "iQCtrtlr8eKrQllM03GMESMJ", "visitor": true, "recordIP": true});
        }

    </script>
    <script defer src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js' onload="initValine()"></script>
    <div class="prism-comment-section container" id="prism__comment">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div id="vcomments"></div>
            </div>
        </div>
    </div>
    

</main>

            <footer id="prism__footer">
                <section>
                    <div>
                        <nav class="social-links">
                            <ul><li><a class="no-link" title="Twitter" href="https://twitter.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-twitter"></i></a></li><li><a class="no-link" title="GitHub" href="https://github.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-github"></i></a></li><li><a class="no-link" title="Weibo" href="https://weibo.com/1071696872" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-weibo"></i></a></li></ul>
                        </nav>
                    </div>

                    <section id="prism__external_links">
                        <ul>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://github.com/AlanDecode/Maverick" rel="noopener noreferrer nofollow">Maverick</a>ï¼šğŸ„â€ Go My Own Way.
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://www.imalan.cn" rel="noopener noreferrer nofollow">Triple NULL</a>ï¼šHome page for AlanDecode.
                                <span>|</span>
                            </li>
                            
                        </ul>
                    </section>

                    <div class="copyright">
                        <p class="copyright-text">
                            <span class="brand">walker's code blog</span>
                            <span>Copyright Â© 2022 AlanDecode</span>
                        </p>
                        <p class="copyright-text powered-by">
                            | Powered by <a href="https://github.com/AlanDecode/Maverick" class="no-link" target="_blank" rel="noopener noreferrer nofollow">Maverick</a> | Theme <a href="https://github.com/Reedo0910/Maverick-Theme-Prism" target="_blank" class="no-link" rel="noopener noreferrer nofollow">Prism</a>
                        </p>
                    </div>
                    <div class="footer-addon">
                        
                    </div>
                </section>
                <script>
                    var site_build_date = "2019-12-06T12:00+08:00"

                </script>
                <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-efa8685153.js"></script>
            </footer>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    <!--katex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.js"></script>
    <script>
        mathOpts = {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false }
            ]
        };

    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    
</body>

</html>