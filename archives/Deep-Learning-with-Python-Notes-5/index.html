<!DOCTYPE HTML>
<html lang="english">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,AlanDecode,Galileo,blog" />
    <meta name="generator" content="Maverick 1.2.1" />
    <meta name="template" content="Prism" />
    <link rel="alternate" type="application/rss+xml" title="walker's code blog &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="walker's code blog &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-b9d78ff38a.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-182e5a8869.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/9fc2b5f540cd4374ca2ea87dc9a6da43.json"
        }

    </script>
    
<title>ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[5] - walker's code blog</title>
<meta name="author" content="walker" />
<meta name="description" content="Deep learning for text and sequences" />
<meta property="og:title" content="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[5] - walker's code blog" />
<meta property="og:description" content="Deep learning for text and sequences" />
<meta property="og:site_name" content="walker's code blog" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/Deep-Learning-with-Python-Notes-5/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2021-09-27T13:29:00-00.00" />
<meta name="twitter:title" content="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[5] - walker's code blog" />
<meta name="twitter:description" content="Deep learning for text and sequences" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
</head>

<body>
    <div class="container prism-container">
        <header class="prism-header" id="prism__header">
            <h1 class="text-uppercase brand"><a class="no-link" href="/" target="_self">walker's code blog</a></h1>
            <p>coder, reader</p>
            <nav class="prism-nav"><ul><li><a class="no-link text-uppercase " href="/" target="_self">Home</a></li><li><a class="no-link text-uppercase " href="/archives/" target="_self">Archives</a></li><li><a class="no-link text-uppercase " href="/about/" target="_self">About</a></li><li><a href="#" target="_self" class="search-form-input no-link text-uppercase">Search</a></li></ul></nav>
        </header>
        <div class="prism-wrapper" id="prism__wrapper">
            
<main>
    <section class="prism-section row" id="prism__content">
        <article class="yue col-md-8 offset-md-2">
            <h1 class="prism-post-title">ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[5]</h1>
            <div class="prism-post-time">
                <time class="text-uppercase">
                    September 27 2021
                </time>
            </div>
            <div class="prism-content-body">
                <h1>Deep learning for text and sequences</h1>
<p>ç©ºé—´ä¸Šçš„åºåˆ—ï¼Œæ—¶é—´ä¸Šçš„åºåˆ—ç»„æˆçš„æ•°æ®ï¼Œæ¯”å¦‚æ–‡æœ¬ï¼Œè§†é¢‘ï¼Œå¤©æ°”æ•°æ®ç­‰ï¼Œä¸€èˆ¬ç”¨<code>recurrent neural network</code>(RNN)å’Œ<code>1D convnets</code></p><blockquote>
<p>å…¶å®å¾ˆå¤šåè¯ï¼ŒåŒ…æ‹¬convnetsï¼Œæˆ‘å¹¶æ²¡æœ‰åœ¨åˆ«çš„åœ°æ–¹çœ‹åˆ°è¿‡ï¼Œå¥½åƒå°±æ˜¯ä½œè€…è‡ªå·±å‘æ˜çš„ï¼Œä½†è¿™äº›ä¸é‡è¦ï¼ŒçŸ¥é“å®ƒæè¿°çš„æ˜¯ä»€ä¹ˆå°±å¯ä»¥äº†ï¼Œä¸ä¸€å®šè¦å…¬è®¤æœ¯è¯­ã€‚</p></blockquote>
<p>é€šç”¨åœºæ™¯ï¼š</p><ul>
<li>[åˆ†ç±»: æ–‡æœ¬åˆ†ç±»] Document classification and timeseries classification, such as identifying the topic of an article or the author of a book</li>
<li>[åˆ†ç±»: æ–‡æœ¬æ¯”è¾ƒ] Timeseries comparisons, such as estimating how closely related two documents or two stock tickers are</li>
<li>[åˆ†ç±»: ç”Ÿæˆ] Sequence-to-sequence learning, such as decoding an English sentence into French</li>
<li>[åˆ†ç±»: æƒ…æ„Ÿåˆ†æ]Sentiment analysis, such as classifying the sentiment of tweets or movie reviews as positive or negative</li>
<li>[å›å½’: é¢„æµ‹]Timeseries forecasting, such as predicting the future weather at a certain location, given recent weather data</li>
</ul>
<p>æˆ‘ç”»è›‡æ·»è¶³åœ°åŠ äº†æ˜¯åˆ†ç±»é—®é¢˜è¿˜æ˜¯å›å½’é—®é¢˜.</p><blockquote>
<p>none of these deeplearning models truly understand text in a human sense</p></blockquote>
<p>Deep learning for natural-language processing is <code>pattern recognition</code> applied to words, sentences, and paragraphs, in much <strong>the same</strong> way that computer vision is pattern recognition applied to pixels.</p><h2>tokenizer</h2>
<p>å›¾åƒç”¨åƒç´ ä¸Šçš„é¢œè‰²æ¥æ•°å­—åŒ–ï¼Œé‚£æ–‡å­—ä¹ŸæŠŠä»€ä¹ˆæ•°å­—åŒ–å‘¢ï¼Ÿ</p><ul>
<li>æ‹†åˆ†ä¸ºè¯ï¼ŒæŠŠæ¯ä¸ªè¯è½¬åŒ–æˆå‘é‡</li>
<li>æ‹†åˆ†ä¸ºå­—ï¼ˆæˆ–å­—ç¬¦ï¼‰ï¼ŒæŠŠæ¯ä¸ªå­—ç¬¦è½¬åŒ–ä¸ºå‘é‡</li>
<li>æŠŠå­—ï¼ˆè¯ï¼‰ä¸å‰nä¸ªå­—ï¼ˆè¯ï¼‰ç»„åˆæˆå•å…ƒï¼Œè½¬åŒ–ä¸ºå‘é‡ï¼Œï¼ˆç±»ä¼¼æ»‘çª—ï¼‰ï¼ŒN-Grams</li>
</ul>
<p>all of above are <code>tokens</code>, and breaking text into such tokens is called <code>tokenization</code>. These vectors, packed into sequence tensors, are fed into deep neural networks.</p><p><code>N-grams</code>è¿™ç§ç”Ÿæˆçš„tokenæ˜¯æ— åºçš„ï¼Œå°±åƒä¸€ä¸ªè¢‹å­è£…äº†ä¸€å †è¯ï¼š<code>bag-of-words</code>: a set of tokens rather than a list of sequence.</p><p>æ‰€ä»¥å¥å­ç»“æ„ä¿¡æ¯ä¸¢å¤±äº†ï¼Œæ›´é€‚åˆç”¨äºæµ…å±‚ç½‘ç»œã€‚ä½œä¸ºä¸€ç§rigid, brittleï¼ˆåƒµç¡¬çš„ï¼Œè„†å¼±çš„ï¼‰ç‰¹å¾å·¥ç¨‹æ–¹å¼ï¼Œæ·±åº¦å­¦ä¹ é‡‡ç”¨å¤šå±‚ç½‘ç»œæ¥æå–ç‰¹å¾ã€‚</p><h2>vectorizer</h2>
<p>token -&gt; vector:</p><ul>
<li>one-hot encoding</li>
<li>token/word embedding (word2vec)</li>
</ul>
<h3>one-hot</h3>
<ol>
<li>ä»¥tokenæ€»æ•°é‡ï¼ˆä¸€èˆ¬å°±æ˜¯å­—å…¸å®¹é‡ï¼‰ä¸ºç»´åº¦</li>
<li>ä¸€èˆ¬æ— åºï¼Œæ‰€ä»¥ç”Ÿæˆçš„æ—¶å€™åªéœ€è¦æŒ‰å‡ºç°é¡ºåºç¼–ç´¢å¼•å°±å¥½äº†</li>
<li>æœ‰æ—¶å€™ä¹Ÿå¾€å¾€ä¼´éšä¸¢å¼ƒä¸å¸¸ç”¨è¯ï¼Œä»¥å‡å°ç»´åº¦</li>
<li>ä¹Ÿå¯ä»¥åœ¨å­—ç¬¦ç»´åº¦ç¼–ç ï¼ˆç»´åº¦æ›´ä½ï¼‰</li>
<li>ä¸€ä¸ªå°æŠ€å·§ï¼Œå¦‚æœç´¢å¼•æ•°å­—è¿‡å¤§ï¼Œå¯ä»¥æŠŠå•è¯hashåˆ°å›ºå®šç»´åº¦(æœªè·Ÿè¿›)</li>
</ol>
<p>ç‰¹ç‚¹/é—®é¢˜ï¼š</p><ul>
<li>sparse</li>
<li>high-dimensional, æ¯”å¦‚å‡ åƒå‡ ä¸‡</li>
<li>no spatial relationship</li>
<li>hardcoded</li>
</ul>
<h3>word embeddings</h3>
<ul>
<li>Dense</li>
<li>Lower-dimensionalï¼Œæ¯”å¦‚128ï¼Œ256...</li>
<li>Spatial relationships (è¯­ä¹‰æ¥è¿‘çš„å‘é‡ç©ºé—´ä¸Šä¹Ÿæ¥è¿‘)</li>
<li>Learned from data</li>
</ul>
<p>to obtain word embeddings:</p><ol>
<li>å½“æˆè®­ç»ƒå‚æ•°ä¹‹ä¸€(ä»¥Embeddingå±‚çš„èº«ä»½)ï¼Œè·Ÿç€è®­ç»ƒä»»åŠ¡ä¸€èµ·è®­ç»ƒ</li>
<li>pretrained word embeddings<ul>
<li>Word2Vec(2013, google)<ul>
<li>CBOW</li>
<li>Skip-Gram</li>
</ul>
</li>
<li>GloVe(2014, Stanford))</li>
<li>å‰ææ˜¯è¯­è¨€ç¯å¢ƒå·®ä¸å¤šï¼Œä¸åŒå­¦ç§‘/ä¸“ä¸š/è¡Œä¸šé‡Œçš„è¯çš„å…³ç³»æ˜¯å®Œå…¨ä¸åŒçš„<ul>
<li>GloVeä»wikipediaå’Œå¾ˆå¤šé€šç”¨è¯­æ–™åº“é‡Œè®­ç»ƒï¼Œå¯ä»¥å°è¯•åœ¨è®¸å¤šéä¸“ä¸šåœºæ™¯é‡Œä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>kerasåŠ è½½è®­ç»ƒè¯å‘é‡çš„æ–¹å¼ï¼š</p><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_weights</span><span class="p">([</span><span class="n">embedding_matrix</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
<p>pytorchï¼š</p><div class="highlight"><pre><span></span><span class="c1"># TEXT, LABELä¸ºtorchtextçš„Fieldå¯¹è±¡</span>
<span class="kn">from</span> <span class="nn">torchtext.vocab</span> <span class="kn">import</span> <span class="n">Vectors</span>
<span class="n">vectors</span><span class="o">=</span><span class="n">Vectors</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;./sgns.sogou.word&#39;</span><span class="p">)</span> <span class="c1">#ä½¿ç”¨é¢„è®­ç»ƒçš„è¯å‘é‡ï¼Œç»´åº¦ä¸º300Dimension</span>
<span class="n">TEXT</span><span class="o">.</span><span class="n">build_vocab</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">vectors</span><span class="o">=</span><span class="n">vectors</span><span class="p">)</span> <span class="c1">#æ„å»ºè¯å…¸</span>
<span class="n">LABEL</span><span class="o">.</span><span class="n">build_vocab</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEXT</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
<span class="n">vocab_vectors</span> <span class="o">=</span> <span class="n">TEXT</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span> <span class="c1">#å‡†å¤‡å¥½é¢„è®­ç»ƒè¯å‘é‡</span>

<span class="bp">self</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">num_embeddings</span><span class="o">=</span><span class="n">vocab_size</span><span class="err">ï¼Œ</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="n">embedding_size</span><span class="p">)</span>

<span class="c1"># ä¸Šé¢æ˜¯ä¸ºäº†å›é¡¾ï¼ŒçœŸæ­£ç”¨æ¥åšå¯¹æ¯”çš„æ˜¯ä¸‹é¢è¿™ä¸¤å¥</span>
<span class="bp">self</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">vocab_vectors</span><span class="p">))</span>
<span class="bp">self</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
<blockquote>
<p>é¢„è®­ç»ƒè¯å‘é‡ä¹Ÿå¯ä»¥ç»§ç»­è®­ç»ƒï¼Œä»¥å¾—åˆ°task-specific embedding</p></blockquote>
<h2>Recurrent neural networks(RNN)</h2>
<p>sequence, time seriesç±»çš„æ•°æ®ï¼Œå¤©ç„¶ä¼šå—åˆ°å‰åæ•°æ®çš„å½±å“ï¼ŒRNNé€šè¿‡å°†å½“å‰tokenè®¡ç®—çš„æ—¶å€™å¼•å…¥ä¸Šä¸€ä¸ªtokençš„è®¡ç®—ç»“æœï¼ˆåå‘çš„è¯å°±èƒ½è·å¾—ä¸‹ä¸€ä¸ªtokençš„ç»“æœï¼‰ä»¥è·å–ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ã€‚</p><p>å‰é¢ç¢°åˆ°çš„ç½‘ç»œï¼Œæ•°æ®æ¶ˆè´¹å®Œå°±å¾€å‰èµ°ï¼ˆæŒ‰æˆ‘è¿™ç§è¯´æ³•ï¼Œåé¢è¿˜æœ‰å¾ˆå¤šâ€œç­‰ç€äºŒæ¬¡æ¶ˆè´¹çš„â€æ¨¡å—ï¼Œæ¯”å¦‚inception, resdualç­‰ç­‰ï¼‰ï¼Œå«åš<code>feedforward network</code>ã€‚æ˜¾ç„¶ï¼ŒRNNä¸­ï¼Œä¸€ä¸ªtokenäº§ç”Ÿè¾“å‡ºåå¹¶ä¸æ˜¯ç›´æ¥ä¸¢ç»™ä¸‹ä¸€å±‚ï¼Œè€Œæ˜¯è¿˜å¤åˆ¶äº†ä¸€ä»½ä¸¢ç»™äº†åŒå±‚çš„ä¸‹ä¸€ä¸ªtoken. è¿™æ ·ï¼Œå½“å‰tokençš„<code>output</code>æˆäº†ä¸‹ä¸€ä¸ªtokençš„<code>state</code>ã€‚</p><ul>
<li>å› ä¸ºä¸€ä¸ªoutputå…¶å®å«æœ‰â€œå‰é¢â€œæ‰€æœ‰çš„ä¿¡æ¯ï¼Œä¸€èˆ¬åªéœ€è¦æœ€åä¸€ä¸ªoutput</li>
<li>å¦‚æœæ˜¯å †å å¤šå±‚ç½‘ç»œï¼Œåˆ™éœ€è¦è¿”å›<strong>æ‰€æœ‰</strong>output</li>
</ul>
<p>åºåˆ—è¿‡é•¿æ¢¯åº¦å°±æ¶ˆå¤±äº†ï¼Œæ‰€è°“çš„<strong>é—å¿˜</strong> ï¼ˆæ¨å¯¼è§å¦ä¸€ç¯‡ç¬”è®°ï¼Œï¼‰  -&gt; <code>LSTM</code>, <code>GRU</code></p><h3>Long Short-Term Memory(LSTM)</h3>
<ol>
<li>æƒ³è±¡æœ‰ä¸€æ ¹ä¼ é€å¸¦ç©¿è¿‡sequence</li>
<li>åŒä¸€ç»„inputå’Œstateä¼šè¿›è¡Œä¸‰æ¬¡ç›¸åŒçš„çº¿æ€§å˜æ¢ï¼Œæœ‰æ²¡æœ‰è”æƒ³åˆ°<code>transformer</code>ç”¨åŒä¸€ä¸ªè¾“å‡ºå»ç”Ÿæˆ<code>q, k, v</code>ï¼Ÿ</li>
</ol>
<div class="highlight"><pre><span></span><span class="n">output_t</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">state_t</span><span class="p">,</span> <span class="n">Uo</span><span class="p">)</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">input_t</span><span class="p">,</span> <span class="n">Wo</span><span class="p">)</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">C_t</span><span class="p">,</span> <span class="n">Vo</span><span class="p">)</span> <span class="o">+</span> <span class="n">bo</span><span class="p">)</span>
<span class="n">i_t</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">state_t</span><span class="p">,</span> <span class="n">Ui</span><span class="p">)</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">input_t</span><span class="p">,</span> <span class="n">Wi</span><span class="p">)</span> <span class="o">+</span> <span class="n">bi</span><span class="p">)</span> 
<span class="n">f_t</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">state_t</span><span class="p">,</span> <span class="n">Uf</span><span class="p">)</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">input_t</span><span class="p">,</span> <span class="n">Wf</span><span class="p">)</span> <span class="o">+</span> <span class="n">bf</span><span class="p">)</span> 
<span class="n">k_t</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">state_t</span><span class="p">,</span> <span class="n">Uk</span><span class="p">)</span> <span class="o">+</span> <span class="n">dot</span><span class="p">(</span><span class="n">input_t</span><span class="p">,</span> <span class="n">Wk</span><span class="p">)</span> <span class="o">+</span> <span class="n">bk</span><span class="p">)</span>

<span class="n">c_t</span><span class="o">+</span><span class="mi">1</span> <span class="o">=</span> <span class="n">i_t</span> <span class="o">*</span> <span class="n">k_t</span> <span class="o">+</span> <span class="n">c_t</span> <span class="o">*</span> <span class="n">f_t</span>  <span class="c1"># ä»ç„¶æœ‰qï¼Œkï¼Œvçš„æ„æ€ï¼ˆi,käº’ä¹˜ï¼ŒåŠ ä¸Šfï¼Œ ç”Ÿæˆæ–°cï¼‰</span>
</pre></div>
<blockquote>
<p>ä¸è¦å»è€ƒè™‘å“ªä¸ªæ˜¯<strong>é—å¿˜é—¨</strong>ï¼Œ<strong>è®°å¿†é—¨</strong>ï¼Œè¿˜æ˜¯<strong>è¾“å‡ºé—¨</strong>ï¼Œæœ€ç»ˆæ˜¯ç”±weightså†³å®šçš„ï¼Œè€Œä¸æ˜¯è®¾è®¡ã€‚</p></blockquote>
<p>Just keep in mind what the LSTM cell is meant to do:</p><blockquote>
<p>allow past information to be <code>reinjected</code> at a later time, thus fighting the vanishing-gradient problem.</p></blockquote>
<p>å…³é”®è¯ï¼šreinject</p><h3>dropout</h3>
<p>ä¸ç®¡æ˜¯kerasè¿˜æ˜¯pytorchï¼Œéƒ½å¸®ä½ éšè—äº†dropoutçš„å‘ã€‚ ä½ èƒ½çœ‹åˆ°åº”ç”¨è¿™äº›æ¡†æ¶çš„æ—¶å€™ï¼Œæ˜¯éœ€è¦ä½ æŠŠdropoutä¼ è¿›å»çš„ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨æ¥ä¸€ä¸ªdropoutlayerï¼ŒåŸå› æ˜¯éœ€è¦åœ¨åºåˆ—æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šåº”ç”¨åŒæ ·çš„dropout maskæ‰èƒ½èµ·ä½œç”¨ï¼Œä¸ç„¶å°±ä¼šèµ·åˆ°åä½œç”¨ã€‚</p><p>keraså°è£…å¾—è¦å¤æ‚ä¸€ç‚¹ï¼š</p><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">GRU</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span>
                    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                    <span class="n">recurrent_dropout</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">float_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
<h3>stacking recurrent layers</h3>
<p>å‰é¢è¯´è¿‡ï¼Œè®¾è®¡å¥½çš„æ¨¡å‹çš„ä¸€ä¸ªåˆ¤æ–­ä¾æ®æ˜¯è‡³å°‘è®©æ¨¡å‹èƒ½è·‘åˆ°overfittingã€‚å¦‚æœåˆ°äº†overfittingï¼Œè¡¨ç°è¿˜ä¸æ˜¯å¾ˆå¥½ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘å¢åŠ æ¨¡å‹å®¹é‡ï¼ˆå æ›´å¤šå±‚ï¼Œä»¥åŠæ‹“å®½layerçš„è¾“å‡ºç»´åº¦ï¼‰</p><p>å †å å¤šå±‚å°±éœ€è¦ç”¨åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„è¾“å‡ºï¼Œè€Œä¸åªå…³å¿ƒæœ€åä¸€ä¸ªè¾“å‡ºäº†ã€‚</p><h3>Bidriectional</h3>
<p>keraså¥‡è‘©çš„bidirectionalè¯­æ³•ï¼š</p><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Bidirectional</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">32</span><span class="p">)))</span>
</pre></div>
<p>å…¶å®è¿™æ˜¯è®¾è®¡æ¨¡å¼åœ¨ç±»çš„å°è£…ä¸Šçš„å…¸å‹åº”ç”¨ï¼Œå–„ç”¨ç»§æ‰¿å’Œå¤šæ€ï¼Œæ— ä¾µå…¥åœ°æ‰©å±•ç±»çš„æ–¹æ³•å’Œå±æ€§ï¼Œè€Œä¸æ˜¯ä¸æ–­é­”æ”¹åŸä»£ç ï¼ŒåŠ å‚æ•°ï¼Œæ”¹APIã€‚ä½†åœ¨è„šæœ¬è¯­è¨€é£æ ¼é‡Œçš„ç¯å¢ƒé‡Œï¼Œè¿™ä¹ˆç©å°±æœ‰ç‚¹æ ¼æ ¼ä¸å…¥äº†ã€‚</p><h2>Sequence processing with convnets</h2>
<ol>
<li>å·ç§¯ç”¨åˆ°åºåˆ—ä¸Šå»ä¹Ÿæ˜¯å¯ä»¥çš„</li>
<li>ä¸€ä¸ªå‘é‡åªè¡¨ç¤ºä¸€ä¸ªtokenï¼Œå¦‚æœæŠŠtokençš„å‘é‡æ‰“æ–­å°±è¿èƒŒäº†tokenæ˜¯æœ€å°å•å…ƒçš„åˆè¡·ï¼Œæ‰€ä»¥åºåˆ—ä¸Šçš„å·ç§¯ï¼Œä¸å¯èƒ½åƒå›¾ç‰‡ä¸Šä¸¤ä¸ªæ–¹å‘å»æ»‘çª—äº†ã€‚(<code>Conv1D</code>çš„ç”±æ¥)</li>
<li>ä¸€ä¸ªå·ç§¯æ ¸ç­‰äºæå–äº†nä¸ªå…³è”çš„ä¸Šä¸‹æ–‡ï¼ˆæœ‰ç‚¹ç±»ä¼¼<code>n-grams</code>ï¼‰ï¼Œå †å å¾—å¤Ÿæ·±æ„Ÿå—é‡æ›´å¤§ï¼Œå¯èƒ½å¾—åˆ°æ›´å¤§çš„ä¸Šä¸‹æ–‡ã€‚</li>
<li>ä½†ä»ç„¶ç†è§£ä¸ºfilteråœ¨å…¨å¥é‡Œæå–å±€éƒ¨ç‰¹å¾</li>
</ol>
<p>å½’æ¡•ç»“åº•ï¼Œå›¾ç‰‡çš„æœ€å°å•å…ƒæ˜¯ä¸€ä¸ªåƒç´ ï¼ˆä¸€ä¸ªæ•°å­—ï¼‰ï¼Œè€Œåºåˆ—ï¼ˆæˆ‘ä»¬è¿™é‡Œè¯´æ–‡æœ¬ï¼‰çš„æœ€å°å•å…ƒæ˜¯tokenï¼Œè€Œtokenåˆè¢«æˆ‘ä»¬å®šä¹‰ä¸ºvectorï¼ˆä¸€ç»„æ•°å­—ï¼‰äº†ï¼Œé‚£ä¹ˆå·ç§¯æ ¸å°±é™åˆ¶åœ¨è‡³å°‘è¦è¾¾åˆ°æœ€å°å•å…ƒ(vector)çš„ç»´åº¦äº†ã€‚</p><h3>Combining CNNs and RNNs to process long sequences</h3>
<p>å·ç§¯èƒ½é€šè¿‡åŠ æ·±ç½‘ç»œè·å–æ›´å¤§çš„æ„Ÿå—é‡ï¼Œä½†ä»ç„¶æ˜¯â€œä½ç½®æ— å…³â€çš„ï¼Œå› ä¸ºæ¯ä¸ªfilteræœ¬å°±æ˜¯åœ¨æ•´ä¸ªåºåˆ—é‡Œæœç´¢ç›¸åŒçš„ç‰¹å¾ã€‚</p><p>ä½†æ˜¯å®ƒç¡®å®æå–å‡ºäº†ç‰¹å¾ï¼Œæ˜¯å¦å¯æŠŠä½ç½®å…³ç³»ç­‰ä¸Šä¸‹æ–‡çš„ä½œä¸šäº¤ç»™ä¸‹æ¸¸ä»»åŠ¡RNNåšå‘¢ï¼Ÿ</p><figure  style="flex: 50.750750750750754" ><img width="676" height="666" src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/archives/assets/bc69a05bd9def95c42c6ce450a5cf164.png" alt=""/></figure><p>ä¸ä½†å®ç°ï¼Œè€Œä¸”å †å ä¸¤ç§ç½‘ç»œï¼Œè¿˜å¯ä»¥æŠŠæ•°æ®é›†åšå¾—æ›´å¤§ï¼ˆCNNæ˜¯çŸ©é˜µè¿ç®—ï¼Œè¿˜èƒ½ç”¨GPUåŠ é€Ÿï¼‰ã€‚</p>
            </div>
        </article>
        <div class="prism-post-meta col-md-8 offset-md-2">
    <span>walker</span>
    
    <span>/</span>
    <span>
        <a class="category no-link" href="/category/posts/" target="_self">
        posts
        </a>
    </span>
    
    
    <span>/</span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/deep%20learning/" target="_self">#deep learning</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" target="_self">#æ·±åº¦å­¦ä¹ </a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/keras/" target="_self">#keras</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/cv/" target="_self">#cv</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/nlp/" target="_self">#nlp</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/tensorflow/" target="_self">#tensorflow</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/gan/" target="_self">#gan</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/lstm/" target="_self">#lstm</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/language%20mode/" target="_self">#language mode</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/rnn/" target="_self">#rnn</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/heatmap/" target="_self">#heatmap</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/dropout/" target="_self">#dropout</a>
    </span>
    
    <span class="prism-tag">
        <a class="no-link" href="/tag/machine%20learning/" target="_self">#machine learning</a>
    </span>
    
    
    
    <span>/</span>
    <span class="leancloud_visitors" id="/archives/Deep-Learning-with-Python-Notes-5/" data-flag-title="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[5]"><span class="leancloud-visitors-count"></span> Views</span>
    
</div>
    </section>

    
<section id="prism__pagination" class="prism-pagination" class="col-md-8 offset-md-2">
    <ul>
        
        <li class="next">
            <a class="no-link" href="/archives/Deep-Learning-with-Python-Notes-6/" target="_self" title="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[6]"><i class="fa fa-chevron-left" aria-hidden="true"></i>Newer</a>
        </li>
        
        
        <li class="prev">
            <a class="no-link" href="/archives/Deep-Learning-with-Python-Notes-4/" target="_self" title="ã€ŠDeep Learning with Pythonã€‹ç¬”è®°[4]">Older<i class="fa fa-chevron-right" aria-hidden="true"></i></a>
        </li>
        
    </ul>
</section>


    
    <script>
        var initValine = function() {
            new Valine({"enable": true, "el": "#vcomments", "appId": "7tP92LoqK2cggW61DvJmWBo0-gzGzoHsz", "appKey": "iQCtrtlr8eKrQllM03GMESMJ", "visitor": true, "recordIP": true});
        }

    </script>
    <script defer src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js' onload="initValine()"></script>
    <div class="prism-comment-section container" id="prism__comment">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div id="vcomments"></div>
            </div>
        </div>
    </div>
    

</main>

            <footer id="prism__footer">
                <section>
                    <div>
                        <nav class="social-links">
                            <ul><li><a class="no-link" title="Twitter" href="https://twitter.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-twitter"></i></a></li><li><a class="no-link" title="GitHub" href="https://github.com/walkerwzy" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-github"></i></a></li><li><a class="no-link" title="Weibo" href="https://weibo.com/1071696872" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-weibo"></i></a></li></ul>
                        </nav>
                    </div>

                    <section id="prism__external_links">
                        <ul>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://github.com/AlanDecode/Maverick" rel="noopener noreferrer nofollow">Maverick</a>ï¼šğŸ„â€ Go My Own Way.
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://www.imalan.cn" rel="noopener noreferrer nofollow">Triple NULL</a>ï¼šHome page for AlanDecode.
                                <span>|</span>
                            </li>
                            
                        </ul>
                    </section>

                    <div class="copyright">
                        <p class="copyright-text">
                            <span class="brand">walker's code blog</span>
                            <span>Copyright Â© 2022 AlanDecode</span>
                        </p>
                        <p class="copyright-text powered-by">
                            | Powered by <a href="https://github.com/AlanDecode/Maverick" class="no-link" target="_blank" rel="noopener noreferrer nofollow">Maverick</a> | Theme <a href="https://github.com/Reedo0910/Maverick-Theme-Prism" target="_blank" class="no-link" rel="noopener noreferrer nofollow">Prism</a>
                        </p>
                    </div>
                    <div class="footer-addon">
                        
                    </div>
                </section>
                <script>
                    var site_build_date = "2019-12-06T12:00+08:00"

                </script>
                <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/prism-efa8685153.js"></script>
            </footer>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    <!--katex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/katex.min.js"></script>
    <script>
        mathOpts = {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false }
            ]
        };

    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/wzywalker/wzywalker.github.io@main/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    
</body>

</html>